training image
/home/npinto/datasets/connectomics/isbi2012/pngs/train-volume.tif-00.png
validation image
/home/npinto/datasets/connectomics/isbi2012/pngs/train-volume.tif-01.png
testing image
/home/npinto/datasets/connectomics/isbi2012/pngs/train-volume.tif-29.png
>>> Layer 1: nf=32, fsize=5, psize=2
>>> Layer 2: nf=16, fsize=5, psize=2
>>> Layer 3: nf=16, fsize=5, psize=2
>>> Layer 4: nf=32, fsize=3, psize=2
>>> Footprint: 60
>>> Finding a balanced patch...
bal: 0.789802289282 435 270
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
>>> Compiling theano functions...
f...
df...
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60397315025
fb norms: [1.0000002, 1.0000002, 1.0000004, 0.99999982]
W norm: 0.0
grad norms: [0.0, 0.0, 0.0, 0.0, 0.17388606]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
================================================================================

At iterate    0    f=  2.25000D-02    |proj g|=  1.73881D-01
..........
================================================================================
#calls: 10
elapsed: 27.6816511154
fb norms: [1.0000029, 1.0000039, 1.0000026, 1.0000024]
W norm: 0.0738169
grad norms: [5.7806528e-06, 2.4611672e-05, 2.0893394e-05, 7.9041192e-06, 0.0007901818]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.212879626012
tst_shape: (30, 30)
tst_pe: 0.194397161741
================================================================================
.
At iterate   10    f=  1.63109D-02    |proj g|=  1.46186D-03
.........
================================================================================
#calls: 20
elapsed: 52.8193891048
fb norms: [1.0009429, 1.0025948, 1.0022222, 1.00099]
W norm: 1.20403
grad norms: [0.0046983236, 0.010138608, 0.010472044, 0.01089023, 0.014010987]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.269301025665
tst_shape: (30, 30)
tst_pe: 0.240136048223
================================================================================
.......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   15   28      1     0     0   0.000D+00   1.494D-02
  F =  1.49427773430943489E-002

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.000E-03 seconds.
 Subspace minimization time 3.499E-02 seconds.
 Line search           time 6.688E+01 seconds.

 Total User time 7.046E+01 seconds.

tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.278341348292


********************************************************************************
>>> Finding a balanced patch...
bal: 0.784079084287 71 700
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56046700478
fb norms: [1.0000001, 1.0000006, 1.0000007, 1.0000011]
W norm: 1.0
grad norms: [0.026618781, 0.048613105, 0.048268672, 0.067167096, 0.11806028]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.307623694586
tst_shape: (30, 30)
tst_pe: 0.285006914249
================================================================================

At iterate    0    f=  1.83074D-02    |proj g|=  1.17889D-01
..........
================================================================================
#calls: 10
elapsed: 27.6927700043
fb norms: [1.0184408, 1.0234898, 1.0257641, 1.0323734]
W norm: 1.01599
grad norms: [0.0035690905, 0.0089835757, 0.010959656, 0.013494479, 0.019205747]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.356251111787
tst_shape: (30, 30)
tst_pe: 0.332683857452
================================================================================
..
At iterate   10    f=  1.35240D-02    |proj g|=  4.22729D-03
........
================================================================================
#calls: 20
elapsed: 52.8362178802
fb norms: [1.0854776, 1.158947, 1.2023636, 1.25744]
W norm: 1.04894
grad norms: [0.036011878, 0.091681361, 0.070238724, 0.14192273, 0.085858218]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.301238240904
tst_shape: (30, 30)
tst_pe: 0.263100313192
================================================================================
....
At iterate   20    f=  1.09162D-02    |proj g|=  7.45390D-03
......
================================================================================
#calls: 30
elapsed: 78.025233984
fb norms: [1.1233164, 1.2048979, 1.2603824, 1.3643388]
W norm: 1.06747
grad norms: [0.0036469342, 0.0020405583, 0.0036489719, 0.0061670677, 0.0011534004]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.580748761254
tst_shape: (30, 30)
tst_pe: 0.55310819149
================================================================================
......
At iterate   30    f=  9.47498D-03    |proj g|=  5.22857D-03
....
================================================================================
#calls: 40
elapsed: 103.211071014
fb norms: [1.1486857, 1.254087, 1.3411161, 1.4984685]
W norm: 1.07649
grad norms: [0.0011547719, 0.002190453, 0.0045127063, 0.0049137608, 0.001708969]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.638312868165
tst_shape: (30, 30)
tst_pe: 0.591701238045
================================================================================
......
At iterate   40    f=  8.47883D-03    |proj g|=  8.33550D-04
....
================================================================================
#calls: 50
elapsed: 128.482812881
fb norms: [1.1854627, 1.331068, 1.4706805, 1.7155226]
W norm: 1.09465
grad norms: [0.0017258822, 0.0031391275, 0.0064494931, 0.010776263, 0.0049386658]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.675747999439
tst_shape: (30, 30)
tst_pe: 0.60423695379
================================================================================
......
At iterate   50    f=  7.41205D-03    |proj g|=  1.20021D-03
....
================================================================================
#calls: 60
elapsed: 153.780591011
fb norms: [1.2139689, 1.3924397, 1.5756612, 1.8779007]
W norm: 1.11002
grad norms: [0.0013339807, 0.0022514821, 0.0051140897, 0.0071211834, 0.0019792339]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.708042366269
tst_shape: (30, 30)
tst_pe: 0.595752927013
================================================================================
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   59   66      1     0     0   0.000D+00   6.482D-03
  F =  6.48163771256804466E-003

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.449E-01 seconds.
 Line search           time 1.624E+02 seconds.

 Total User time 1.666E+02 seconds.

lr: 0.5
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.511166375958


********************************************************************************
>>> Finding a balanced patch...
bal: 0.782518210198 614 121
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57688784599
fb norms: [1.0000005, 1.0000018, 1.0000012, 1.0000005]
W norm: 1.0
grad norms: [0.011618028, 0.018048937, 0.03209481, 0.05378053, 0.040220406]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.62021928784
tst_shape: (30, 30)
tst_pe: 0.579918123411
================================================================================

At iterate    0    f=  1.37588D-02    |proj g|=  3.93375D-02
..........
================================================================================
#calls: 10
elapsed: 27.6868579388
fb norms: [1.0256776, 1.0275793, 1.031044, 1.0374703]
W norm: 1.02566
grad norms: [0.0027598806, 0.0045375442, 0.0064454018, 0.011257159, 0.0031779287]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.645237558141
tst_shape: (30, 30)
tst_pe: 0.596590196753
================================================================================
..
At iterate   10    f=  8.63001D-03    |proj g|=  8.14075D-04
........
================================================================================
#calls: 20
elapsed: 52.8744800091
fb norms: [1.0515705, 1.0572987, 1.06915, 1.089649]
W norm: 1.05322
grad norms: [0.0015999964, 0.0033286551, 0.0064131734, 0.0084217023, 0.0031896704]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.698206037195
tst_shape: (30, 30)
tst_pe: 0.618856682774
================================================================================
...
At iterate   20    f=  7.54568D-03    |proj g|=  3.02069D-03
.......
================================================================================
#calls: 30
elapsed: 78.0880880356
fb norms: [1.0818888, 1.0967989, 1.1355052, 1.1903363]
W norm: 1.0808
grad norms: [0.0014237813, 0.0031115639, 0.0070290351, 0.0091379303, 0.0023542251]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.714258355857
tst_shape: (30, 30)
tst_pe: 0.617438234282
================================================================================
...
At iterate   30    f=  6.58114D-03    |proj g|=  3.11055D-03
.......
================================================================================
#calls: 40
elapsed: 103.324512005
fb norms: [1.1312056, 1.1680707, 1.2834848, 1.4388139]
W norm: 1.11942
grad norms: [0.0024965387, 0.0088181365, 0.015168005, 0.015738783, 0.0046020118]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.74762514912
tst_shape: (30, 30)
tst_pe: 0.614553932669
================================================================================
...
At iterate   40    f=  5.51400D-03    |proj g|=  1.33104D-03
.......
================================================================================
#calls: 50
elapsed: 128.696038008
fb norms: [1.168067, 1.2199572, 1.3874694, 1.6029179]
W norm: 1.15438
grad norms: [0.0021726144, 0.0076386551, 0.0143686, 0.017169587, 0.0045321276]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.777404816716
tst_shape: (30, 30)
tst_pe: 0.620712186825
================================================================================
...
At iterate   50    f=  4.35318D-03    |proj g|=  5.23390D-03
.......
================================================================================
#calls: 60
elapsed: 154.050951004
fb norms: [1.2185265, 1.2963452, 1.550367, 1.8577286]
W norm: 1.20148
grad norms: [0.0014399223, 0.0046633887, 0.011649638, 0.012598054, 0.002311972]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.812456274716
tst_shape: (30, 30)
tst_pe: 0.618856859888
================================================================================
...
At iterate   60    f=  3.02810D-03    |proj g|=  2.22540D-03
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   61   65      1     0     0   0.000D+00   2.850D-03
  F =  2.85003520548343658E-003

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.798E-01 seconds.
 Line search           time 1.602E+02 seconds.

 Total User time 1.644E+02 seconds.

lr: 0.333333333333
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.583407202542


********************************************************************************
>>> Finding a balanced patch...
bal: 0.7697710718 330 87
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.6157989502
fb norms: [1.0000001, 0.99999952, 1.0000001, 1.0]
W norm: 1.0
grad norms: [0.019901995, 0.06875705, 0.15432452, 0.2318863, 0.098992519]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.595854608049
tst_shape: (30, 30)
tst_pe: 0.581632585075
================================================================================

At iterate    0    f=  1.48644D-02    |proj g|=  9.25965D-02
..........
================================================================================
#calls: 10
elapsed: 27.7257499695
fb norms: [1.014182, 1.0144845, 1.0173386, 1.0200063]
W norm: 1.01509
grad norms: [0.0023968916, 0.0051321252, 0.014328333, 0.021662636, 0.0074936459]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.642693694012
tst_shape: (30, 30)
tst_pe: 0.617794333385
================================================================================
...
At iterate   10    f=  8.77125D-03    |proj g|=  1.06578D-03
.......
================================================================================
#calls: 20
elapsed: 52.8939769268
fb norms: [1.0454918, 1.0493025, 1.076622, 1.1071858]
W norm: 1.04696
grad norms: [0.0013166298, 0.0055122403, 0.0092331972, 0.014717211, 0.0035036649]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.699151899327
tst_shape: (30, 30)
tst_pe: 0.622169966537
================================================================================
...
At iterate   20    f=  6.97415D-03    |proj g|=  3.80062D-03
.......
================================================================================
#calls: 30
elapsed: 78.1546368599
fb norms: [1.0939323, 1.1068239, 1.1845981, 1.2787633]
W norm: 1.09468
grad norms: [0.0021392994, 0.004021863, 0.0093511958, 0.010020975, 0.0024867768]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.742272663561
tst_shape: (30, 30)
tst_pe: 0.603188889283
================================================================================
...
At iterate   30    f=  5.52694D-03    |proj g|=  3.93644D-03
.......
================================================================================
#calls: 40
elapsed: 103.411631823
fb norms: [1.172333, 1.2017068, 1.3710607, 1.5606989]
W norm: 1.17529
grad norms: [0.0030287341, 0.0097442139, 0.027253577, 0.040957838, 0.010977518]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.800951275934
tst_shape: (30, 30)
tst_pe: 0.610017406121
================================================================================
...
At iterate   40    f=  4.08578D-03    |proj g|=  1.72971D-03
.......
================================================================================
#calls: 50
elapsed: 128.690366983
fb norms: [1.2286806, 1.2718414, 1.5139613, 1.7687044]
W norm: 1.23269
grad norms: [0.0014324939, 0.0035785553, 0.012018391, 0.01422051, 0.0029421849]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.834052425489
tst_shape: (30, 30)
tst_pe: 0.601263745662
================================================================================
...
At iterate   50    f=  2.14433D-03    |proj g|=  3.30618D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   58      1     0     0   0.000D+00   1.700D-03
  F =  1.69954576995223761E-003

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.468E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.463E+02 seconds.

lr: 0.25
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.616991934733


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775754422477 663 130
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.59860515594
fb norms: [1.0, 0.99999976, 1.0000017, 1.0000007]
W norm: 1.0
grad norms: [0.025840621, 0.097635783, 0.31197509, 0.47571397, 0.16277801]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.579738003642
tst_shape: (30, 30)
tst_pe: 0.559906820964
================================================================================

At iterate    0    f=  1.92203D-02    |proj g|=  1.38442D-01
..........
================================================================================
#calls: 10
elapsed: 27.6893670559
fb norms: [1.0048345, 1.0049287, 1.0061995, 1.0079846]
W norm: 1.00248
grad norms: [0.002034002, 0.0057047172, 0.014946003, 0.020181984, 0.0061278595]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.639052721276
tst_shape: (30, 30)
tst_pe: 0.60410326184
================================================================================
...
At iterate   10    f=  8.43136D-03    |proj g|=  2.82247D-03
.......
================================================================================
#calls: 20
elapsed: 52.8667290211
fb norms: [1.0101309, 1.0138601, 1.0482292, 1.0817746]
W norm: 1.00179
grad norms: [0.0025217948, 0.0071588629, 0.012276581, 0.016693905, 0.0047312472]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.707264970255
tst_shape: (30, 30)
tst_pe: 0.612050721153
================================================================================
...
At iterate   20    f=  7.12305D-03    |proj g|=  1.49511D-03
.......
================================================================================
#calls: 30
elapsed: 78.0442061424
fb norms: [1.0397092, 1.0511305, 1.1327654, 1.2023386]
W norm: 1.0315
grad norms: [0.001598235, 0.0044461014, 0.0081014289, 0.0095133679, 0.0015296505]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.744774511062
tst_shape: (30, 30)
tst_pe: 0.604967486898
================================================================================
...
At iterate   30    f=  5.75986D-03    |proj g|=  1.14339D-03
.......
================================================================================
#calls: 40
elapsed: 103.272493124
fb norms: [1.0974027, 1.1237223, 1.3072697, 1.4581746]
W norm: 1.09376
grad norms: [0.0013309447, 0.0042513781, 0.010872586, 0.01454542, 0.0026613972]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.791782673965
tst_shape: (30, 30)
tst_pe: 0.57320519695
================================================================================
...
At iterate   40    f=  4.11742D-03    |proj g|=  1.85668D-03
.......
================================================================================
#calls: 50
elapsed: 128.526769161
fb norms: [1.1828613, 1.2302027, 1.5475223, 1.80628]
W norm: 1.18834
grad norms: [0.0016068453, 0.006536298, 0.015004836, 0.019546749, 0.0051383893]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.841677623147
tst_shape: (30, 30)
tst_pe: 0.568590964493
================================================================================
...
At iterate   50    f=  2.02609D-03    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   50   54      1     0     0   0.000D+00   2.026D-03
  F =  2.02609226107597351E-003

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.791E-01 seconds.
 Line search           time 1.324E+02 seconds.

 Total User time 1.365E+02 seconds.

lr: 0.2
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.639737665939


********************************************************************************
>>> Finding a balanced patch...
bal: 0.795005202914 769 343
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.6088681221
fb norms: [1.0000004, 0.99999887, 0.99999923, 1.0000002]
W norm: 1.0
grad norms: [0.017717673, 0.077077538, 0.1811538, 0.33258331, 0.11210714]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.569037428841
tst_shape: (30, 30)
tst_pe: 0.528552993077
================================================================================

At iterate    0    f=  1.44066D-02    |proj g|=  9.55272D-02
..........
================================================================================
#calls: 10
elapsed: 27.7734639645
fb norms: [1.0032786, 1.0033448, 1.0041878, 1.006178]
W norm: 1.00306
grad norms: [0.0019945528, 0.0056102388, 0.015723916, 0.029683361, 0.0089928433]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.633636618807
tst_shape: (30, 30)
tst_pe: 0.576594281518
================================================================================
..
At iterate   10    f=  8.17485D-03    |proj g|=  6.12792D-03
........
================================================================================
#calls: 20
elapsed: 52.9847939014
fb norms: [1.0088336, 1.0111717, 1.0447786, 1.1119734]
W norm: 1.00534
grad norms: [0.0014667877, 0.0033724175, 0.00888771, 0.012763159, 0.0036096072]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.702501041636
tst_shape: (30, 30)
tst_pe: 0.597145683802
================================================================================
..
At iterate   20    f=  6.22363D-03    |proj g|=  4.95877D-03
........
================================================================================
#calls: 30
elapsed: 78.2771580219
fb norms: [1.040332, 1.047178, 1.13314, 1.2614141]
W norm: 1.03743
grad norms: [0.0010933244, 0.0052250037, 0.016233783, 0.02315818, 0.0072622593]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.751695973438
tst_shape: (30, 30)
tst_pe: 0.595369362968
================================================================================
..
At iterate   30    f=  5.07830D-03    |proj g|=  1.28108D-03
........
================================================================================
#calls: 40
elapsed: 103.498729944
fb norms: [1.082805, 1.0970366, 1.2617255, 1.4644244]
W norm: 1.08203
grad norms: [0.0016243996, 0.008003328, 0.021215938, 0.020122785, 0.0061965766]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.7915482473
tst_shape: (30, 30)
tst_pe: 0.596008748243
================================================================================
..
At iterate   40    f=  3.18362D-03    |proj g|=  1.68429D-03
........
================================================================================
#calls: 50
elapsed: 128.764365911
fb norms: [1.1664522, 1.1983392, 1.5320542, 1.8598436]
W norm: 1.17057
grad norms: [0.0021650437, 0.011527017, 0.026697528, 0.025540629, 0.0088532241]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.861533462314
tst_shape: (30, 30)
tst_pe: 0.59859226097
================================================================================
..
At iterate   50    f=  1.59856D-03    |proj g|=  1.22879D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   55      1     0     0   0.000D+00   1.320D-03
  F =  1.32026511710137129E-003

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.153E-01 seconds.
 Line search           time 1.351E+02 seconds.

 Total User time 1.392E+02 seconds.

lr: 0.166666666667
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.650315814203


********************************************************************************
>>> Finding a balanced patch...
bal: 0.786420395421 385 191
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56736111641
fb norms: [0.99999994, 0.99999976, 1.0000006, 0.99999988]
W norm: 1.0
grad norms: [0.0039304462, 0.026068542, 0.095272623, 0.1198529, 0.03958869]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.576715007783
tst_shape: (30, 30)
tst_pe: 0.562918839647
================================================================================

At iterate    0    f=  1.08369D-02    |proj g|=  3.08926D-02
..........
================================================================================
#calls: 10
elapsed: 27.7156851292
fb norms: [1.0004863, 1.0011415, 1.0066414, 1.0109726]
W norm: 1.00222
grad norms: [0.0017687354, 0.0049657836, 0.014310985, 0.022948023, 0.0056132912]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.655143008194
tst_shape: (30, 30)
tst_pe: 0.60845847279
================================================================================
..
At iterate   10    f=  8.17980D-03    |proj g|=  1.61332D-03
........
================================================================================
#calls: 20
elapsed: 52.899862051
fb norms: [1.0043907, 1.0095172, 1.055787, 1.0988374]
W norm: 1.00484
grad norms: [0.00078605773, 0.0034400194, 0.011740609, 0.017754743, 0.0043643196]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.725470750204
tst_shape: (30, 30)
tst_pe: 0.624481426902
================================================================================
..
At iterate   20    f=  6.35481D-03    |proj g|=  2.65861D-03
........
================================================================================
#calls: 30
elapsed: 78.1370720863
fb norms: [1.0373493, 1.0470483, 1.1380409, 1.2273772]
W norm: 1.03791
grad norms: [0.0015248781, 0.0054278085, 0.016505763, 0.018014904, 0.0043931147]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.76045766104
tst_shape: (30, 30)
tst_pe: 0.60106040953
================================================================================
..
At iterate   30    f=  4.78325D-03    |proj g|=  2.24993D-03
........
================================================================================
#calls: 40
elapsed: 103.414426088
fb norms: [1.1234062, 1.1472013, 1.3501561, 1.5596179]
W norm: 1.12597
grad norms: [0.0012577837, 0.0054393997, 0.015992029, 0.014350023, 0.0030747599]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.818552389628
tst_shape: (30, 30)
tst_pe: 0.593454508848
================================================================================
..
At iterate   40    f=  3.08819D-03    |proj g|=  1.84243D-03
........
================================================================================
#calls: 50
elapsed: 128.712623119
fb norms: [1.2033724, 1.2448713, 1.5788013, 1.9185637]
W norm: 1.2073
grad norms: [0.0010326833, 0.0038289973, 0.011254785, 0.011349927, 0.0015466806]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.872293066758
tst_shape: (30, 30)
tst_pe: 0.610982673886
================================================================================
..
At iterate   50    f=  1.19167D-03    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   50   53      1     0     0   0.000D+00   1.192D-03
  F =  1.19166949298232794E-003

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.815E-01 seconds.
 Line search           time 1.303E+02 seconds.

 Total User time 1.343E+02 seconds.

lr: 0.142857142857
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.653294294489


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775494276795 160 459
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.6172311306
fb norms: [0.9999997, 1.0000004, 1.0000014, 1.0]
W norm: 1.0
grad norms: [0.0098701669, 0.051359925, 0.25602207, 0.27749872, 0.077768721]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.574973016634
tst_shape: (30, 30)
tst_pe: 0.544864063005
================================================================================

At iterate    0    f=  1.23794D-02    |proj g|=  6.19620D-02
..........
================================================================================
#calls: 10
elapsed: 27.7608032227
fb norms: [1.0016801, 1.0017704, 1.0028467, 1.0037009]
W norm: 1.00268
grad norms: [0.001711531, 0.0080989329, 0.043292448, 0.055187382, 0.013308555]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.659510575877
tst_shape: (30, 30)
tst_pe: 0.608536654517
================================================================================
..
At iterate   10    f=  8.40989D-03    |proj g|=  4.21811D-03
........
================================================================================
#calls: 20
elapsed: 52.903578043
fb norms: [0.99757987, 0.99928802, 1.0216663, 1.0388677]
W norm: 1.00233
grad norms: [0.0017332908, 0.0038736803, 0.0085279839, 0.012161785, 0.0016521183]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.72188278118
tst_shape: (30, 30)
tst_pe: 0.62231459176
================================================================================
..
At iterate   20    f=  6.43464D-03    |proj g|=  1.07505D-03
........
================================================================================
#calls: 30
elapsed: 78.1126830578
fb norms: [1.0185138, 1.0238624, 1.0918572, 1.155561]
W norm: 1.02113
grad norms: [0.0014445132, 0.002965301, 0.0095958002, 0.011658029, 0.0023332045]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.778480887999
tst_shape: (30, 30)
tst_pe: 0.628597428801
================================================================================
..
At iterate   30    f=  4.79887D-03    |proj g|=  9.27419D-04
........
================================================================================
#calls: 40
elapsed: 103.40616107
fb norms: [1.1076493, 1.1272067, 1.3257413, 1.5226619]
W norm: 1.11025
grad norms: [0.0047694691, 0.024626149, 0.082142659, 0.090037078, 0.026077196]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.829232740731
tst_shape: (30, 30)
tst_pe: 0.619066821789
================================================================================
..
At iterate   40    f=  3.00894D-03    |proj g|=  1.08232D-03
........
================================================================================
#calls: 50
elapsed: 128.705074072
fb norms: [1.1589435, 1.1857578, 1.4408004, 1.6933275]
W norm: 1.16305
grad norms: [0.0011409137, 0.0046214028, 0.013477066, 0.016175563, 0.0034587132]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.867552275054
tst_shape: (30, 30)
tst_pe: 0.631702474552
================================================================================
..
At iterate   50    f=  1.53065D-03    |proj g|=  1.10226D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   6.736D-04
  F =  6.73550239298492670E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.656E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.463E+02 seconds.

lr: 0.125
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.658772998541


********************************************************************************
>>> Finding a balanced patch...
bal: 0.782778355879 21 252
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62594389915
fb norms: [1.0000004, 1.000002, 0.99999982, 1.0000001]
W norm: 1.0
grad norms: [0.0091581503, 0.057062417, 0.20014341, 0.27324104, 0.076343469]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.577130131219
tst_shape: (30, 30)
tst_pe: 0.590388553887
================================================================================

At iterate    0    f=  1.18496D-02    |proj g|=  5.59377D-02
..........
================================================================================
#calls: 10
elapsed: 27.7409548759
fb norms: [0.99993336, 1.0000592, 1.0012517, 1.0035256]
W norm: 1.00106
grad norms: [0.00097620673, 0.0046536922, 0.015819175, 0.019771773, 0.003355962]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.651905091105
tst_shape: (30, 30)
tst_pe: 0.630999972789
================================================================================
..
At iterate   10    f=  8.07544D-03    |proj g|=  8.16495D-03
........
================================================================================
#calls: 20
elapsed: 52.9363079071
fb norms: [1.0042412, 1.0089425, 1.046391, 1.1026912]
W norm: 1.00466
grad norms: [0.0015600231, 0.005250657, 0.019721281, 0.02885654, 0.0074441517]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.736040066932
tst_shape: (30, 30)
tst_pe: 0.632566597521
================================================================================
..
At iterate   20    f=  6.01605D-03    |proj g|=  1.53361D-03
........
================================================================================
#calls: 30
elapsed: 78.1276938915
fb norms: [1.0437032, 1.0536623, 1.14149, 1.2599922]
W norm: 1.04223
grad norms: [0.00121378, 0.0045461333, 0.020185003, 0.024317013, 0.0047286171]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.78069959965
tst_shape: (30, 30)
tst_pe: 0.616994600579
================================================================================
..
At iterate   30    f=  4.34669D-03    |proj g|=  1.32077D-03
........
================================================================================
#calls: 40
elapsed: 103.330230951
fb norms: [1.1139535, 1.1333739, 1.3053371, 1.5240873]
W norm: 1.11278
grad norms: [0.0013677339, 0.0033449908, 0.011304805, 0.012166562, 0.0016780699]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.83271783011
tst_shape: (30, 30)
tst_pe: 0.593039132859
================================================================================
..
At iterate   40    f=  2.43079D-03    |proj g|=  1.82690D-03
........
================================================================================
#calls: 50
elapsed: 128.633471966
fb norms: [1.218058, 1.2539901, 1.5663306, 1.9365898]
W norm: 1.21847
grad norms: [0.0013118747, 0.0079665249, 0.026292071, 0.042755738, 0.011670378]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.899090855755
tst_shape: (30, 30)
tst_pe: 0.593942165281
================================================================================
..
At iterate   50    f=  9.36638D-04    |proj g|=  1.31439D-03
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   54      1     0     0   0.000D+00   7.964D-04
  F =  7.96400650870054960E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.027E-01 seconds.
 Line search           time 1.325E+02 seconds.

 Total User time 1.366E+02 seconds.

lr: 0.111111111111
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.657508504999


********************************************************************************
>>> Finding a balanced patch...
bal: 0.787200832466 856 474
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.63797688484
fb norms: [1.0000001, 1.0000008, 1.0000004, 0.9999997]
W norm: 1.0
grad norms: [0.0047958577, 0.0072783232, 0.033219147, 0.077029862, 0.02357273]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.57638309895
tst_shape: (30, 30)
tst_pe: 0.540606706626
================================================================================

At iterate    0    f=  1.05801D-02    |proj g|=  2.08727D-02
..........
================================================================================
#calls: 10
elapsed: 27.877273798
fb norms: [1.0011148, 1.0011859, 1.0031999, 1.0081427]
W norm: 1.00344
grad norms: [0.00097021193, 0.0029791566, 0.0091686985, 0.01744491, 0.0019451394]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.670229039814
tst_shape: (30, 30)
tst_pe: 0.611610203211
================================================================================
...
At iterate   10    f=  7.14510D-03    |proj g|=  1.22448D-02
.......
================================================================================
#calls: 20
elapsed: 53.0472438335
fb norms: [1.0059792, 1.0075884, 1.0416507, 1.1055216]
W norm: 1.01219
grad norms: [0.0011619037, 0.0036509703, 0.011502259, 0.011842845, 0.0016961808]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.753571089684
tst_shape: (30, 30)
tst_pe: 0.625790064365
================================================================================
...
At iterate   20    f=  5.19052D-03    |proj g|=  1.31696D-03
.......
================================================================================
#calls: 30
elapsed: 78.3756818771
fb norms: [1.064159, 1.0685918, 1.1662247, 1.3259763]
W norm: 1.07065
grad norms: [0.0015283835, 0.0044173179, 0.022778535, 0.031659793, 0.0066046556]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.809735764416
tst_shape: (30, 30)
tst_pe: 0.603075632703
================================================================================
...
At iterate   30    f=  3.36097D-03    |proj g|=  1.39657D-03
.......
================================================================================
#calls: 40
elapsed: 103.613441944
fb norms: [1.1259829, 1.1337421, 1.2880608, 1.5269923]
W norm: 1.13194
grad norms: [0.00096785597, 0.0025405388, 0.014263039, 0.024242464, 0.0051743225]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.846551646039
tst_shape: (30, 30)
tst_pe: 0.612418343172
================================================================================
...
At iterate   40    f=  1.86365D-03    |proj g|=  1.23751D-03
.......
================================================================================
#calls: 50
elapsed: 128.888509989
fb norms: [1.2037302, 1.2163583, 1.4486051, 1.7890309]
W norm: 1.21001
grad norms: [0.000949529, 0.0029512176, 0.013385738, 0.016856344, 0.0033361875]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.899617338556
tst_shape: (30, 30)
tst_pe: 0.614417188631
================================================================================
...
At iterate   50    f=  6.06985D-04    |proj g|=  1.11313D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   57      1     0     0   0.000D+00   3.114D-04
  F =  3.11408395646139979E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 4.293E-01 seconds.
 Line search           time 1.399E+02 seconds.

 Total User time 1.441E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.656081848228


********************************************************************************
>>> Finding a balanced patch...
bal: 0.7796566077 510 699
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58966493607
fb norms: [0.99999976, 1.0000005, 1.0000015, 0.99999982]
W norm: 1.0
grad norms: [0.0046882425, 0.032713741, 0.22019623, 0.38130558, 0.077927642]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.584536041749
tst_shape: (30, 30)
tst_pe: 0.545873110038
================================================================================

At iterate    0    f=  1.15110D-02    |proj g|=  4.87735D-02
..........
================================================================================
#calls: 10
elapsed: 27.7087459564
fb norms: [0.99848312, 0.99849129, 0.99901968, 1.0009062]
W norm: 0.999691
grad norms: [0.0013179518, 0.0059160963, 0.038514491, 0.046339918, 0.0081252046]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.661123435576
tst_shape: (30, 30)
tst_pe: 0.611441187148
================================================================================
...
At iterate   10    f=  8.19412D-03    |proj g|=  2.05917D-03
.......
================================================================================
#calls: 20
elapsed: 52.8514349461
fb norms: [0.99296969, 0.99331725, 1.0094184, 1.0390583]
W norm: 0.999005
grad norms: [0.00098514918, 0.0026052466, 0.0091425553, 0.01472297, 0.0017754512]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.719677128225
tst_shape: (30, 30)
tst_pe: 0.61254995786
================================================================================
...
At iterate   20    f=  6.39122D-03    |proj g|=  2.18303D-03
.......
================================================================================
#calls: 30
elapsed: 78.0523040295
fb norms: [1.0184532, 1.0202121, 1.0748942, 1.1603794]
W norm: 1.02483
grad norms: [0.00088747905, 0.0024684665, 0.013388062, 0.020550292, 0.003335325]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.774129300155
tst_shape: (30, 30)
tst_pe: 0.600870293359
================================================================================
...
At iterate   30    f=  4.67634D-03    |proj g|=  2.05011D-03
.......
================================================================================
#calls: 40
elapsed: 103.412008047
fb norms: [1.0731921, 1.0785921, 1.1965582, 1.3631387]
W norm: 1.0801
grad norms: [0.0017688357, 0.0035883894, 0.01736219, 0.026043158, 0.004508731]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.809353561937
tst_shape: (30, 30)
tst_pe: 0.572468408334
================================================================================
...
At iterate   40    f=  3.12750D-03    |proj g|=  1.36612D-03
.......
================================================================================
#calls: 50
elapsed: 128.728922844
fb norms: [1.1444775, 1.1549653, 1.3538586, 1.6101238]
W norm: 1.15222
grad norms: [0.0011312807, 0.0029385074, 0.020143991, 0.020843659, 0.0045625051]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.86059699556
tst_shape: (30, 30)
tst_pe: 0.567162784037
================================================================================
...
At iterate   50    f=  1.53230D-03    |proj g|=  2.69586D-03
.......
================================================================================
#calls: 60
elapsed: 154.066803932
fb norms: [1.2256454, 1.2422866, 1.5372152, 1.8934977]
W norm: 1.23542
grad norms: [0.00070605305, 0.002589569, 0.010755448, 0.013691341, 0.0027513825]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.908316227836
tst_shape: (30, 30)
tst_pe: 0.562522818726
================================================================================
...
At iterate   60    f=  4.53920D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   60   64      1     0     0   0.000D+00   4.539D-04
  F =  4.53920249128714204E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.623E-01 seconds.
 Line search           time 1.578E+02 seconds.

 Total User time 1.620E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.657952907637


********************************************************************************
>>> Finding a balanced patch...
bal: 0.779916753382 189 243
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56092381477
fb norms: [1.0000001, 0.99999934, 1.0000006, 1.0000005]
W norm: 1.0
grad norms: [0.0042529055, 0.041286133, 0.30210373, 0.48067355, 0.099418372]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.566807292729
tst_shape: (30, 30)
tst_pe: 0.509257847368
================================================================================

At iterate    0    f=  1.25643D-02    |proj g|=  6.33410D-02
..........
================================================================================
#calls: 10
elapsed: 27.7156298161
fb norms: [0.99401373, 0.99409914, 0.99570972, 1.0010071]
W norm: 0.994989
grad norms: [0.0012785315, 0.0075664856, 0.038243581, 0.060711555, 0.01312732]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.687633983396
tst_shape: (30, 30)
tst_pe: 0.587520855179
================================================================================
...
At iterate   10    f=  7.67969D-03    |proj g|=  2.27128D-03
.......
================================================================================
#calls: 20
elapsed: 52.8695449829
fb norms: [0.97921014, 0.98069566, 1.0021709, 1.0484072]
W norm: 0.981894
grad norms: [0.0010909321, 0.0044246302, 0.020949196, 0.03251189, 0.0072635575]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.752185197456
tst_shape: (30, 30)
tst_pe: 0.5897468977
================================================================================
...
At iterate   20    f=  5.80862D-03    |proj g|=  1.16870D-03
.......
================================================================================
#calls: 30
elapsed: 78.0978038311
fb norms: [1.0080681, 1.0126051, 1.0807843, 1.2041242]
W norm: 1.01142
grad norms: [0.0015440409, 0.003724114, 0.01609957, 0.02573487, 0.005534532]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.797861446012
tst_shape: (30, 30)
tst_pe: 0.580906420523
================================================================================
...
At iterate   30    f=  4.25246D-03    |proj g|=  1.81517D-03
.......
================================================================================
#calls: 40
elapsed: 103.343818903
fb norms: [1.0594567, 1.068253, 1.1932573, 1.4013096]
W norm: 1.06395
grad norms: [0.0008498329, 0.0032421346, 0.010708376, 0.020151423, 0.0038445171]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.835848735834
tst_shape: (30, 30)
tst_pe: 0.58039006073
================================================================================
...
At iterate   40    f=  2.31492D-03    |proj g|=  1.75613D-03
.......
================================================================================
#calls: 50
elapsed: 128.61022687
fb norms: [1.136863, 1.1513104, 1.3441755, 1.6410434]
W norm: 1.14268
grad norms: [0.00073389721, 0.0025382673, 0.013516916, 0.015672611, 0.0023097256]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.880060691177
tst_shape: (30, 30)
tst_pe: 0.56847940163
================================================================================
...
At iterate   50    f=  1.02978D-03    |proj g|=  2.82642D-03
.......
================================================================================
#calls: 60
elapsed: 153.918689013
fb norms: [1.2267606, 1.2495466, 1.5412978, 1.9640563]
W norm: 1.23536
grad norms: [0.00060981041, 0.0020704374, 0.0077970526, 0.011762551, 0.0019960294]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.931471462221
tst_shape: (30, 30)
tst_pe: 0.560120727283
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   58   62      1     0     0   0.000D+00   2.336D-04
  F =  2.33567727264016867E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.205E-01 seconds.
 Line search           time 1.529E+02 seconds.

 Total User time 1.571E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.657483055784


********************************************************************************
>>> Finding a balanced patch...
bal: 0.7895421436 646 20
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57249379158
fb norms: [0.9999997, 1.0, 1.0000006, 1.0000005]
W norm: 1.0
grad norms: [0.0056329994, 0.040189199, 0.18735662, 0.45956743, 0.091220327]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.583084042884
tst_shape: (30, 30)
tst_pe: 0.520943268502
================================================================================

At iterate    0    f=  1.14438D-02    |proj g|=  5.16376D-02
..........
================================================================================
#calls: 10
elapsed: 27.7372868061
fb norms: [0.99450427, 0.99459809, 0.9961614, 0.99987251]
W norm: 0.995644
grad norms: [0.0018172998, 0.005013437, 0.015580832, 0.028043265, 0.0050870664]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.684748863757
tst_shape: (30, 30)
tst_pe: 0.582576294189
================================================================================
...
At iterate   10    f=  7.18918D-03    |proj g|=  1.14914D-03
.......
================================================================================
#calls: 20
elapsed: 52.9248588085
fb norms: [0.978221, 0.97977942, 1.0004874, 1.0450633]
W norm: 0.981859
grad norms: [0.0012863711, 0.0035151865, 0.015949093, 0.025922725, 0.0056469431]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.751045067048
tst_shape: (30, 30)
tst_pe: 0.5970723099
================================================================================
...
At iterate   20    f=  5.40359D-03    |proj g|=  1.44294D-03
.......
================================================================================
#calls: 30
elapsed: 78.1266880035
fb norms: [1.0044192, 1.0091326, 1.0750484, 1.1973433]
W norm: 1.00879
grad norms: [0.0019156333, 0.0056841737, 0.022375606, 0.036026258, 0.0080763372]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.798048172575
tst_shape: (30, 30)
tst_pe: 0.595951006806
================================================================================
...
At iterate   30    f=  3.86159D-03    |proj g|=  2.04373D-03
.......
================================================================================
#calls: 40
elapsed: 103.430918932
fb norms: [1.0702692, 1.0804248, 1.2244511, 1.4572793]
W norm: 1.07407
grad norms: [0.00099004782, 0.0039904276, 0.01355458, 0.016189214, 0.0024506182]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.847414536169
tst_shape: (30, 30)
tst_pe: 0.571395042493
================================================================================
...
At iterate   40    f=  1.86460D-03    |proj g|=  1.46162D-03
.......
================================================================================
#calls: 50
elapsed: 128.718772888
fb norms: [1.1653765, 1.1836637, 1.4303434, 1.786731]
W norm: 1.1691
grad norms: [0.00090629014, 0.0037923839, 0.0086786887, 0.011142688, 0.0013544732]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.904643662397
tst_shape: (30, 30)
tst_pe: 0.548964474164
================================================================================
...
At iterate   50    f=  4.48366D-04    |proj g|=  1.25609D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   58      1     0     0   0.000D+00   2.546D-04
  F =  2.54566635703667998E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.563E-01 seconds.
 Line search           time 1.423E+02 seconds.

 Total User time 1.464E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.656465496485


********************************************************************************
>>> Finding a balanced patch...
bal: 0.763007284079 166 387
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56881904602
fb norms: [0.99999976, 0.99999952, 1.0000015, 0.99999964]
W norm: 1.0
grad norms: [0.0043913377, 0.019321281, 0.12920062, 0.28668436, 0.055152494]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.615819952289
tst_shape: (30, 30)
tst_pe: 0.498781879807
================================================================================

At iterate    0    f=  1.07857D-02    |proj g|=  2.60660D-02
..........
================================================================================
#calls: 10
elapsed: 27.7037289143
fb norms: [0.99805093, 0.99805784, 0.99843109, 0.99914104]
W norm: 0.998446
grad norms: [0.0019773822, 0.005525989, 0.027030058, 0.06533879, 0.011942419]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.675283482359
tst_shape: (30, 30)
tst_pe: 0.569769727157
================================================================================
..
At iterate   10    f=  8.27617D-03    |proj g|=  3.99055D-03
........
================================================================================
#calls: 20
elapsed: 52.8654630184
fb norms: [0.97874624, 0.97921991, 0.99354815, 1.0237333]
W norm: 0.981556
grad norms: [0.0011271368, 0.0032536618, 0.015304903, 0.029469617, 0.0049965773]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.751730678036
tst_shape: (30, 30)
tst_pe: 0.597577446557
================================================================================
..
At iterate   20    f=  6.18182D-03    |proj g|=  2.07669D-03
........
================================================================================
#calls: 30
elapsed: 78.1208000183
fb norms: [0.99353349, 0.99636883, 1.0498533, 1.1519864]
W norm: 0.9962
grad norms: [0.0021337096, 0.0070919618, 0.038304493, 0.082752913, 0.018644117]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.798868426347
tst_shape: (30, 30)
tst_pe: 0.60775303916
================================================================================
..
At iterate   30    f=  4.56081D-03    |proj g|=  2.22451D-03
........
================================================================================
#calls: 40
elapsed: 103.368280888
fb norms: [1.0366828, 1.0421221, 1.1343497, 1.2984986]
W norm: 1.03885
grad norms: [0.0012912994, 0.0039565763, 0.014132262, 0.016608423, 0.0021747395]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.83075274443
tst_shape: (30, 30)
tst_pe: 0.588969638739
================================================================================
..
At iterate   40    f=  3.17099D-03    |proj g|=  1.89668D-03
........
================================================================================
#calls: 50
elapsed: 128.683800936
fb norms: [1.0938648, 1.1028816, 1.2437704, 1.4808472]
W norm: 1.09677
grad norms: [0.0013059092, 0.0026059337, 0.010344575, 0.014978081, 0.0016557064]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.862425871354
tst_shape: (30, 30)
tst_pe: 0.566504152692
================================================================================
..
At iterate   50    f=  1.65709D-03    |proj g|=  3.74585D-03
........
================================================================================
#calls: 60
elapsed: 154.043462038
fb norms: [1.2008636, 1.2183349, 1.4710603, 1.8617427]
W norm: 1.20578
grad norms: [0.00060033612, 0.0020655049, 0.0084469318, 0.012241952, 0.0017721312]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.918219321953
tst_shape: (30, 30)
tst_pe: 0.573067449367
================================================================================
..
At iterate   60    f=  3.25038D-04    |proj g|=  1.62511D-03
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   61   64      1     0     0   0.000D+00   2.500D-04
  F =  2.49987759161740541E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 5.801E-01 seconds.
 Line search           time 1.577E+02 seconds.

 Total User time 1.620E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.656894634789


********************************************************************************
>>> Finding a balanced patch...
bal: 0.784079084287 315 13
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57900381088
fb norms: [1.0000002, 1.0000006, 0.99999905, 1.0000007]
W norm: 1.0
grad norms: [0.0053518605, 0.0060339603, 0.028680375, 0.063363798, 0.015772395]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.55300213997
tst_shape: (30, 30)
tst_pe: 0.525492058732
================================================================================

At iterate    0    f=  1.13066D-02    |proj g|=  1.29997D-02
..........
================================================================================
#calls: 10
elapsed: 27.6993668079
fb norms: [0.99491483, 0.99495566, 0.99609333, 0.99919397]
W norm: 0.995628
grad norms: [0.002538183, 0.0049972194, 0.020044811, 0.033695821, 0.0047255196]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.648508590101
tst_shape: (30, 30)
tst_pe: 0.579321308059
================================================================================
...
At iterate   10    f=  8.35601D-03    |proj g|=  1.80262D-03
.......
================================================================================
#calls: 20
elapsed: 52.8951179981
fb norms: [0.97709012, 0.97785413, 0.98695952, 1.009585]
W norm: 0.979265
grad norms: [0.00092014461, 0.0020940914, 0.01372188, 0.018896606, 0.0019823024]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.700368801905
tst_shape: (30, 30)
tst_pe: 0.584298215789
================================================================================
...
At iterate   20    f=  6.70558D-03    |proj g|=  6.87339D-03
.......
================================================================================
#calls: 30
elapsed: 78.1655859947
fb norms: [0.97655809, 0.978544, 1.0049851, 1.0604956]
W norm: 0.979043
grad norms: [0.0012902041, 0.0032539021, 0.011204007, 0.015048111, 0.0018552602]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.745378484356
tst_shape: (30, 30)
tst_pe: 0.590703605174
================================================================================
...
At iterate   30    f=  5.02866D-03    |proj g|=  9.70042D-03
.......
================================================================================
#calls: 40
elapsed: 103.406910896
fb norms: [1.0159004, 1.0209579, 1.0980312, 1.2400936]
W norm: 1.01907
grad norms: [0.0014226676, 0.0047936561, 0.01544603, 0.022035344, 0.0044680024]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.786918934808
tst_shape: (30, 30)
tst_pe: 0.563877231547
================================================================================
...
At iterate   40    f=  3.57517D-03    |proj g|=  1.07575D-02
.......
================================================================================
#calls: 50
elapsed: 128.666273832
fb norms: [1.0859576, 1.0955443, 1.2334082, 1.4634825]
W norm: 1.08967
grad norms: [0.00087958999, 0.0059927013, 0.019734876, 0.027280107, 0.005545022]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.838232442124
tst_shape: (30, 30)
tst_pe: 0.553866858233
================================================================================
...
At iterate   50    f=  2.16149D-03    |proj g|=  1.23397D-03
.......
================================================================================
#calls: 60
elapsed: 153.969892979
fb norms: [1.1544555, 1.1689746, 1.3740509, 1.6930091]
W norm: 1.15919
grad norms: [0.00082123041, 0.0030722425, 0.011002973, 0.017416891, 0.0049244906]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.887118472467
tst_shape: (30, 30)
tst_pe: 0.550469017265
================================================================================
...
At iterate   60    f=  7.35319D-04    |proj g|=  2.20811D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   65   69      1     0     0   0.000D+00   3.162D-04
  F =  3.16217978252097964E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 6.570E-01 seconds.
 Line search           time 1.696E+02 seconds.

 Total User time 1.739E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.65893191048


********************************************************************************
>>> Finding a balanced patch...
bal: 0.786420395421 776 564
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.6143989563
fb norms: [1.0000002, 1.0000015, 1.0, 0.99999982]
W norm: 1.0
grad norms: [0.0052877413, 0.042477302, 0.19184716, 0.39827615, 0.086924911]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.564009941952
tst_shape: (30, 30)
tst_pe: 0.501722759014
================================================================================

At iterate    0    f=  1.12557D-02    |proj g|=  4.84783D-02
..........
================================================================================
#calls: 10
elapsed: 27.7823829651
fb norms: [0.99753922, 0.99755681, 0.99786991, 0.99854112]
W norm: 0.998087
grad norms: [0.0027903235, 0.00777975, 0.027086012, 0.04909806, 0.0068843798]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.630138722214
tst_shape: (30, 30)
tst_pe: 0.570451210367
================================================================================
...
At iterate   10    f=  8.33176D-03    |proj g|=  1.04381D-02
.......
================================================================================
#calls: 20
elapsed: 52.9532799721
fb norms: [0.98007131, 0.9806906, 0.99066669, 1.0064226]
W norm: 0.983594
grad norms: [0.00098645396, 0.0061233472, 0.026167696, 0.033903532, 0.0065093474]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.704966673752
tst_shape: (30, 30)
tst_pe: 0.584528545472
================================================================================
...
At iterate   20    f=  6.44227D-03    |proj g|=  3.08668D-03
.......
================================================================================
#calls: 30
elapsed: 78.1232459545
fb norms: [0.97845024, 0.98036468, 1.0102887, 1.0525585]
W norm: 0.983888
grad norms: [0.0010405348, 0.0054533882, 0.028023774, 0.037939813, 0.0084491465]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.754862073261
tst_shape: (30, 30)
tst_pe: 0.611493654426
================================================================================
...
At iterate   30    f=  4.94718D-03    |proj g|=  2.19888D-03
.......
================================================================================
#calls: 40
elapsed: 103.339318991
fb norms: [1.0118086, 1.0176048, 1.1041509, 1.2129645]
W norm: 1.01951
grad norms: [0.0016179394, 0.0042762253, 0.015137964, 0.019276015, 0.002534867]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.803034240867
tst_shape: (30, 30)
tst_pe: 0.604744786223
================================================================================
...
At iterate   40    f=  3.08463D-03    |proj g|=  1.12466D-03
.......
================================================================================
#calls: 50
elapsed: 128.611779928
fb norms: [1.0752958, 1.0857337, 1.2403848, 1.4270496]
W norm: 1.08462
grad norms: [0.0012242155, 0.0060747876, 0.026778568, 0.030500252, 0.0067322804]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.848310906061
tst_shape: (30, 30)
tst_pe: 0.609173344194
================================================================================
...
At iterate   50    f=  1.50554D-03    |proj g|=  2.80582D-03
.......
================================================================================
#calls: 60
elapsed: 153.920565844
fb norms: [1.182688, 1.2015406, 1.475697, 1.7892064]
W norm: 1.19748
grad norms: [0.00063064526, 0.0024754731, 0.0084415702, 0.0096850339, 0.0014090992]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.917412327203
tst_shape: (30, 30)
tst_pe: 0.607624955756
================================================================================
...
At iterate   60    f=  2.49915D-04    |proj g|=  6.43744D-04
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   65   69      1     0     0   0.000D+00   4.276D-05
  F =  4.27598934038542211E-005

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 6.582E-01 seconds.
 Line search           time 1.695E+02 seconds.

 Total User time 1.739E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.656201818443


********************************************************************************
>>> Finding a balanced patch...
bal: 0.78616024974 91 366
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57259511948
fb norms: [0.99999994, 1.0000013, 1.0000005, 1.0000001]
W norm: 1.0
grad norms: [0.0085909627, 0.096076891, 0.75995249, 1.0371201, 0.2334729]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.58043162653
tst_shape: (30, 30)
tst_pe: 0.561302096044
================================================================================

At iterate    0    f=  1.70787D-02    |proj g|=  1.12760D-01
..........
================================================================================
#calls: 10
elapsed: 27.7174270153
fb norms: [0.99642229, 0.99644977, 0.99695617, 0.99751306]
W norm: 0.996135
grad norms: [0.0013156807, 0.008103651, 0.05179042, 0.067956276, 0.013120743]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.645972765782
tst_shape: (30, 30)
tst_pe: 0.609149696185
================================================================================
..
At iterate   10    f=  8.57388D-03    |proj g|=  8.51675D-03
........
================================================================================
#calls: 20
elapsed: 52.9586789608
fb norms: [0.97865045, 0.97946948, 0.99193138, 1.0085379]
W norm: 0.977125
grad norms: [0.0021270262, 0.00873031, 0.0542574, 0.10146694, 0.025724098]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.71000864434
tst_shape: (30, 30)
tst_pe: 0.615976656152
================================================================================
..
At iterate   20    f=  6.92427D-03    |proj g|=  1.91281D-03
........
================================================================================
#calls: 30
elapsed: 78.1361091137
fb norms: [0.97387433, 0.97570401, 1.0028616, 1.0439874]
W norm: 0.971476
grad norms: [0.0011891957, 0.002444909, 0.0093675163, 0.014867644, 0.0018000125]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.739787902435
tst_shape: (30, 30)
tst_pe: 0.621161271232
================================================================================
..
At iterate   30    f=  5.50756D-03    |proj g|=  1.42434D-03
........
================================================================================
#calls: 40
elapsed: 103.373631954
fb norms: [1.0054942, 1.0104188, 1.0823649, 1.1967201]
W norm: 1.00221
grad norms: [0.0015902439, 0.0052020918, 0.022561569, 0.031723373, 0.0077103134]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.783208872616
tst_shape: (30, 30)
tst_pe: 0.612405368102
================================================================================
..
At iterate   40    f=  4.15410D-03    |proj g|=  1.96446D-03
........
================================================================================
#calls: 50
elapsed: 128.657670975
fb norms: [1.0602266, 1.0693382, 1.1976039, 1.3960245]
W norm: 1.05789
grad norms: [0.00073656009, 0.0025699735, 0.012672438, 0.019076925, 0.0037995698]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.824297666909
tst_shape: (30, 30)
tst_pe: 0.596356965538
================================================================================
..
At iterate   50    f=  2.83261D-03    |proj g|=  4.15079D-03
........
================================================================================
#calls: 60
elapsed: 153.980611086
fb norms: [1.1300277, 1.1444441, 1.3438338, 1.6422367]
W norm: 1.13027
grad norms: [0.0010377524, 0.0038540007, 0.018506201, 0.029573919, 0.0072152293]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.870436994873
tst_shape: (30, 30)
tst_pe: 0.598520954274
================================================================================
..
At iterate   60    f=  1.19371D-03    |proj g|=  5.41278D-03
........
================================================================================
#calls: 70
elapsed: 179.308614969
fb norms: [1.2287043, 1.2520744, 1.5723822, 2.0259166]
W norm: 1.23426
grad norms: [0.0007338135, 0.0029799845, 0.013802232, 0.018788785, 0.0050206441]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.930145491986
tst_shape: (30, 30)
tst_pe: 0.586607885875
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   68   71      1     0     0   0.000D+00   3.852D-04
  F =  3.85241670301184058E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 7.310E-01 seconds.
 Line search           time 1.755E+02 seconds.

 Total User time 1.800E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.656233662667


********************************************************************************
>>> Finding a balanced patch...
bal: 0.776795005203 34 205
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61014509201
fb norms: [1.0000001, 0.99999994, 1.0, 0.99999946]
W norm: 1.0
grad norms: [0.0081850486, 0.073021129, 0.45156303, 1.0018592, 0.20861195]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.570405290277
tst_shape: (30, 30)
tst_pe: 0.542404116873
================================================================================

At iterate    0    f=  1.56007D-02    |proj g|=  9.89510D-02
..........
================================================================================
#calls: 10
elapsed: 27.7246010303
fb norms: [0.99085695, 0.99099106, 0.99245381, 0.99618626]
W norm: 0.990494
grad norms: [0.0005417582, 0.0057864841, 0.050122507, 0.13246706, 0.027492179]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.661994080448
tst_shape: (30, 30)
tst_pe: 0.59823078628
================================================================================
...
At iterate   10    f=  8.53277D-03    |proj g|=  2.23812D-03
.......
================================================================================
#calls: 20
elapsed: 52.8444499969
fb norms: [0.96938199, 0.97128886, 0.99082369, 1.0325826]
W norm: 0.969284
grad norms: [0.00075426168, 0.0020020069, 0.010415251, 0.015327978, 0.0019007619]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.720103970587
tst_shape: (30, 30)
tst_pe: 0.611263377839
================================================================================
...
At iterate   20    f=  6.63177D-03    |proj g|=  1.68637D-03
.......
================================================================================
#calls: 30
elapsed: 78.08989501
fb norms: [0.97589952, 0.98009109, 1.0321274, 1.1298525]
W norm: 0.974714
grad norms: [0.00087272626, 0.0028130703, 0.012534072, 0.018959381, 0.0024384968]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.758825023052
tst_shape: (30, 30)
tst_pe: 0.620317671216
================================================================================
...
At iterate   30    f=  5.27901D-03    |proj g|=  2.44830D-03
.......
================================================================================
#calls: 40
elapsed: 103.32989192
fb norms: [1.0116686, 1.0181499, 1.1100746, 1.2645724]
W norm: 1.0107
grad norms: [0.0013335895, 0.0037438029, 0.014397814, 0.015901845, 0.0030446399]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.794176643258
tst_shape: (30, 30)
tst_pe: 0.609602551965
================================================================================
...
At iterate   40    f=  3.46820D-03    |proj g|=  1.59492D-03
.......
================================================================================
#calls: 50
elapsed: 128.562507868
fb norms: [1.0827776, 1.0944566, 1.2742391, 1.5409232]
W norm: 1.08388
grad norms: [0.0011163055, 0.003386159, 0.017995527, 0.030828677, 0.0068948101]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.847692514531
tst_shape: (30, 30)
tst_pe: 0.614758527026
================================================================================
...
At iterate   50    f=  1.78125D-03    |proj g|=  1.50543D-03
.......
================================================================================
#calls: 60
elapsed: 153.85939908
fb norms: [1.1718521, 1.1907718, 1.4837745, 1.8780963]
W norm: 1.17629
grad norms: [0.00075423304, 0.002355047, 0.0096603585, 0.01442895, 0.0030929986]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.906964699711
tst_shape: (30, 30)
tst_pe: 0.61196945389
================================================================================
...
At iterate   60    f=  5.10623D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   60   64      1     0     0   0.000D+00   5.106D-04
  F =  5.10623096488416195E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 5.549E-01 seconds.
 Line search           time 1.575E+02 seconds.

 Total User time 1.618E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.655227608309


********************************************************************************
>>> Finding a balanced patch...
bal: 0.7895421436 561 387
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61158490181
fb norms: [1.0000002, 0.99999952, 1.0000013, 1.0000002]
W norm: 1.0
grad norms: [0.0039276532, 0.0051383581, 0.0232617, 0.043588083, 0.012901168]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.578011102738
tst_shape: (30, 30)
tst_pe: 0.556258802885
================================================================================

At iterate    0    f=  1.03829D-02    |proj g|=  1.10601D-02
..........
================================================================================
#calls: 10
elapsed: 27.7918140888
fb norms: [0.99287784, 0.99293804, 0.99603581, 1.0024052]
W norm: 0.994723
grad norms: [0.00069106411, 0.0034629854, 0.021453632, 0.041687742, 0.0080813868]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.662894272348
tst_shape: (30, 30)
tst_pe: 0.596289992213
================================================================================
...
At iterate   10    f=  7.72997D-03    |proj g|=  1.53291D-03
.......
================================================================================
#calls: 20
elapsed: 52.9538669586
fb norms: [0.98595935, 0.98652261, 1.0006876, 1.0270253]
W norm: 0.990435
grad norms: [0.00083028158, 0.0030336769, 0.012371686, 0.021034302, 0.0039531244]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.726210039949
tst_shape: (30, 30)
tst_pe: 0.605703420236
================================================================================
...
At iterate   20    f=  5.78722D-03    |proj g|=  5.69038D-03
.......
================================================================================
#calls: 30
elapsed: 78.1573410034
fb norms: [1.0051153, 1.0076685, 1.064855, 1.1564189]
W norm: 1.0133
grad norms: [0.0016344405, 0.0034110392, 0.013128218, 0.024272639, 0.0055249864]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.773688546529
tst_shape: (30, 30)
tst_pe: 0.631137441232
================================================================================
...
At iterate   30    f=  4.47015D-03    |proj g|=  2.59302D-03
.......
================================================================================
#calls: 40
elapsed: 103.411024094
fb norms: [1.0631882, 1.0689634, 1.190522, 1.3633502]
W norm: 1.07322
grad norms: [0.0011359412, 0.0043485458, 0.012512797, 0.018565282, 0.0020444631]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.820812961632
tst_shape: (30, 30)
tst_pe: 0.619608763306
================================================================================
...
At iterate   40    f=  2.44963D-03    |proj g|=  1.40229D-03
.......
================================================================================
#calls: 50
elapsed: 128.768837929
fb norms: [1.1446592, 1.1550142, 1.3590325, 1.6266046]
W norm: 1.15727
grad norms: [0.00079954806, 0.002883004, 0.010311473, 0.015000748, 0.003292707]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.877451828004
tst_shape: (30, 30)
tst_pe: 0.622246401501
================================================================================
...
At iterate   50    f=  8.64251D-04    |proj g|=  1.13523D-03
.......
================================================================================
#calls: 60
elapsed: 154.102989912
fb norms: [1.2561338, 1.2742199, 1.6065607, 2.0160384]
W norm: 1.27324
grad norms: [0.00038007135, 0.0012515986, 0.004990465, 0.0067251986, 0.00095068332]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.941311209013
tst_shape: (30, 30)
tst_pe: 0.624432103927
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   61      1     0     0   0.000D+00   1.638D-04
  F =  1.63767312187701464E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.100E-01 seconds.
 Line search           time 1.506E+02 seconds.

 Total User time 1.548E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.655202122215


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775754422477 389 105
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58469700813
fb norms: [0.99999982, 1.0000012, 0.99999994, 0.9999997]
W norm: 1.0
grad norms: [0.007934914, 0.080799952, 0.4476907, 0.97342759, 0.20565395]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.57425469032
tst_shape: (30, 30)
tst_pe: 0.562194954568
================================================================================

At iterate    0    f=  1.78233D-02    |proj g|=  1.20190D-01
..........
================================================================================
#calls: 10
elapsed: 27.6850528717
fb norms: [0.99819821, 0.9982152, 0.99853015, 0.99899924]
W norm: 0.997789
grad norms: [0.0029953485, 0.0075622946, 0.026963463, 0.050915338, 0.010339527]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.647337794978
tst_shape: (30, 30)
tst_pe: 0.612911416421
================================================================================
..
At iterate   10    f=  9.07088D-03    |proj g|=  8.93857D-03
........
================================================================================
#calls: 20
elapsed: 52.8396978378
fb norms: [0.98001271, 0.98157084, 0.99473113, 1.017262]
W norm: 0.978845
grad norms: [0.0012718464, 0.0031152605, 0.012505977, 0.023484927, 0.0053222873]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.734911706178
tst_shape: (30, 30)
tst_pe: 0.625928513807
================================================================================
..
At iterate   20    f=  6.32678D-03    |proj g|=  6.67849D-03
........
================================================================================
#calls: 30
elapsed: 78.0684008598
fb norms: [1.0004631, 1.0058888, 1.0611569, 1.1510363]
W norm: 0.997413
grad norms: [0.0010436985, 0.0033432168, 0.013207587, 0.016573988, 0.0028146447]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.782893654697
tst_shape: (30, 30)
tst_pe: 0.611925210956
================================================================================
..
At iterate   30    f=  4.66102D-03    |proj g|=  2.67500D-03
........
================================================================================
#calls: 40
elapsed: 103.304663897
fb norms: [1.0483469, 1.057153, 1.1608189, 1.3105421]
W norm: 1.04596
grad norms: [0.0015115091, 0.0039127897, 0.020677619, 0.038111299, 0.0083940132]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.823572133473
tst_shape: (30, 30)
tst_pe: 0.598226012254
================================================================================
..
At iterate   40    f=  3.12707D-03    |proj g|=  1.34328D-03
........
================================================================================
#calls: 50
elapsed: 128.617662907
fb norms: [1.1322379, 1.1481103, 1.3620307, 1.6466943]
W norm: 1.13226
grad norms: [0.00087314419, 0.0028148058, 0.0096321683, 0.014540469, 0.0022957225]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.870890001638
tst_shape: (30, 30)
tst_pe: 0.593414907543
================================================================================
..
At iterate   50    f=  1.32308D-03    |proj g|=  1.27689D-03
.......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   60      1     0     0   0.000D+00   3.456D-04
  F =  3.45569831551983953E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.966E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.510E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.6504332506


********************************************************************************
>>> Finding a balanced patch...
bal: 0.771071800208 476 702
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57742905617
fb norms: [0.99999958, 1.0000019, 1.0000011, 0.99999952]
W norm: 1.0
grad norms: [0.0050965692, 0.056645684, 0.26794818, 0.72760135, 0.14692394]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.567795654058
tst_shape: (30, 30)
tst_pe: 0.548426686751
================================================================================

At iterate    0    f=  1.55591D-02    |proj g|=  9.57286D-02
..........
================================================================================
#calls: 10
elapsed: 27.7028081417
fb norms: [0.99556446, 0.9955954, 0.99636984, 0.99769557]
W norm: 0.99612
grad norms: [0.0041995104, 0.008420378, 0.027522182, 0.077504009, 0.017161105]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.666577930907
tst_shape: (30, 30)
tst_pe: 0.622997842549
================================================================================
..
At iterate   10    f=  8.58051D-03    |proj g|=  4.75755D-03
........
================================================================================
#calls: 20
elapsed: 52.8779630661
fb norms: [0.9688158, 0.9703635, 0.98640323, 1.0101018]
W norm: 0.971627
grad norms: [0.00056838844, 0.0018749795, 0.0099916086, 0.014533355, 0.0015789857]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.729959287815
tst_shape: (30, 30)
tst_pe: 0.633604890212
================================================================================
..
At iterate   20    f=  6.50730D-03    |proj g|=  2.97910D-03
........
================================================================================
#calls: 30
elapsed: 78.0718741417
fb norms: [0.98590213, 0.9904961, 1.0531986, 1.1430558]
W norm: 0.988744
grad norms: [0.0020192489, 0.0072892923, 0.029481037, 0.069332868, 0.014579642]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.787877312106
tst_shape: (30, 30)
tst_pe: 0.634092423245
================================================================================
..
At iterate   30    f=  4.71335D-03    |proj g|=  1.17759D-03
........
================================================================================
#calls: 40
elapsed: 103.292112112
fb norms: [1.0507826, 1.0593078, 1.1960225, 1.3819008]
W norm: 1.05438
grad norms: [0.00074920995, 0.0045684311, 0.020801773, 0.042013012, 0.0082604354]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.834309647787
tst_shape: (30, 30)
tst_pe: 0.615928322008
================================================================================
..
At iterate   40    f=  2.77294D-03    |proj g|=  1.47197D-03
........
================================================================================
#calls: 50
elapsed: 128.561463118
fb norms: [1.1430863, 1.1582279, 1.407601, 1.7248421]
W norm: 1.14882
grad norms: [0.00083856273, 0.0035388444, 0.0097491965, 0.012961536, 0.0016573539]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.889656905369
tst_shape: (30, 30)
tst_pe: 0.609057321068
================================================================================
..
At iterate   50    f=  1.12274D-03    |proj g|=  1.55264D-03
.......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   60      1     0     0   0.000D+00   2.207D-04
  F =  2.20685440581291914E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.054E-01 seconds.
 Line search           time 1.468E+02 seconds.

 Total User time 1.510E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.654728284809


********************************************************************************
>>> Finding a balanced patch...
bal: 0.784079084287 161 201
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56939482689
fb norms: [0.99999994, 1.0000002, 1.0000005, 0.9999997]
W norm: 1.0
grad norms: [0.0045895241, 0.041172381, 0.25157484, 0.69745129, 0.12796029]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.587827370975
tst_shape: (30, 30)
tst_pe: 0.571852081575
================================================================================

At iterate    0    f=  1.39313D-02    |proj g|=  8.71897D-02
..........
================================================================================
#calls: 10
elapsed: 27.7086598873
fb norms: [0.99663752, 0.99668813, 0.99749261, 0.99907357]
W norm: 0.996471
grad norms: [0.0022630983, 0.0049814857, 0.018875374, 0.038407907, 0.0065148631]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.665147340571
tst_shape: (30, 30)
tst_pe: 0.619472537041
================================================================================
..
At iterate   10    f=  8.00445D-03    |proj g|=  3.04547D-03
........
================================================================================
#calls: 20
elapsed: 52.9164438248
fb norms: [0.97949982, 0.98092586, 0.99721831, 1.025156]
W norm: 0.978786
grad norms: [0.0011449857, 0.005043922, 0.013900449, 0.027046772, 0.0056447312]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.728946448546
tst_shape: (30, 30)
tst_pe: 0.619975364579
================================================================================
..
At iterate   20    f=  6.14235D-03    |proj g|=  3.45982D-03
........
================================================================================
#calls: 30
elapsed: 78.1398718357
fb norms: [0.99334979, 0.99768746, 1.050612, 1.1327413]
W norm: 0.992214
grad norms: [0.0012951688, 0.0037393463, 0.010150651, 0.017669296, 0.0029702398]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.774306225203
tst_shape: (30, 30)
tst_pe: 0.621553122784
================================================================================
..
At iterate   30    f=  4.57739D-03    |proj g|=  1.90843D-03
........
================================================================================
#calls: 40
elapsed: 103.356379986
fb norms: [1.0540857, 1.0634633, 1.1777372, 1.3438491]
W norm: 1.05548
grad norms: [0.0010150915, 0.0028013512, 0.010392852, 0.016793665, 0.0031453543]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.824882532013
tst_shape: (30, 30)
tst_pe: 0.60564780787
================================================================================
..
At iterate   40    f=  2.91839D-03    |proj g|=  1.45762D-03
........
================================================================================
#calls: 50
elapsed: 128.664413929
fb norms: [1.1495916, 1.1676373, 1.3803445, 1.6671547]
W norm: 1.15563
grad norms: [0.0008632458, 0.0030938599, 0.012998977, 0.028613167, 0.0056872638]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.885609763243
tst_shape: (30, 30)
tst_pe: 0.588531514455
================================================================================
..
At iterate   50    f=  1.08280D-03    |proj g|=  9.91811D-04
.......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   60      1     0     0   0.000D+00   2.484D-04
  F =  2.48421478318050504E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.015E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.511E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.648815592951


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780437044745 270 455
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.5695810318
fb norms: [1.0000001, 1.0000005, 0.99999988, 0.9999997]
W norm: 1.0
grad norms: [0.0017824338, 0.026524831, 0.22210252, 0.5963164, 0.11516504]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.588276907004
tst_shape: (30, 30)
tst_pe: 0.534901502779
================================================================================

At iterate    0    f=  1.30258D-02    |proj g|=  7.65013D-02
..........
================================================================================
#calls: 10
elapsed: 27.6971731186
fb norms: [0.99723762, 0.99727893, 0.99782884, 0.99931407]
W norm: 0.997454
grad norms: [0.0018900009, 0.004839079, 0.015317454, 0.023435304, 0.0040208288]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.658994056244
tst_shape: (30, 30)
tst_pe: 0.585549858174
================================================================================
..
At iterate   10    f=  8.37116D-03    |proj g|=  7.10356D-03
........
================================================================================
#calls: 20
elapsed: 52.9099140167
fb norms: [0.97815579, 0.98012584, 0.99837089, 1.0325224]
W norm: 0.979384
grad norms: [0.00080392428, 0.0028504392, 0.011312022, 0.022417722, 0.003553174]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.728138110571
tst_shape: (30, 30)
tst_pe: 0.59997681976
================================================================================
..
At iterate   20    f=  6.14225D-03    |proj g|=  1.19319D-02
........
================================================================================
#calls: 30
elapsed: 78.1070649624
fb norms: [1.0042478, 1.0114874, 1.0873955, 1.216616]
W norm: 1.00479
grad norms: [0.0014933804, 0.00391861, 0.021510225, 0.041249655, 0.010031918]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.792109283276
tst_shape: (30, 30)
tst_pe: 0.607708926055
================================================================================
..
At iterate   30    f=  4.21857D-03    |proj g|=  1.16710D-03
........
================================================================================
#calls: 40
elapsed: 103.352400064
fb norms: [1.0572875, 1.0688956, 1.1958096, 1.3956798]
W norm: 1.058
grad norms: [0.00086806651, 0.0042192605, 0.011643893, 0.017492186, 0.0037741568]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.835089520282
tst_shape: (30, 30)
tst_pe: 0.603643975765
================================================================================
..
At iterate   40    f=  2.66457D-03    |proj g|=  2.65395D-03
........
================================================================================
#calls: 50
elapsed: 128.725208998
fb norms: [1.1425873, 1.1635162, 1.395606, 1.7239482]
W norm: 1.14595
grad norms: [0.00065910176, 0.0022058773, 0.0088765332, 0.013187536, 0.0020840128]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.887038279613
tst_shape: (30, 30)
tst_pe: 0.59731484769
================================================================================
..
At iterate   50    f=  9.41137D-04    |proj g|=  3.49332D-03
.......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   60      1     0     0   0.000D+00   3.317D-04
  F =  3.31689865561202168E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.029E-01 seconds.
 Line search           time 1.471E+02 seconds.

 Total User time 1.513E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.648054701179


********************************************************************************
>>> Finding a balanced patch...
bal: 0.790322580645 1016 295
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58607411385
fb norms: [0.99999964, 1.0, 1.0000001, 1.0000002]
W norm: 1.0
grad norms: [0.0010486511, 0.020828066, 0.15353855, 0.37268928, 0.079258598]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.595270270054
tst_shape: (30, 30)
tst_pe: 0.559286047857
================================================================================

At iterate    0    f=  1.09958D-02    |proj g|=  4.81872D-02
..........
================================================================================
#calls: 10
elapsed: 27.6937141418
fb norms: [0.99621207, 0.99630684, 0.99710846, 0.99943036]
W norm: 0.996865
grad norms: [0.0015149435, 0.0045352718, 0.024607625, 0.051329423, 0.010714183]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.676754969757
tst_shape: (30, 30)
tst_pe: 0.606855528229
================================================================================
...
At iterate   10    f=  7.24409D-03    |proj g|=  1.19091D-03
.......
================================================================================
#calls: 20
elapsed: 52.8582220078
fb norms: [0.98702222, 0.9906224, 1.0274282, 1.0942312]
W norm: 0.989925
grad norms: [0.0014964641, 0.0047503095, 0.017909767, 0.032693006, 0.0084714638]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.755042291767
tst_shape: (30, 30)
tst_pe: 0.603741774579
================================================================================
...
At iterate   20    f=  4.97798D-03    |proj g|=  1.28870D-03
.......
================================================================================
#calls: 30
elapsed: 78.1101231575
fb norms: [1.0392882, 1.048968, 1.1530333, 1.3088797]
W norm: 1.04261
grad norms: [0.00094226963, 0.0038862859, 0.010421654, 0.013897575, 0.001963916]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.80804217557
tst_shape: (30, 30)
tst_pe: 0.581431154499
================================================================================
...
At iterate   30    f=  2.84779D-03    |proj g|=  1.14218D-03
.......
================================================================================
#calls: 40
elapsed: 103.326107979
fb norms: [1.1127785, 1.1302013, 1.3158431, 1.5527166]
W norm: 1.11731
grad norms: [0.0006349826, 0.0061096833, 0.030561287, 0.036635093, 0.0085417386]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.863284669591
tst_shape: (30, 30)
tst_pe: 0.573108655978
================================================================================
...
At iterate   40    f=  1.44066D-03    |proj g|=  1.09726D-03
.......
================================================================================
#calls: 50
elapsed: 128.591441154
fb norms: [1.2220572, 1.255039, 1.6055814, 1.9976239]
W norm: 1.23016
grad norms: [0.00083132461, 0.0052481159, 0.021525357, 0.027278256, 0.0070870472]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.929308881108
tst_shape: (30, 30)
tst_pe: 0.558613686116
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   3.944D-04
  F =  3.94367176340892911E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 3.545E-01 seconds.
 Line search           time 1.278E+02 seconds.

 Total User time 1.318E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.65248604578


********************************************************************************
>>> Finding a balanced patch...
bal: 0.776014568158 719 337
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56581902504
fb norms: [1.0, 0.9999997, 1.0000011, 0.99999982]
W norm: 1.0
grad norms: [0.0032934253, 0.054195024, 0.33270687, 0.50912839, 0.1115751]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.569775668759
tst_shape: (30, 30)
tst_pe: 0.514561305724
================================================================================

At iterate    0    f=  1.36140D-02    |proj g|=  7.95525D-02
..........
================================================================================
#calls: 10
elapsed: 27.7134289742
fb norms: [0.99796546, 0.99800235, 0.99880564, 0.99990708]
W norm: 0.998054
grad norms: [0.0016551632, 0.005509513, 0.019214986, 0.030235063, 0.0051393588]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.641535979403
tst_shape: (30, 30)
tst_pe: 0.585806013105
================================================================================
..
At iterate   10    f=  8.71364D-03    |proj g|=  5.17598D-03
........
================================================================================
#calls: 20
elapsed: 52.8901309967
fb norms: [0.98178315, 0.98357677, 1.0024291, 1.0315597]
W norm: 0.983178
grad norms: [0.0011837516, 0.0046385187, 0.014229573, 0.015508767, 0.0027960902]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.713582191805
tst_shape: (30, 30)
tst_pe: 0.588332720737
================================================================================
..
At iterate   20    f=  6.54052D-03    |proj g|=  1.74870D-03
........
================================================================================
#calls: 30
elapsed: 78.0979349613
fb norms: [1.0047034, 1.010054, 1.0798439, 1.1728374]
W norm: 1.00693
grad norms: [0.0014509979, 0.003598629, 0.019872196, 0.022019861, 0.0059397374]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.77398737328
tst_shape: (30, 30)
tst_pe: 0.589229853295
================================================================================
..
At iterate   30    f=  4.60376D-03    |proj g|=  1.60759D-03
........
================================================================================
#calls: 40
elapsed: 103.32361412
fb norms: [1.0730631, 1.0839688, 1.2304121, 1.397472]
W norm: 1.07612
grad norms: [0.0012810795, 0.0062402808, 0.014929375, 0.018684043, 0.0030581045]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.828245074132
tst_shape: (30, 30)
tst_pe: 0.58088029804
================================================================================
..
At iterate   40    f=  2.63251D-03    |proj g|=  2.33057D-03
........
================================================================================
#calls: 50
elapsed: 128.592396975
fb norms: [1.1618949, 1.1817088, 1.440133, 1.7028124]
W norm: 1.16679
grad norms: [0.00076544, 0.0063903476, 0.015057127, 0.018607836, 0.0040449821]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.879292048636
tst_shape: (30, 30)
tst_pe: 0.565689070166
================================================================================
..
At iterate   50    f=  9.16902D-04    |proj g|=  2.62471D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   5.018D-04
  F =  5.01804868690669537E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.521E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.650483706196


********************************************************************************
>>> Finding a balanced patch...
bal: 0.783298647242 791 216
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62683320045
fb norms: [1.0000002, 0.99999911, 0.99999899, 0.99999887]
W norm: 1.0
grad norms: [0.0050755735, 0.057080716, 0.3049705, 0.46355525, 0.11810669]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.565205139772
tst_shape: (30, 30)
tst_pe: 0.513579191478
================================================================================

At iterate    0    f=  1.38258D-02    |proj g|=  8.41258D-02
..........
================================================================================
#calls: 10
elapsed: 27.7650880814
fb norms: [0.99771082, 0.99781179, 0.99884951, 0.99961597]
W norm: 0.998204
grad norms: [0.0020594201, 0.0050190836, 0.023568939, 0.031874675, 0.0089618973]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.651286514221
tst_shape: (30, 30)
tst_pe: 0.581666164433
================================================================================
..
At iterate   10    f=  8.28427D-03    |proj g|=  3.61899D-03
........
================================================================================
#calls: 20
elapsed: 52.9483230114
fb norms: [0.97891885, 0.98160875, 1.0248742, 1.0530611]
W norm: 0.982438
grad norms: [0.0018611162, 0.0075913831, 0.024279162, 0.03464039, 0.010453503]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.749181111732
tst_shape: (30, 30)
tst_pe: 0.621122077066
================================================================================
..
At iterate   20    f=  5.83985D-03    |proj g|=  1.22247D-03
........
================================================================================
#calls: 30
elapsed: 78.1625151634
fb norms: [1.0058385, 1.0119085, 1.1043746, 1.1686935]
W norm: 1.0074
grad norms: [0.0010149444, 0.0048379609, 0.015520399, 0.024556935, 0.0061712861]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.793147683231
tst_shape: (30, 30)
tst_pe: 0.610276119452
================================================================================
..
At iterate   30    f=  4.07941D-03    |proj g|=  1.50554D-03
........
================================================================================
#calls: 40
elapsed: 103.406854153
fb norms: [1.0816863, 1.0949174, 1.2791345, 1.410836]
W norm: 1.08336
grad norms: [0.0012203626, 0.0044542844, 0.01565852, 0.020061944, 0.0039435094]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.849786184803
tst_shape: (30, 30)
tst_pe: 0.579410754835
================================================================================
..
At iterate   40    f=  1.77719D-03    |proj g|=  3.47181D-03
........
================================================================================
#calls: 50
elapsed: 128.694283009
fb norms: [1.1999494, 1.2282636, 1.5995165, 1.8642403]
W norm: 1.2048
grad norms: [0.00067219319, 0.0029577326, 0.012147887, 0.012126045, 0.002679029]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.915611176482
tst_shape: (30, 30)
tst_pe: 0.574024686768
================================================================================
..
At iterate   50    f=  4.59980D-04    |proj g|=  6.02215D-04
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   55      1     0     0   0.000D+00   2.701D-04
  F =  2.70131975412368774E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.170E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.391E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.657395749723


********************************************************************************
>>> Finding a balanced patch...
bal: 0.788761706556 187 379
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56365299225
fb norms: [0.99999994, 1.0000011, 1.0000008, 1.0000008]
W norm: 1.0
grad norms: [0.0017169591, 0.04404588, 0.25996789, 0.32491833, 0.084154643]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.554156324619
tst_shape: (30, 30)
tst_pe: 0.536589629487
================================================================================

At iterate    0    f=  1.21187D-02    |proj g|=  5.85248D-02
..........
================================================================================
#calls: 10
elapsed: 27.7299921513
fb norms: [0.99662787, 0.996777, 0.99902123, 1.0017341]
W norm: 0.997658
grad norms: [0.00055554701, 0.0065662982, 0.044137146, 0.054949209, 0.01402027]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.652867040679
tst_shape: (30, 30)
tst_pe: 0.605056761932
================================================================================
...
At iterate   10    f=  7.89749D-03    |proj g|=  2.43108D-03
.......
================================================================================
#calls: 20
elapsed: 52.9049501419
fb norms: [0.98830593, 0.99075848, 1.0294005, 1.076831]
W norm: 0.989151
grad norms: [0.0031945582, 0.011858886, 0.053597555, 0.074478157, 0.020571033]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.731797679173
tst_shape: (30, 30)
tst_pe: 0.615882516292
================================================================================
...
At iterate   20    f=  5.84003D-03    |proj g|=  1.43503D-03
.......
================================================================================
#calls: 30
elapsed: 78.1151731014
fb norms: [1.0266691, 1.0323133, 1.1297526, 1.2281562]
W norm: 1.02598
grad norms: [0.0011255693, 0.0047384379, 0.013116444, 0.01676091, 0.0023878324]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.77880971455
tst_shape: (30, 30)
tst_pe: 0.590827727544
================================================================================
...
At iterate   30    f=  3.52657D-03    |proj g|=  2.63342D-03
.......
================================================================================
#calls: 40
elapsed: 103.361589193
fb norms: [1.0933299, 1.1050274, 1.3031462, 1.4780076]
W norm: 1.09221
grad norms: [0.00099184981, 0.0038834431, 0.012900481, 0.014168394, 0.0022726329]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.841406513974
tst_shape: (30, 30)
tst_pe: 0.591952826742
================================================================================
...
At iterate   40    f=  1.71852D-03    |proj g|=  2.02868D-03
.......
================================================================================
#calls: 50
elapsed: 128.602694988
fb norms: [1.1910499, 1.213032, 1.562475, 1.8472185]
W norm: 1.19112
grad norms: [0.00069774361, 0.0025413891, 0.0083663156, 0.011461834, 0.0020681371]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.905991595739
tst_shape: (30, 30)
tst_pe: 0.594267316733
================================================================================
...
At iterate   50    f=  3.16681D-04    |proj g|=  9.99812D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   2.504D-04
  F =  2.50448269071057439E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.970E-01 seconds.
 Line search           time 1.349E+02 seconds.

 Total User time 1.390E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.663774859134


********************************************************************************
>>> Finding a balanced patch...
bal: 0.768730489074 14 64
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62113118172
fb norms: [1.0000002, 1.0000006, 0.99999928, 0.99999976]
W norm: 1.0
grad norms: [0.0038202095, 0.0073806373, 0.037098739, 0.068843171, 0.020417903]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.53946983092
tst_shape: (30, 30)
tst_pe: 0.552189081777
================================================================================

At iterate    0    f=  1.21175D-02    |proj g|=  1.88470D-02
..........
================================================================================
#calls: 10
elapsed: 27.7342262268
fb norms: [0.99188149, 0.99226779, 0.99651968, 1.0026118]
W norm: 0.994352
grad norms: [0.001011543, 0.0041690757, 0.011343031, 0.018782353, 0.0024737034]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.65900926651
tst_shape: (30, 30)
tst_pe: 0.61831912985
================================================================================
...
At iterate   10    f=  8.20119D-03    |proj g|=  1.34728D-03
.......
================================================================================
#calls: 20
elapsed: 52.889083147
fb norms: [0.98324239, 0.98639697, 1.0143229, 1.0513852]
W norm: 0.989491
grad norms: [0.00057026179, 0.002671401, 0.0078061949, 0.011639124, 0.0013182628]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.739646503456
tst_shape: (30, 30)
tst_pe: 0.642347392751
================================================================================
...
At iterate   20    f=  5.77927D-03    |proj g|=  4.80902D-03
.......
================================================================================
#calls: 30
elapsed: 78.0730822086
fb norms: [1.030076, 1.0396751, 1.1516227, 1.2861847]
W norm: 1.03874
grad norms: [0.0013578288, 0.0055110571, 0.017027218, 0.026765913, 0.00670555]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.802937227302
tst_shape: (30, 30)
tst_pe: 0.615386252684
================================================================================
...
At iterate   30    f=  3.67394D-03    |proj g|=  3.55678D-03
.......
================================================================================
#calls: 40
elapsed: 103.330079079
fb norms: [1.1269307, 1.1460555, 1.3838814, 1.6563371]
W norm: 1.13945
grad norms: [0.0005860625, 0.0049290131, 0.015071421, 0.021392351, 0.0040756883]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.85941859881
tst_shape: (30, 30)
tst_pe: 0.592673013209
================================================================================
...
At iterate   40    f=  1.65667D-03    |proj g|=  1.69250D-03
.......
================================================================================
#calls: 50
elapsed: 128.617194176
fb norms: [1.2178138, 1.2474172, 1.6059444, 1.9983221]
W norm: 1.23452
grad norms: [0.00063436112, 0.0062186117, 0.009348196, 0.011779685, 0.0022578815]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.915813548092
tst_shape: (30, 30)
tst_pe: 0.587097958669
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   5.332D-04
  F =  5.33199636265635490E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.501E-01 seconds.
 Line search           time 1.277E+02 seconds.

 Total User time 1.318E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.66731188492


********************************************************************************
>>> Finding a balanced patch...
bal: 0.78459937565 838 520
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60020089149
fb norms: [1.0000001, 1.0000007, 1.0000001, 1.0000006]
W norm: 1.0
grad norms: [0.0060751918, 0.055661339, 0.28492582, 0.55289972, 0.13115381]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.575897174435
tst_shape: (30, 30)
tst_pe: 0.534512228979
================================================================================

At iterate    0    f=  1.46488D-02    |proj g|=  9.79319D-02
..........
================================================================================
#calls: 10
elapsed: 27.7258799076
fb norms: [0.9991895, 0.99926758, 0.99993002, 1.0007089]
W norm: 0.998727
grad norms: [0.0010576712, 0.0027091657, 0.013629004, 0.018491756, 0.0022506337]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.643785978686
tst_shape: (30, 30)
tst_pe: 0.585027963489
================================================================================
..
At iterate   10    f=  8.55875D-03    |proj g|=  8.31909D-03
........
================================================================================
#calls: 20
elapsed: 52.8652229309
fb norms: [0.98865372, 0.99011844, 1.0176681, 1.0476435]
W norm: 0.988983
grad norms: [0.00085587142, 0.0028400349, 0.0090902979, 0.012553154, 0.0016479986]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.731665334422
tst_shape: (30, 30)
tst_pe: 0.622778327431
================================================================================
..
At iterate   20    f=  6.24867D-03    |proj g|=  3.55536D-03
........
================================================================================
#calls: 30
elapsed: 78.0965278149
fb norms: [1.015079, 1.0195603, 1.0985346, 1.1714387]
W norm: 1.01583
grad norms: [0.001688139, 0.0060978518, 0.016597785, 0.019121166, 0.0045643859]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.784994925724
tst_shape: (30, 30)
tst_pe: 0.615254465123
================================================================================
..
At iterate   30    f=  4.24946D-03    |proj g|=  2.52144D-03
........
================================================================================
#calls: 40
elapsed: 103.325752974
fb norms: [1.1034842, 1.1170669, 1.3345835, 1.5100234]
W norm: 1.10745
grad norms: [0.00085166877, 0.0045348783, 0.015569621, 0.017196165, 0.0029395788]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.845669314124
tst_shape: (30, 30)
tst_pe: 0.597743556403
================================================================================
..
At iterate   40    f=  2.33199D-03    |proj g|=  1.66852D-03
........
================================================================================
#calls: 50
elapsed: 128.638537884
fb norms: [1.2162702, 1.2410132, 1.5934521, 1.856039]
W norm: 1.22806
grad norms: [0.00066093932, 0.002418845, 0.0077869603, 0.0077655907, 0.0012994922]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.908113941653
tst_shape: (30, 30)
tst_pe: 0.591758673248
================================================================================
..
At iterate   50    f=  5.29046D-04    |proj g|=  8.97315D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   54      1     0     0   0.000D+00   4.471D-04
  F =  4.47107246145606041E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.965E-01 seconds.
 Line search           time 1.325E+02 seconds.

 Total User time 1.366E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.666713482288


********************************************************************************
>>> Finding a balanced patch...
bal: 0.793964620187 128 647
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62322187424
fb norms: [0.99999976, 0.99999964, 0.99999797, 1.0000001]
W norm: 1.0
grad norms: [0.0066923699, 0.06698025, 0.36630568, 0.46311951, 0.13285053]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.58223779841
tst_shape: (30, 30)
tst_pe: 0.538976817871
================================================================================

At iterate    0    f=  1.50419D-02    |proj g|=  1.04117D-01
..........
================================================================================
#calls: 10
elapsed: 27.7598369122
fb norms: [1.0007963, 1.0008285, 1.0012727, 1.0016749]
W norm: 1.0006
grad norms: [0.0014148296, 0.0061480366, 0.024147924, 0.033025324, 0.0096314279]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.643895803271
tst_shape: (30, 30)
tst_pe: 0.592117328567
================================================================================
..
At iterate   10    f=  8.17561D-03    |proj g|=  5.23952D-03
........
================================================================================
#calls: 20
elapsed: 52.9320919514
fb norms: [1.0037093, 1.0060748, 1.0385524, 1.0695858]
W norm: 1.00611
grad norms: [0.0014342102, 0.0041683693, 0.013849876, 0.013558256, 0.0024258022]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.746032328166
tst_shape: (30, 30)
tst_pe: 0.613511520894
================================================================================
..
At iterate   20    f=  5.50479D-03    |proj g|=  1.31681D-03
........
================================================================================
#calls: 30
elapsed: 78.1486268044
fb norms: [1.0444007, 1.0506181, 1.1495129, 1.2386531]
W norm: 1.0482
grad norms: [0.000878038, 0.0033101873, 0.011834618, 0.012893496, 0.0018031859]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.794029124186
tst_shape: (30, 30)
tst_pe: 0.623126759587
================================================================================
..
At iterate   30    f=  3.24790D-03    |proj g|=  1.58636D-03
........
================================================================================
#calls: 40
elapsed: 103.420789957
fb norms: [1.1337131, 1.1481843, 1.3645133, 1.5455458]
W norm: 1.14284
grad norms: [0.0011194827, 0.0033875203, 0.015284601, 0.016249688, 0.0034240345]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.857796186446
tst_shape: (30, 30)
tst_pe: 0.607686516668
================================================================================
..
At iterate   40    f=  1.28539D-03    |proj g|=  1.32600D-03
........
================================================================================
#calls: 50
elapsed: 128.73042798
fb norms: [1.2416999, 1.2680668, 1.6332603, 1.918892]
W norm: 1.25912
grad norms: [0.00045807543, 0.0034132209, 0.0083346469, 0.0074078534, 0.0013926306]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.925453438594
tst_shape: (30, 30)
tst_pe: 0.618292806819
================================================================================
..
At iterate   50    f=  2.04483D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   50   53      1     0     0   0.000D+00   2.045D-04
  F =  2.04483367269858718E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.882E-01 seconds.
 Line search           time 1.302E+02 seconds.

 Total User time 1.343E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.663709881532


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775234131113 592 391
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.5823328495
fb norms: [0.9999997, 1.0000005, 0.9999994, 0.9999997]
W norm: 1.0
grad norms: [0.0052446658, 0.062636539, 0.75521857, 0.73859245, 0.18993264]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.584344788442
tst_shape: (30, 30)
tst_pe: 0.569849971928
================================================================================

At iterate    0    f=  2.09084D-02    |proj g|=  1.41032D-01
..........
================================================================================
#calls: 10
elapsed: 27.6944389343
fb norms: [0.99710602, 0.99717796, 0.99797207, 0.9988625]
W norm: 0.995753
grad norms: [0.0012172943, 0.0046029221, 0.025071856, 0.026201418, 0.005649894]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.668109865395
tst_shape: (30, 30)
tst_pe: 0.623708004054
================================================================================
...
At iterate   10    f=  7.65118D-03    |proj g|=  7.70703D-03
.......
================================================================================
#calls: 20
elapsed: 52.8531308174
fb norms: [0.98062593, 0.98365575, 1.011881, 1.0402139]
W norm: 0.976443
grad norms: [0.0010329485, 0.0061297598, 0.01146753, 0.012067359, 0.0025895406]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.747213725463
tst_shape: (30, 30)
tst_pe: 0.632137947954
================================================================================
...
At iterate   20    f=  5.52123D-03    |proj g|=  1.18672D-03
.......
================================================================================
#calls: 30
elapsed: 78.0327148438
fb norms: [1.017787, 1.0275507, 1.124215, 1.216225]
W norm: 1.01113
grad norms: [0.0010044492, 0.0053395876, 0.015043502, 0.017617047, 0.0029969909]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.798072481634
tst_shape: (30, 30)
tst_pe: 0.611807912932
================================================================================
...
At iterate   30    f=  3.73256D-03    |proj g|=  1.03829D-03
.......
================================================================================
#calls: 40
elapsed: 103.330242872
fb norms: [1.09405, 1.1131828, 1.3151523, 1.4901725]
W norm: 1.08834
grad norms: [0.00089788286, 0.00527529, 0.0096152509, 0.01063875, 0.0020588818]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.854047342159
tst_shape: (30, 30)
tst_pe: 0.587659522691
================================================================================
...
At iterate   40    f=  1.64256D-03    |proj g|=  1.77773D-03
.......
================================================================================
#calls: 50
elapsed: 128.61439991
fb norms: [1.2361064, 1.2737068, 1.6784071, 1.9946402]
W norm: 1.23747
grad norms: [0.0004971532, 0.0020171953, 0.0069940225, 0.00843402, 0.0015329404]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.932146226046
tst_shape: (30, 30)
tst_pe: 0.571628311382
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   2.712D-04
  F =  2.71229451755061746E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.486E-01 seconds.
 Line search           time 1.278E+02 seconds.

 Total User time 1.318E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.65749854528


********************************************************************************
>>> Finding a balanced patch...
bal: 0.78121748179 418 288
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58365106583
fb norms: [1.0, 0.99999923, 0.99999875, 1.0]
W norm: 1.0
grad norms: [0.0012564822, 0.046678368, 0.30399436, 0.45858276, 0.11117119]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.564510046277
tst_shape: (30, 30)
tst_pe: 0.525800770496
================================================================================

At iterate    0    f=  1.33452D-02    |proj g|=  7.71215D-02
..........
================================================================================
#calls: 10
elapsed: 27.7193059921
fb norms: [0.99732989, 0.99738461, 0.99828631, 1.0005201]
W norm: 0.998534
grad norms: [0.0013499276, 0.0040803272, 0.018514251, 0.027622797, 0.0060763331]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.654285659963
tst_shape: (30, 30)
tst_pe: 0.620365397198
================================================================================
..
At iterate   10    f=  7.96383D-03    |proj g|=  7.05794D-03
........
================================================================================
#calls: 20
elapsed: 52.8468899727
fb norms: [0.99050528, 0.99369168, 1.0321084, 1.0819178]
W norm: 0.99776
grad norms: [0.0020862371, 0.015233717, 0.047749456, 0.056382161, 0.017067742]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.745910632432
tst_shape: (30, 30)
tst_pe: 0.636502181704
================================================================================
..
At iterate   20    f=  5.96440D-03    |proj g|=  1.36998D-03
........
================================================================================
#calls: 30
elapsed: 78.0612590313
fb norms: [1.0350251, 1.0426017, 1.1413659, 1.2420878]
W norm: 1.04035
grad norms: [0.001268113, 0.0052868109, 0.012048021, 0.015415829, 0.0019547862]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.798647872869
tst_shape: (30, 30)
tst_pe: 0.621929761215
================================================================================
..
At iterate   30    f=  3.69541D-03    |proj g|=  1.79974D-03
........
================================================================================
#calls: 40
elapsed: 103.283600092
fb norms: [1.1190181, 1.1351421, 1.3513221, 1.5363567]
W norm: 1.12687
grad norms: [0.00097248057, 0.0036757421, 0.0097946543, 0.013268996, 0.0025751251]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.858439161772
tst_shape: (30, 30)
tst_pe: 0.616136213566
================================================================================
..
At iterate   40    f=  1.51100D-03    |proj g|=  1.31871D-03
........
================================================================================
#calls: 50
elapsed: 128.54646492
fb norms: [1.2807052, 1.3147025, 1.7675527, 2.1068566]
W norm: 1.29479
grad norms: [0.00071405183, 0.0073450431, 0.028155068, 0.033543114, 0.010658266]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.948405704437
tst_shape: (30, 30)
tst_pe: 0.620479049075
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   51      1     0     0   0.000D+00   1.972D-04
  F =  1.97219851543195546E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 3.521E-01 seconds.
 Line search           time 1.253E+02 seconds.

 Total User time 1.293E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.651434668098


********************************************************************************
>>> Finding a balanced patch...
bal: 0.778095733611 489 230
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62490296364
fb norms: [1.0000004, 0.99999958, 1.0000005, 0.99999923]
W norm: 1.0
grad norms: [0.0025749595, 0.085437283, 0.44145039, 0.64653915, 0.16788118]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.55962373101
tst_shape: (30, 30)
tst_pe: 0.57512091976
================================================================================

At iterate    0    f=  1.63382D-02    |proj g|=  1.09117D-01
..........
================================================================================
#calls: 10
elapsed: 27.7201960087
fb norms: [0.99832332, 0.99833828, 0.99886566, 0.99966025]
W norm: 0.997996
grad norms: [0.0020733103, 0.0047773509, 0.021565367, 0.036544196, 0.0089827478]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.637381978339
tst_shape: (30, 30)
tst_pe: 0.617727607601
================================================================================
..
At iterate   10    f=  9.09196D-03    |proj g|=  1.35198D-02
........
================================================================================
#calls: 20
elapsed: 52.8831989765
fb norms: [0.97336, 0.97732705, 1.0226994, 1.0590168]
W norm: 0.972873
grad norms: [0.00093040854, 0.011266143, 0.045236889, 0.075183161, 0.02242055]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.731446160135
tst_shape: (30, 30)
tst_pe: 0.626502445239
================================================================================
..
At iterate   20    f=  6.37264D-03    |proj g|=  2.56218D-03
........
================================================================================
#calls: 30
elapsed: 78.0528879166
fb norms: [1.0163331, 1.0259476, 1.1281229, 1.2166539]
W norm: 1.01409
grad norms: [0.00095089327, 0.0077742301, 0.025205409, 0.038498845, 0.01026553]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.78509635445
tst_shape: (30, 30)
tst_pe: 0.600181817542
================================================================================
..
At iterate   30    f=  4.23175D-03    |proj g|=  3.73306D-03
........
================================================================================
#calls: 40
elapsed: 103.253880978
fb norms: [1.0838543, 1.1006362, 1.2895402, 1.4458212]
W norm: 1.08277
grad norms: [0.00082309742, 0.0063508647, 0.030513786, 0.047640018, 0.01323824]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.82914252028
tst_shape: (30, 30)
tst_pe: 0.583445965248
================================================================================
..
At iterate   40    f=  2.67121D-03    |proj g|=  1.42025D-03
........
================================================================================
#calls: 50
elapsed: 128.604279995
fb norms: [1.1829799, 1.2092053, 1.5315912, 1.7822629]
W norm: 1.18526
grad norms: [0.00073164073, 0.003474961, 0.0096613467, 0.011453792, 0.0013865968]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.896322604129
tst_shape: (30, 30)
tst_pe: 0.590755789153
================================================================================
..
At iterate   50    f=  6.26240D-04    |proj g|=  9.70400D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   54      1     0     0   0.000D+00   3.857D-04
  F =  3.85706603992730379E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.999E-01 seconds.
 Line search           time 1.325E+02 seconds.

 Total User time 1.366E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.644744483603


********************************************************************************
>>> Finding a balanced patch...
bal: 0.771592091571 1051 134
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.63998699188
fb norms: [0.99999982, 1.0000006, 0.99999988, 0.99999964]
W norm: 1.0
grad norms: [0.0010181763, 0.030554084, 0.15297531, 0.33784601, 0.077837385]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.555848049331
tst_shape: (30, 30)
tst_pe: 0.524414819034
================================================================================

At iterate    0    f=  1.22738D-02    |proj g|=  4.77184D-02
..........
================================================================================
#calls: 10
elapsed: 27.7482089996
fb norms: [0.99761271, 0.9977501, 0.99870324, 1.0005509]
W norm: 0.9997
grad norms: [0.00082856417, 0.0073163165, 0.025604231, 0.046494231, 0.0097001735]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.642841800845
tst_shape: (30, 30)
tst_pe: 0.593911352051
================================================================================
...
At iterate   10    f=  8.04873D-03    |proj g|=  3.05423D-03
.......
================================================================================
#calls: 20
elapsed: 52.9025681019
fb norms: [0.99375665, 0.99880034, 1.0270262, 1.0711056]
W norm: 1.00429
grad norms: [0.0011383075, 0.0049829856, 0.0094524659, 0.012425397, 0.001774071]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.744575387026
tst_shape: (30, 30)
tst_pe: 0.619532052243
================================================================================
...
At iterate   20    f=  5.53635D-03    |proj g|=  3.21954D-03
.......
================================================================================
#calls: 30
elapsed: 78.1213281155
fb norms: [1.0513054, 1.0669304, 1.1818798, 1.3281729]
W norm: 1.06487
grad norms: [0.00053166901, 0.0040036337, 0.01282606, 0.018826123, 0.0050218841]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.810686007051
tst_shape: (30, 30)
tst_pe: 0.605560510751
================================================================================
...
At iterate   30    f=  3.32236D-03    |proj g|=  2.41410D-03
.......
================================================================================
#calls: 40
elapsed: 103.365533113
fb norms: [1.1345613, 1.1620538, 1.3837909, 1.6275928]
W norm: 1.15434
grad norms: [0.000742301, 0.0027657731, 0.012477825, 0.018673079, 0.0050228736]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.865972716872
tst_shape: (30, 30)
tst_pe: 0.596391914015
================================================================================
...
At iterate   40    f=  1.40956D-03    |proj g|=  1.26785D-03
.......
================================================================================
#calls: 50
elapsed: 128.697211027
fb norms: [1.2287971, 1.2700917, 1.6328646, 1.9955231]
W norm: 1.25653
grad norms: [0.00051125308, 0.0016543856, 0.0062766592, 0.0076629473, 0.0013208204]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.925939446238
tst_shape: (30, 30)
tst_pe: 0.599987157138
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   2.760D-04
  F =  2.76010396191850305E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.564E-01 seconds.
 Line search           time 1.278E+02 seconds.

 Total User time 1.318E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.644167682808


********************************************************************************
>>> Finding a balanced patch...
bal: 0.781477627471 839 779
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.6076939106
fb norms: [1.0000008, 1.0000008, 0.99999928, 1.0000007]
W norm: 1.0
grad norms: [0.0084632365, 0.077300303, 0.38081756, 0.69117725, 0.20684306]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.570495099665
tst_shape: (30, 30)
tst_pe: 0.539887513667
================================================================================

At iterate    0    f=  2.03991D-02    |proj g|=  1.40467D-01
..........
================================================================================
#calls: 10
elapsed: 27.7462069988
fb norms: [0.99909335, 0.99914265, 0.99972701, 1.0006223]
W norm: 0.997076
grad norms: [0.0025635001, 0.007568765, 0.027920039, 0.047331799, 0.012913562]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.656044775254
tst_shape: (30, 30)
tst_pe: 0.613956377854
================================================================================
....
At iterate   10    f=  8.19764D-03    |proj g|=  1.15719D-02
......
================================================================================
#calls: 20
elapsed: 52.9129290581
fb norms: [0.98787534, 0.98895741, 1.0069619, 1.0241438]
W norm: 0.979275
grad norms: [0.00088647573, 0.0049238228, 0.013573776, 0.017685466, 0.002119238]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.719410311946
tst_shape: (30, 30)
tst_pe: 0.630131557922
================================================================================
....
At iterate   20    f=  5.85795D-03    |proj g|=  1.76058D-03
......
================================================================================
#calls: 30
elapsed: 78.1010630131
fb norms: [1.0173049, 1.0220193, 1.0999209, 1.1752232]
W norm: 1.00708
grad norms: [0.00087563763, 0.0049905879, 0.013371277, 0.015675733, 0.0038114898]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.784860890482
tst_shape: (30, 30)
tst_pe: 0.637296364079
================================================================================
....
At iterate   30    f=  3.83239D-03    |proj g|=  1.58644D-03
......
================================================================================
#calls: 40
elapsed: 103.345783949
fb norms: [1.0794812, 1.0901293, 1.2624755, 1.4132445]
W norm: 1.0716
grad norms: [0.0010391915, 0.0045994562, 0.016589176, 0.021506632, 0.0046600169]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.834643554371
tst_shape: (30, 30)
tst_pe: 0.629405358361
================================================================================
....
At iterate   40    f=  2.05337D-03    |proj g|=  4.29653D-03
......
================================================================================
#calls: 50
elapsed: 128.604038
fb norms: [1.1836739, 1.2027014, 1.5166972, 1.7695211]
W norm: 1.18047
grad norms: [0.0010710499, 0.0061613736, 0.0253358, 0.030182658, 0.0089341979]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.901380430305
tst_shape: (30, 30)
tst_pe: 0.608335663005
================================================================================
....
At iterate   50    f=  5.75779D-04    |proj g|=  1.79875D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   57      1     0     0   0.000D+00   2.734D-04
  F =  2.73434008704498410E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.194E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.645711125698


********************************************************************************
>>> Finding a balanced patch...
bal: 0.786420395421 1071 502
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57999801636
fb norms: [1.0000001, 0.99999893, 1.0000002, 1.0000007]
W norm: 1.0
grad norms: [0.0023426844, 0.038335897, 0.2419239, 0.43355027, 0.11515515]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.594605023129
tst_shape: (30, 30)
tst_pe: 0.539296601576
================================================================================

At iterate    0    f=  1.26710D-02    |proj g|=  7.58030D-02
..........
================================================================================
#calls: 10
elapsed: 27.7195420265
fb norms: [0.99699175, 0.99714738, 0.99895698, 1.003016]
W norm: 0.999236
grad norms: [0.00073253358, 0.0032944642, 0.012550597, 0.016995179, 0.0031586557]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.699288904481
tst_shape: (30, 30)
tst_pe: 0.613512393524
================================================================================
..
At iterate   10    f=  7.09019D-03    |proj g|=  2.25601D-03
........
================================================================================
#calls: 20
elapsed: 52.8987178802
fb norms: [1.0034484, 1.0062866, 1.0438101, 1.0924929]
W norm: 1.00839
grad norms: [0.001169686, 0.0061436957, 0.01553298, 0.020503782, 0.0055568172]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.773373550218
tst_shape: (30, 30)
tst_pe: 0.631354765789
================================================================================
..
At iterate   20    f=  4.79529D-03    |proj g|=  1.22807D-03
........
================================================================================
#calls: 30
elapsed: 78.0723760128
fb norms: [1.0699264, 1.0791533, 1.2150424, 1.3563488]
W norm: 1.07347
grad norms: [0.0010337406, 0.0068299947, 0.011365225, 0.013997898, 0.002290512]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.820272558825
tst_shape: (30, 30)
tst_pe: 0.578076770152
================================================================================
..
At iterate   30    f=  2.78348D-03    |proj g|=  2.36441D-03
........
================================================================================
#calls: 40
elapsed: 103.328788042
fb norms: [1.1480948, 1.1658189, 1.4003607, 1.6186165]
W norm: 1.15201
grad norms: [0.00083024619, 0.0031334264, 0.010732732, 0.013787209, 0.0029456003]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.873305825862
tst_shape: (30, 30)
tst_pe: 0.582660316293
================================================================================
..
At iterate   40    f=  1.07935D-03    |proj g|=  1.93980D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   46   49      1     0     0   0.000D+00   2.465D-04
  F =  2.46469135163351893E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.257E-01 seconds.
 Line search           time 1.194E+02 seconds.

 Total User time 1.234E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.650135116255


********************************************************************************
>>> Finding a balanced patch...
bal: 0.78616024974 804 98
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61275887489
fb norms: [1.0, 1.0000008, 1.0000002, 1.000001]
W norm: 1.0
grad norms: [0.0013800702, 0.035741359, 0.18253753, 0.31682035, 0.079543829]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.577188507844
tst_shape: (30, 30)
tst_pe: 0.528548672621
================================================================================

At iterate    0    f=  1.13662D-02    |proj g|=  4.94798D-02
..........
================================================================================
#calls: 10
elapsed: 27.7588558197
fb norms: [0.99851084, 0.9985919, 0.99966031, 1.0012739]
W norm: 0.999604
grad norms: [0.0010016216, 0.006515115, 0.031366076, 0.043661684, 0.01011211]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.673836721481
tst_shape: (30, 30)
tst_pe: 0.603179704205
================================================================================
...
At iterate   10    f=  6.97785D-03    |proj g|=  5.50324D-03
.......
================================================================================
#calls: 20
elapsed: 52.926502943
fb norms: [0.98788297, 0.99044651, 1.0165454, 1.0452076]
W norm: 0.992835
grad norms: [0.0010929796, 0.0040373737, 0.010017768, 0.016192164, 0.0027627302]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.749937994969
tst_shape: (30, 30)
tst_pe: 0.612382305106
================================================================================
...
At iterate   20    f=  5.32865D-03    |proj g|=  2.43676D-03
.......
================================================================================
#calls: 30
elapsed: 78.1822938919
fb norms: [1.0198063, 1.0264668, 1.0981027, 1.1752161]
W norm: 1.02473
grad norms: [0.0014728417, 0.0040068678, 0.010181096, 0.01351107, 0.0023301775]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.792279858671
tst_shape: (30, 30)
tst_pe: 0.60516525913
================================================================================
...
At iterate   30    f=  3.30999D-03    |proj g|=  8.33148D-03
.......
================================================================================
#calls: 40
elapsed: 103.423915863
fb norms: [1.1035465, 1.119176, 1.2953475, 1.4638468]
W norm: 1.10904
grad norms: [0.0011500826, 0.0057223183, 0.013120322, 0.01762452, 0.0034964948]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.852676845669
tst_shape: (30, 30)
tst_pe: 0.600962281674
================================================================================
...
At iterate   40    f=  1.35814D-03    |proj g|=  1.44098D-03
.......
================================================================================
#calls: 50
elapsed: 128.722841978
fb norms: [1.2103142, 1.2379533, 1.5604706, 1.848353]
W norm: 1.21803
grad norms: [0.00048351719, 0.0031533192, 0.0070101153, 0.0080009671, 0.0012390424]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.921824718413
tst_shape: (30, 30)
tst_pe: 0.613294029904
================================================================================
...
At iterate   50    f=  2.11989D-04    |proj g|=  6.80257D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   1.443D-04
  F =  1.44298915984109044E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 4.038E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.391E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.652003024474


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777575442248 725 546
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58371496201
fb norms: [1.0000001, 0.99999952, 0.99999928, 1.0000004]
W norm: 1.0
grad norms: [0.0039321464, 0.052510526, 0.27361456, 0.47541171, 0.1204204]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.568929837953
tst_shape: (30, 30)
tst_pe: 0.545281455838
================================================================================

At iterate    0    f=  1.32030D-02    |proj g|=  7.30356D-02
..........
================================================================================
#calls: 10
elapsed: 27.7264609337
fb norms: [0.99666184, 0.99670362, 0.99728954, 0.99804103]
W norm: 0.997205
grad norms: [0.0020780787, 0.00567867, 0.019291464, 0.027331682, 0.005718316]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.636648026207
tst_shape: (30, 30)
tst_pe: 0.589177550168
================================================================================
..
At iterate   10    f=  8.40650D-03    |proj g|=  1.41848D-02
........
================================================================================
#calls: 20
elapsed: 52.9180707932
fb norms: [0.97155285, 0.97321838, 0.99522984, 1.0274602]
W norm: 0.97634
grad norms: [0.00050418434, 0.0037002061, 0.0099171121, 0.013833957, 0.0030373493]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.727700543515
tst_shape: (30, 30)
tst_pe: 0.627868914269
================================================================================
...
At iterate   20    f=  6.44611D-03    |proj g|=  1.64916D-03
.......
================================================================================
#calls: 30
elapsed: 78.1342258453
fb norms: [0.98638201, 0.99257237, 1.0791882, 1.1820682]
W norm: 0.993783
grad norms: [0.0010497615, 0.004816019, 0.016334061, 0.023087537, 0.0053694923]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.779507207344
tst_shape: (30, 30)
tst_pe: 0.618421292257
================================================================================
...
At iterate   30    f=  4.21083D-03    |proj g|=  1.98774D-03
.......
================================================================================
#calls: 40
elapsed: 103.389461994
fb norms: [1.0518056, 1.0644058, 1.2386454, 1.4126828]
W norm: 1.05922
grad norms: [0.001048115, 0.0041635772, 0.014378148, 0.018233104, 0.0040745893]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.834824703996
tst_shape: (30, 30)
tst_pe: 0.609373331765
================================================================================
...
At iterate   40    f=  2.36481D-03    |proj g|=  1.55770D-03
.......
================================================================================
#calls: 50
elapsed: 128.661096811
fb norms: [1.1359321, 1.1565284, 1.4385762, 1.6911045]
W norm: 1.1452
grad norms: [0.00078964175, 0.0027354457, 0.010913968, 0.013628644, 0.002146228]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.886206159297
tst_shape: (30, 30)
tst_pe: 0.599414388532
================================================================================
...
At iterate   50    f=  7.52084D-04    |proj g|=  3.12699D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   60      1     0     0   0.000D+00   1.831D-04
  F =  1.83065523742698133E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 4.985E-01 seconds.
 Line search           time 1.470E+02 seconds.

 Total User time 1.511E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.651530928536


********************************************************************************
>>> Finding a balanced patch...
bal: 0.781477627471 612 642
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.59214687347
fb norms: [0.9999997, 0.99999994, 1.0000004, 0.99999952]
W norm: 1.0
grad norms: [0.0052193874, 0.066907249, 0.35478133, 0.51709521, 0.13766745]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.588811583644
tst_shape: (30, 30)
tst_pe: 0.564688714727
================================================================================

At iterate    0    f=  1.31385D-02    |proj g|=  7.85046D-02
..........
================================================================================
#calls: 10
elapsed: 27.7792580128
fb norms: [0.99730861, 0.99736226, 0.99793011, 0.99903595]
W norm: 0.997593
grad norms: [0.0021342628, 0.0053411098, 0.021913273, 0.032997988, 0.007956218]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.669718256258
tst_shape: (30, 30)
tst_pe: 0.611812928944
================================================================================
..
At iterate   10    f=  7.82543D-03    |proj g|=  2.13390D-03
........
================================================================================
#calls: 20
elapsed: 52.9457759857
fb norms: [0.98126918, 0.98346883, 1.0054626, 1.0340116]
W norm: 0.984544
grad norms: [0.00061853143, 0.0031175651, 0.010369588, 0.012492762, 0.0014080283]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.732529271196
tst_shape: (30, 30)
tst_pe: 0.6128749294
================================================================================
..
At iterate   20    f=  5.85163D-03    |proj g|=  8.10450D-03
........
================================================================================
#calls: 30
elapsed: 78.144974947
fb norms: [1.0065442, 1.0130017, 1.089246, 1.1781714]
W norm: 1.00827
grad norms: [0.0015049812, 0.0042446745, 0.014247999, 0.026164535, 0.0062330766]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.792678296626
tst_shape: (30, 30)
tst_pe: 0.621067478678
================================================================================
..
At iterate   30    f=  4.20275D-03    |proj g|=  1.00809D-03
........
================================================================================
#calls: 40
elapsed: 103.425791025
fb norms: [1.0474131, 1.0581503, 1.1863029, 1.325467]
W norm: 1.04983
grad norms: [0.0011980073, 0.0037300123, 0.014570179, 0.020130234, 0.00486877]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.827484078755
tst_shape: (30, 30)
tst_pe: 0.633109067992
================================================================================
..
At iterate   40    f=  2.53250D-03    |proj g|=  3.71009D-03
........
================================================================================
#calls: 50
elapsed: 128.686558008
fb norms: [1.1499041, 1.171235, 1.4412781, 1.7060016]
W norm: 1.15528
grad norms: [0.0010873277, 0.0041442141, 0.016257025, 0.028662687, 0.0098284837]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.893574493758
tst_shape: (30, 30)
tst_pe: 0.617635328072
================================================================================
..
At iterate   50    f=  6.46457D-04    |proj g|=  1.19364D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   2.208D-04
  F =  2.20760921365581453E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.883E-01 seconds.
 Line search           time 1.446E+02 seconds.

 Total User time 1.487E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.650194443043


********************************************************************************
>>> Finding a balanced patch...
bal: 0.788501560874 4 217
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.63678622246
fb norms: [0.99999976, 1.0000002, 1.0000005, 0.99999899]
W norm: 1.0
grad norms: [0.0025704931, 0.04161853, 0.23413123, 0.48964328, 0.12907241]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.587672845057
tst_shape: (30, 30)
tst_pe: 0.557999352609
================================================================================

At iterate    0    f=  1.19158D-02    |proj g|=  6.44129D-02
..........
================================================================================
#calls: 10
elapsed: 27.7561662197
fb norms: [0.99816072, 0.99818677, 0.99855256, 0.9993673]
W norm: 0.998773
grad norms: [0.0021594951, 0.0073425504, 0.018292151, 0.035101637, 0.0081019774]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.653710986906
tst_shape: (30, 30)
tst_pe: 0.609961618128
================================================================================
..
At iterate   10    f=  8.18866D-03    |proj g|=  3.87545D-03
........
================================================================================
#calls: 20
elapsed: 52.9669802189
fb norms: [0.98315036, 0.98485929, 1.0016432, 1.0207144]
W norm: 0.987175
grad norms: [0.00074447494, 0.0032341811, 0.010479188, 0.015129488, 0.0020584511]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.716811310986
tst_shape: (30, 30)
tst_pe: 0.617666075367
================================================================================
..
At iterate   20    f=  6.00682D-03    |proj g|=  1.18206D-03
........
================================================================================
#calls: 30
elapsed: 78.1590080261
fb norms: [1.0100676, 1.0181781, 1.1075253, 1.2007926]
W norm: 1.0146
grad norms: [0.00080395694, 0.0065668221, 0.019979671, 0.03104575, 0.0077097146]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.784799168598
tst_shape: (30, 30)
tst_pe: 0.608880859061
================================================================================
..
At iterate   30    f=  4.07196D-03    |proj g|=  3.27196D-03
........
================================================================================
#calls: 40
elapsed: 103.402427197
fb norms: [1.0577458, 1.0723445, 1.2336824, 1.3937873]
W norm: 1.06155
grad norms: [0.0010652497, 0.0043739816, 0.012316457, 0.012811989, 0.0018679611]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.823215899762
tst_shape: (30, 30)
tst_pe: 0.597897355179
================================================================================
..
At iterate   40    f=  2.53158D-03    |proj g|=  1.05753D-02
........
================================================================================
#calls: 50
elapsed: 128.712381124
fb norms: [1.1151521, 1.1361737, 1.3687371, 1.5827343]
W norm: 1.11883
grad norms: [0.00087365485, 0.003699787, 0.012231474, 0.017019, 0.003609275]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.863291807295
tst_shape: (30, 30)
tst_pe: 0.595647210092
================================================================================
..
At iterate   50    f=  1.07364D-03    |proj g|=  1.01469D-03
.......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   60      1     0     0   0.000D+00   2.375D-04
  F =  2.37450542044825852E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.971E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.511E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.64385162797


********************************************************************************
>>> Finding a balanced patch...
bal: 0.776014568158 397 870
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61899495125
fb norms: [0.99999994, 1.0000008, 0.99999958, 1.0000002]
W norm: 1.0
grad norms: [0.0013310174, 0.043563735, 0.21980752, 0.32458732, 0.073108681]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.600000236898
tst_shape: (30, 30)
tst_pe: 0.545655450215
================================================================================

At iterate    0    f=  1.07999D-02    |proj g|=  3.76505D-02
..........
================================================================================
#calls: 10
elapsed: 27.7407748699
fb norms: [0.99891567, 0.99899459, 1.000159, 1.0020218]
W norm: 1.00046
grad norms: [0.0013583369, 0.0076167863, 0.027469639, 0.032262433, 0.0053411969]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.682280473576
tst_shape: (30, 30)
tst_pe: 0.60398125442
================================================================================
...
At iterate   10    f=  7.29055D-03    |proj g|=  7.94216D-03
.......
================================================================================
#calls: 20
elapsed: 52.898624897
fb norms: [0.99317139, 0.99500579, 1.0195204, 1.048352]
W norm: 1.00073
grad norms: [0.00092541764, 0.005392889, 0.013875653, 0.020219579, 0.0041943956]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.754073757155
tst_shape: (30, 30)
tst_pe: 0.619631020146
================================================================================
...
At iterate   20    f=  5.24704D-03    |proj g|=  2.21209D-03
.......
================================================================================
#calls: 30
elapsed: 78.0955438614
fb norms: [1.0312597, 1.0378917, 1.1197844, 1.1946501]
W norm: 1.04191
grad norms: [0.0013789211, 0.0055770208, 0.014134239, 0.022697208, 0.0047014006]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.803991996189
tst_shape: (30, 30)
tst_pe: 0.61679816136
================================================================================
...
At iterate   30    f=  3.71629D-03    |proj g|=  1.36884D-03
.......
================================================================================
#calls: 40
elapsed: 103.351725817
fb norms: [1.1057463, 1.1202774, 1.290062, 1.427153]
W norm: 1.12098
grad norms: [0.00080831983, 0.0037597881, 0.015219964, 0.017146772, 0.0028480494]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.855901172747
tst_shape: (30, 30)
tst_pe: 0.613448582304
================================================================================
...
At iterate   40    f=  1.54313D-03    |proj g|=  2.30915D-03
.......
================================================================================
#calls: 50
elapsed: 128.615149975
fb norms: [1.2120672, 1.2392263, 1.5565324, 1.7930588]
W norm: 1.23471
grad norms: [0.00047395687, 0.0040189736, 0.0085091433, 0.010968298, 0.0021220446]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.921432980447
tst_shape: (30, 30)
tst_pe: 0.625523961221
================================================================================
...
At iterate   50    f=  2.43002D-04    |proj g|=  6.49295D-04
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   57      1     0     0   0.000D+00   9.410D-05
  F =  9.40978497965261340E-005

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.326E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.64201928928


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777055150884 392 206
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57029509544
fb norms: [0.9999997, 1.0000005, 0.99999982, 0.99999988]
W norm: 1.0
grad norms: [0.0055897865, 0.089515626, 0.40984586, 0.86755049, 0.18793312]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.594724668899
tst_shape: (30, 30)
tst_pe: 0.573167277007
================================================================================

At iterate    0    f=  1.84139D-02    |proj g|=  1.27659D-01
..........
================================================================================
#calls: 10
elapsed: 27.7100391388
fb norms: [0.99952751, 0.99953657, 0.99965072, 0.99992841]
W norm: 0.998871
grad norms: [0.0020475634, 0.0086219972, 0.021711593, 0.0403037, 0.0071697719]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.642242544636
tst_shape: (30, 30)
tst_pe: 0.605428978981
================================================================================
..
At iterate   10    f=  9.22289D-03    |proj g|=  1.13182D-02
........
================================================================================
#calls: 20
elapsed: 52.8586299419
fb norms: [0.98399442, 0.98623532, 0.99945098, 1.017808]
W norm: 0.981642
grad norms: [0.00059918402, 0.0029267543, 0.010235451, 0.014312308, 0.0024872813]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.72632578887
tst_shape: (30, 30)
tst_pe: 0.631359352444
================================================================================
..
At iterate   20    f=  6.67749D-03    |proj g|=  1.28751D-03
........
================================================================================
#calls: 30
elapsed: 78.0808479786
fb norms: [1.0186718, 1.0261728, 1.0949517, 1.1755812]
W norm: 1.01783
grad norms: [0.00084564701, 0.004630174, 0.013966143, 0.022060534, 0.0044650235]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.782920844335
tst_shape: (30, 30)
tst_pe: 0.62390276997
================================================================================
..
At iterate   30    f=  4.28527D-03    |proj g|=  2.15597D-03
........
================================================================================
#calls: 40
elapsed: 103.318588018
fb norms: [1.1052053, 1.1216724, 1.3016121, 1.4963847]
W norm: 1.1067
grad norms: [0.00088563812, 0.002902749, 0.0095889913, 0.013254351, 0.0022689921]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.845589373703
tst_shape: (30, 30)
tst_pe: 0.607251454111
================================================================================
..
At iterate   40    f=  1.96796D-03    |proj g|=  5.41800D-03
........
================================================================================
#calls: 50
elapsed: 128.581393957
fb norms: [1.2231891, 1.251886, 1.582209, 1.9102937]
W norm: 1.22973
grad norms: [0.00053037645, 0.0029803091, 0.010707354, 0.017162675, 0.0044164346]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.910900212142
tst_shape: (30, 30)
tst_pe: 0.60650692112
================================================================================
..
At iterate   50    f=  3.28729D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   50   53      1     0     0   0.000D+00   3.287D-04
  F =  3.28729016473516822E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.857E-01 seconds.
 Line search           time 1.301E+02 seconds.

 Total User time 1.341E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.643732741172


********************************************************************************
>>> Finding a balanced patch...
bal: 0.779396462019 553 460
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60372614861
fb norms: [0.99999982, 1.0000001, 1.0000011, 1.0000008]
W norm: 1.0
grad norms: [0.0027685952, 0.048431959, 0.19300786, 0.44844347, 0.11142604]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.576516044443
tst_shape: (30, 30)
tst_pe: 0.563917057323
================================================================================

At iterate    0    f=  1.29685D-02    |proj g|=  7.35245D-02
..........
================================================================================
#calls: 10
elapsed: 27.747936964
fb norms: [0.99288607, 0.99307317, 0.99564922, 1.0008801]
W norm: 0.994578
grad norms: [0.00066659035, 0.0043227565, 0.014156658, 0.024615129, 0.0046473071]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.686113235454
tst_shape: (30, 30)
tst_pe: 0.629987352442
================================================================================
...
At iterate   10    f=  7.44957D-03    |proj g|=  4.32506D-03
.......
================================================================================
#calls: 20
elapsed: 52.8934500217
fb norms: [0.98528099, 0.98800623, 1.0230715, 1.0759354]
W norm: 0.988301
grad norms: [0.00096881657, 0.0049835229, 0.012293278, 0.019022793, 0.0051298649]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.754918177112
tst_shape: (30, 30)
tst_pe: 0.626098311326
================================================================================
...
At iterate   20    f=  5.50565D-03    |proj g|=  1.19507D-03
.......
================================================================================
#calls: 30
elapsed: 78.0628869534
fb norms: [1.0399805, 1.0490073, 1.1524746, 1.2805964]
W norm: 1.04328
grad norms: [0.0012158738, 0.0040896977, 0.011532261, 0.014915996, 0.0025901368]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.800679822469
tst_shape: (30, 30)
tst_pe: 0.601471203166
================================================================================
...
At iterate   30    f=  3.40229D-03    |proj g|=  2.60684D-03
.......
================================================================================
#calls: 40
elapsed: 103.337512016
fb norms: [1.1304632, 1.1504887, 1.3772799, 1.6225953]
W norm: 1.13694
grad norms: [0.00089059141, 0.0033363481, 0.011529857, 0.011720873, 0.001667933]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.858872102413
tst_shape: (30, 30)
tst_pe: 0.60734922431
================================================================================
...
At iterate   40    f=  1.44250D-03    |proj g|=  2.19848D-03
.......
================================================================================
#calls: 50
elapsed: 128.616364002
fb norms: [1.2234287, 1.2546254, 1.6112504, 1.963832]
W norm: 1.23531
grad norms: [0.00070442725, 0.002513882, 0.0078933118, 0.011382749, 0.0025238742]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.918686173204
tst_shape: (30, 30)
tst_pe: 0.60308772059
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   3.511D-04
  F =  3.51125723682343960E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.525E-01 seconds.
 Line search           time 1.277E+02 seconds.

 Total User time 1.318E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.644795465928


********************************************************************************
>>> Finding a balanced patch...
bal: 0.772632674298 240 563
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.63197612762
fb norms: [0.99999976, 1.0000018, 0.99999911, 0.99999934]
W norm: 1.0
grad norms: [0.0039933934, 0.045487199, 0.24737768, 0.48497054, 0.12916589]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.593729522555
tst_shape: (30, 30)
tst_pe: 0.5419494151
================================================================================

At iterate    0    f=  1.31477D-02    |proj g|=  8.01156D-02
..........
================================================================================
#calls: 10
elapsed: 27.7698931694
fb norms: [0.99804795, 0.99817288, 0.99964255, 1.0016377]
W norm: 0.999239
grad norms: [0.0011268788, 0.0038271283, 0.013471886, 0.020493262, 0.0032732103]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.694092487291
tst_shape: (30, 30)
tst_pe: 0.629056262296
================================================================================
...
At iterate   10    f=  7.28741D-03    |proj g|=  1.11552D-02
.......
================================================================================
#calls: 20
elapsed: 52.9319372177
fb norms: [0.99007708, 0.99225396, 1.0170404, 1.0452782]
W norm: 0.991743
grad norms: [0.0010795825, 0.0040424322, 0.013396322, 0.01356473, 0.0026368885]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.75847251596
tst_shape: (30, 30)
tst_pe: 0.622284588911
================================================================================
...
At iterate   20    f=  5.49669D-03    |proj g|=  2.26790D-03
.......
================================================================================
#calls: 30
elapsed: 78.1600191593
fb norms: [1.0334939, 1.0410821, 1.1349287, 1.22967]
W norm: 1.03288
grad norms: [0.0015363307, 0.0062631755, 0.023623437, 0.03387225, 0.0077249086]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.809953512014
tst_shape: (30, 30)
tst_pe: 0.612311408981
================================================================================
...
At iterate   30    f=  3.20741D-03    |proj g|=  1.45222D-03
.......
================================================================================
#calls: 40
elapsed: 103.401536226
fb norms: [1.1065232, 1.1214321, 1.3012078, 1.4730418]
W norm: 1.10562
grad norms: [0.0010638469, 0.0037764919, 0.011533078, 0.014369758, 0.0025113875]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.860168189539
tst_shape: (30, 30)
tst_pe: 0.598255092717
================================================================================
...
At iterate   40    f=  1.42213D-03    |proj g|=  2.91922D-03
.......
================================================================================
#calls: 50
elapsed: 128.656515121
fb norms: [1.2251781, 1.2529662, 1.5830243, 1.8803893]
W norm: 1.226
grad norms: [0.00062754872, 0.0035661724, 0.015371613, 0.014969891, 0.0036295573]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.929695624625
tst_shape: (30, 30)
tst_pe: 0.607208529108
================================================================================
...
At iterate   50    f=  2.73114D-04    |proj g|=  1.60239D-03
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   2.167D-04
  F =  2.16676911804825068E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 4.004E-01 seconds.
 Line search           time 1.349E+02 seconds.

 Total User time 1.390E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.641823447158


********************************************************************************
>>> Finding a balanced patch...
bal: 0.778876170656 484 406
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58359694481
fb norms: [1.0000002, 1.0000006, 1.0000008, 0.99999899]
W norm: 1.0
grad norms: [0.0023016704, 0.0085515035, 0.056024719, 0.071774058, 0.010540791]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.568295945617
tst_shape: (30, 30)
tst_pe: 0.556352829966
================================================================================

At iterate    0    f=  1.09893D-02    |proj g|=  6.62156D-03
..........
================================================================================
#calls: 10
elapsed: 27.6838719845
fb norms: [0.99131197, 0.99169797, 0.99622053, 0.99901855]
W norm: 0.993502
grad norms: [0.000669464, 0.0038004389, 0.017039007, 0.031308711, 0.006116576]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.66866428595
tst_shape: (30, 30)
tst_pe: 0.598152175708
================================================================================
...
At iterate   10    f=  7.60524D-03    |proj g|=  1.96432D-03
.......
================================================================================
#calls: 20
elapsed: 52.861000061
fb norms: [0.9759962, 0.97933328, 1.0137045, 1.0410485]
W norm: 0.980882
grad norms: [0.0013501558, 0.0036171027, 0.0086034341, 0.012599574, 0.0023009856]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.744685153187
tst_shape: (30, 30)
tst_pe: 0.615913579032
================================================================================
...
At iterate   20    f=  5.50460D-03    |proj g|=  2.85309D-03
.......
================================================================================
#calls: 30
elapsed: 78.1561489105
fb norms: [1.0022799, 1.0095791, 1.0896021, 1.1589395]
W norm: 1.00775
grad norms: [0.00099720433, 0.0047669229, 0.014016778, 0.019648882, 0.0044420897]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.791592540862
tst_shape: (30, 30)
tst_pe: 0.595426197637
================================================================================
...
At iterate   30    f=  4.04660D-03    |proj g|=  2.11643D-03
.......
================================================================================
#calls: 40
elapsed: 103.379168987
fb norms: [1.0523064, 1.0651557, 1.2145113, 1.3427624]
W norm: 1.05853
grad norms: [0.0011512837, 0.0055285771, 0.011256715, 0.011953994, 0.0019457879]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.828065048045
tst_shape: (30, 30)
tst_pe: 0.5754616853
================================================================================
...
At iterate   40    f=  2.07227D-03    |proj g|=  9.01745D-04
.......
================================================================================
#calls: 50
elapsed: 128.669080019
fb norms: [1.1891838, 1.2208532, 1.6069127, 1.9082819]
W norm: 1.20224
grad norms: [0.00078167627, 0.0061709322, 0.017930605, 0.021531437, 0.0061778561]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.912900309017
tst_shape: (30, 30)
tst_pe: 0.551249847811
================================================================================
...
At iterate   50    f=  4.36538D-04    |proj g|=  9.25586D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   2.896D-04
  F =  2.89610703475773335E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.965E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.391E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.64300746877


********************************************************************************
>>> Finding a balanced patch...
bal: 0.789281997919 748 540
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.6112651825
fb norms: [0.9999997, 1.0000011, 1.0000001, 1.0000001]
W norm: 1.0
grad norms: [0.0050108884, 0.088326685, 0.36789078, 0.56114274, 0.15024084]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.583986691168
tst_shape: (30, 30)
tst_pe: 0.521625767293
================================================================================

At iterate    0    f=  1.51236D-02    |proj g|=  1.01626D-01
..........
================================================================================
#calls: 10
elapsed: 27.71875
fb norms: [0.99773628, 0.99782765, 0.99835426, 1.0000902]
W norm: 0.997988
grad norms: [0.0010263174, 0.0050301952, 0.014750097, 0.023173435, 0.0025721665]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.666961853798
tst_shape: (30, 30)
tst_pe: 0.582646972332
================================================================================
..
At iterate   10    f=  7.80248D-03    |proj g|=  3.18897D-03
........
================================================================================
#calls: 20
elapsed: 52.8588190079
fb norms: [0.99061501, 0.99408841, 1.028253, 1.0714128]
W norm: 0.995632
grad norms: [0.0013503676, 0.0054495726, 0.014497765, 0.019308802, 0.0051022717]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.762558943363
tst_shape: (30, 30)
tst_pe: 0.607943797883
================================================================================
..
At iterate   20    f=  5.29229D-03    |proj g|=  7.85017D-03
........
================================================================================
#calls: 30
elapsed: 78.0508301258
fb norms: [1.0371227, 1.0467049, 1.147715, 1.2598118]
W norm: 1.04338
grad norms: [0.0010346101, 0.0063916808, 0.013540844, 0.018081155, 0.0029976645]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.814590901761
tst_shape: (30, 30)
tst_pe: 0.550455954151
================================================================================
..
At iterate   30    f=  3.33695D-03    |proj g|=  1.15405D-03
........
================================================================================
#calls: 40
elapsed: 103.286511183
fb norms: [1.1114511, 1.1292562, 1.3288509, 1.5334301]
W norm: 1.12073
grad norms: [0.0012046262, 0.0040005106, 0.011724683, 0.017775975, 0.0041166064]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.865429820508
tst_shape: (30, 30)
tst_pe: 0.528742769128
================================================================================
..
At iterate   40    f=  1.12395D-03    |proj g|=  1.26783D-03
........
================================================================================
#calls: 50
elapsed: 128.59356308
fb norms: [1.238322, 1.2709137, 1.6415445, 1.988959]
W norm: 1.25377
grad norms: [0.0005474012, 0.0016800987, 0.0052532675, 0.0063193371, 0.0011223714]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.936772176169
tst_shape: (30, 30)
tst_pe: 0.536951144089
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   49   52      1     0     0   0.000D+00   1.485D-04
  F =  1.48540013469755650E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 3.662E-01 seconds.
 Line search           time 1.277E+02 seconds.

 Total User time 1.317E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.645890036949


********************************************************************************
>>> Finding a balanced patch...
bal: 0.774193548387 524 1109
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61666798592
fb norms: [0.99999928, 1.0, 0.9999994, 0.99999946]
W norm: 1.0
grad norms: [0.0043310318, 0.067023948, 0.39598429, 0.74832362, 0.19329543]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.578676313379
tst_shape: (30, 30)
tst_pe: 0.498952202612
================================================================================

At iterate    0    f=  1.77211D-02    |proj g|=  1.20850D-01
..........
================================================================================
#calls: 10
elapsed: 27.7426409721
fb norms: [0.99724817, 0.997311, 0.99804419, 0.9996407]
W norm: 0.997261
grad norms: [0.0013750803, 0.0059931488, 0.016889904, 0.029067894, 0.0060224789]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.649282015238
tst_shape: (30, 30)
tst_pe: 0.583449776122
================================================================================
..
At iterate   10    f=  8.57368D-03    |proj g|=  3.10363D-03
........
================================================================================
#calls: 20
elapsed: 52.9323561192
fb norms: [0.98906523, 0.99148232, 1.0133336, 1.0434512]
W norm: 0.990075
grad norms: [0.0014062542, 0.005070888, 0.011874777, 0.015171276, 0.0026017074]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.732327436705
tst_shape: (30, 30)
tst_pe: 0.5967248656
================================================================================
..
At iterate   20    f=  6.03758D-03    |proj g|=  1.72445D-03
........
================================================================================
#calls: 30
elapsed: 78.1596000195
fb norms: [1.0279975, 1.0364106, 1.1231967, 1.2247913]
W norm: 1.03117
grad norms: [0.001131063, 0.0057972814, 0.014394816, 0.024335127, 0.0054153986]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.784961600217
tst_shape: (30, 30)
tst_pe: 0.591231266252
================================================================================
..
At iterate   30    f=  3.95569D-03    |proj g|=  4.77914D-03
........
================================================================================
#calls: 40
elapsed: 103.412425995
fb norms: [1.1151413, 1.133148, 1.3228748, 1.5129025]
W norm: 1.12254
grad norms: [0.00093713513, 0.0047083022, 0.012518493, 0.015038809, 0.0019597996]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.848875173138
tst_shape: (30, 30)
tst_pe: 0.600274092285
================================================================================
..
At iterate   40    f=  2.02451D-03    |proj g|=  1.89931D-03
........
================================================================================
#calls: 50
elapsed: 128.746758938
fb norms: [1.206524, 1.2359483, 1.5573746, 1.8487096]
W norm: 1.21992
grad norms: [0.00060340395, 0.003293799, 0.013321464, 0.020265082, 0.0043706908]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.906717221584
tst_shape: (30, 30)
tst_pe: 0.59660442272
================================================================================
..
At iterate   50    f=  6.70825D-04    |proj g|=  1.38905D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   56      1     0     0   0.000D+00   2.570D-04
  F =  2.56982457358390093E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.355E-01 seconds.
 Line search           time 1.374E+02 seconds.

 Total User time 1.415E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.653153466234


********************************************************************************
>>> Finding a balanced patch...
bal: 0.776014568158 577 681
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62382507324
fb norms: [1.0000006, 1.0000001, 0.99999988, 0.9999997]
W norm: 1.0
grad norms: [0.0063954992, 0.053641085, 0.38575697, 0.86404204, 0.19994096]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.586349147166
tst_shape: (30, 30)
tst_pe: 0.547959058896
================================================================================

At iterate    0    f=  1.78420D-02    |proj g|=  1.23828D-01
..........
================================================================================
#calls: 10
elapsed: 27.7333219051
fb norms: [0.99937475, 0.99938262, 0.99961847, 1.0001664]
W norm: 0.998747
grad norms: [0.0016238632, 0.0057689776, 0.018805981, 0.036421448, 0.0072454647]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.634846190169
tst_shape: (30, 30)
tst_pe: 0.595521443396
================================================================================
..
At iterate   10    f=  9.27005D-03    |proj g|=  1.16123D-02
........
================================================================================
#calls: 20
elapsed: 52.9071440697
fb norms: [0.98802733, 0.9894461, 1.0074158, 1.0252608]
W norm: 0.98609
grad norms: [0.00053274154, 0.0068863719, 0.028575357, 0.060293011, 0.013576442]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.708713771137
tst_shape: (30, 30)
tst_pe: 0.608287004207
================================================================================
..
At iterate   20    f=  6.94976D-03    |proj g|=  1.33557D-03
........
================================================================================
#calls: 30
elapsed: 78.1621630192
fb norms: [1.0003744, 1.0051991, 1.0691578, 1.1322143]
W norm: 0.996419
grad norms: [0.00099288393, 0.0029920305, 0.011201872, 0.01534225, 0.0028550273]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.76252671546
tst_shape: (30, 30)
tst_pe: 0.606955927358
================================================================================
..
At iterate   30    f=  5.04168D-03    |proj g|=  2.11525D-03
........
================================================================================
#calls: 40
elapsed: 103.405934095
fb norms: [1.0639933, 1.0759926, 1.2499504, 1.4114896]
W norm: 1.06181
grad norms: [0.0014315119, 0.004575788, 0.026786799, 0.040547695, 0.0092052156]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.823573049177
tst_shape: (30, 30)
tst_pe: 0.60178528145
================================================================================
..
At iterate   40    f=  2.87775D-03    |proj g|=  2.36914D-03
........
================================================================================
#calls: 50
elapsed: 128.679843903
fb norms: [1.1564468, 1.1758515, 1.4654075, 1.7109253]
W norm: 1.15927
grad norms: [0.00079411798, 0.003079745, 0.011306248, 0.016117953, 0.003183278]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.888782606284
tst_shape: (30, 30)
tst_pe: 0.58184673779
================================================================================
..
At iterate   50    f=  8.83358D-04    |proj g|=  9.49890D-04
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   56      1     0     0   0.000D+00   3.179D-04
  F =  3.17945668939501047E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.355E-01 seconds.
 Line search           time 1.373E+02 seconds.

 Total User time 1.415E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.655829870151


********************************************************************************
>>> Finding a balanced patch...
bal: 0.787721123829 1012 645
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62473106384
fb norms: [1.0000001, 1.0000005, 0.99999899, 0.99999893]
W norm: 1.0
grad norms: [0.0022140294, 0.043885868, 0.27582124, 0.64277309, 0.14587054]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.571416582788
tst_shape: (30, 30)
tst_pe: 0.524792594892
================================================================================

At iterate    0    f=  1.49530D-02    |proj g|=  9.93698D-02
..........
================================================================================
#calls: 10
elapsed: 27.8026659489
fb norms: [0.99895519, 0.99899513, 0.99937797, 1.0000938]
W norm: 0.99877
grad norms: [0.001667854, 0.0057719541, 0.014970358, 0.025338858, 0.0045141145]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.635441301126
tst_shape: (30, 30)
tst_pe: 0.58514527312
================================================================================
..
At iterate   10    f=  8.84512D-03    |proj g|=  1.41613D-02
........
================================================================================
#calls: 20
elapsed: 52.9837899208
fb norms: [0.98354381, 0.98747611, 1.0092351, 1.0365115]
W norm: 0.98513
grad norms: [0.0012597806, 0.0047000651, 0.0095932204, 0.018789439, 0.0035377494]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.725196243096
tst_shape: (30, 30)
tst_pe: 0.624137118263
================================================================================
..
At iterate   20    f=  6.19609D-03    |proj g|=  2.05299D-03
........
================================================================================
#calls: 30
elapsed: 78.2127869129
fb norms: [1.0153737, 1.0258403, 1.0877343, 1.1571734]
W norm: 1.01475
grad norms: [0.001408422, 0.004453416, 0.0095757376, 0.012185053, 0.0019703063]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.772069798526
tst_shape: (30, 30)
tst_pe: 0.618865756799
================================================================================
..
At iterate   30    f=  4.42964D-03    |proj g|=  9.25369D-03
........
================================================================================
#calls: 40
elapsed: 103.487165928
fb norms: [1.092769, 1.1149405, 1.2661176, 1.4150809]
W norm: 1.09296
grad norms: [0.001071848, 0.0035797178, 0.015312491, 0.025118321, 0.0053265481]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.827884577064
tst_shape: (30, 30)
tst_pe: 0.599738362724
================================================================================
..
At iterate   40    f=  2.35073D-03    |proj g|=  1.56318D-03
........
================================================================================
#calls: 50
elapsed: 128.771095037
fb norms: [1.1955765, 1.2322112, 1.5194403, 1.77475]
W norm: 1.19977
grad norms: [0.00080459152, 0.0027680744, 0.0088138096, 0.012165713, 0.0021379485]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.895431431276
tst_shape: (30, 30)
tst_pe: 0.583800587793
================================================================================
..
At iterate   50    f=  7.12990D-04    |proj g|=  1.01928D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   2.427D-04
  F =  2.42727604927495122E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.521E-01 seconds.
 Line search           time 1.398E+02 seconds.

 Total User time 1.440E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.660934852841


********************************************************************************
>>> Finding a balanced patch...
bal: 0.773413111342 27 619
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56702399254
fb norms: [0.99999994, 1.0000015, 1.000001, 0.99999994]
W norm: 1.0
grad norms: [0.00092485663, 0.030704243, 0.18087049, 0.3909269, 0.0750999]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.572860090839
tst_shape: (30, 30)
tst_pe: 0.51766593069
================================================================================

At iterate    0    f=  1.20285D-02    |proj g|=  5.49669D-02
..........
================================================================================
#calls: 10
elapsed: 27.7270269394
fb norms: [0.99828535, 0.99857444, 1.0020096, 1.0073347]
W norm: 1.00175
grad norms: [0.00091651478, 0.003332803, 0.0113289, 0.018518277, 0.0021923466]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.690735148715
tst_shape: (30, 30)
tst_pe: 0.599114138737
================================================================================
...
At iterate   10    f=  7.42932D-03    |proj g|=  3.13027D-03
.......
================================================================================
#calls: 20
elapsed: 52.8536450863
fb norms: [1.0013025, 1.0038562, 1.0350361, 1.0694014]
W norm: 1.00795
grad norms: [0.00096691656, 0.004689645, 0.012342899, 0.016529191, 0.0026627746]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.758633729401
tst_shape: (30, 30)
tst_pe: 0.603759106126
================================================================================
...
At iterate   20    f=  5.07385D-03    |proj g|=  2.53294D-03
.......
================================================================================
#calls: 30
elapsed: 78.0567009449
fb norms: [1.0626729, 1.0719661, 1.1944363, 1.3100171]
W norm: 1.06868
grad norms: [0.00085257081, 0.0042497446, 0.014519227, 0.020639472, 0.003888834]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.81989100366
tst_shape: (30, 30)
tst_pe: 0.577656962349
================================================================================
...
At iterate   30    f=  2.88456D-03    |proj g|=  1.25624D-03
.......
================================================================================
#calls: 40
elapsed: 103.303169012
fb norms: [1.175535, 1.1955419, 1.4672509, 1.6918114]
W norm: 1.18218
grad norms: [0.00077740557, 0.003691402, 0.014001887, 0.021086419, 0.0041481294]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.88792915441
tst_shape: (30, 30)
tst_pe: 0.566002928655
================================================================================
...
At iterate   40    f=  8.43235D-04    |proj g|=  1.18173D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   43   47      1     0     0   0.000D+00   3.186D-04
  F =  3.18638747557997704E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 2.813E-01 seconds.
 Line search           time 1.146E+02 seconds.

 Total User time 1.185E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.656646134658


********************************************************************************
>>> Finding a balanced patch...
bal: 0.793184183143 189 632
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61210298538
fb norms: [0.99999952, 1.0000011, 1.0000005, 1.0000005]
W norm: 1.0
grad norms: [0.00073599257, 0.036772024, 0.1893882, 0.36637044, 0.081089437]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.568968563191
tst_shape: (30, 30)
tst_pe: 0.535058736003
================================================================================

At iterate    0    f=  1.17642D-02    |proj g|=  5.78266D-02
..........
================================================================================
#calls: 10
elapsed: 27.7591018677
fb norms: [0.99580657, 0.99624699, 1.0004152, 1.00596]
W norm: 1.00023
grad norms: [0.0010429859, 0.0058927219, 0.021232834, 0.039194461, 0.0077421493]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.68980914333
tst_shape: (30, 30)
tst_pe: 0.601714193569
================================================================================
...
At iterate   10    f=  6.87223D-03    |proj g|=  3.19895D-03
.......
================================================================================
#calls: 20
elapsed: 52.8855679035
fb norms: [1.000158, 1.0040637, 1.0523802, 1.1052814]
W norm: 1.00883
grad norms: [0.0013403214, 0.0034056837, 0.010694952, 0.013899849, 0.0017463195]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.76260112502
tst_shape: (30, 30)
tst_pe: 0.607845609066
================================================================================
...
At iterate   20    f=  4.65045D-03    |proj g|=  1.19531D-03
.......
================================================================================
#calls: 30
elapsed: 78.0908448696
fb norms: [1.0499192, 1.0583221, 1.174914, 1.288429]
W norm: 1.05873
grad norms: [0.0011677416, 0.0030531664, 0.012290386, 0.01695247, 0.0029830961]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.811204192803
tst_shape: (30, 30)
tst_pe: 0.587591565156
================================================================================
...
At iterate   30    f=  2.77468D-03    |proj g|=  9.15541D-04
.......
================================================================================
#calls: 40
elapsed: 103.3328619
fb norms: [1.129456, 1.1443204, 1.3543754, 1.5387434]
W norm: 1.1391
grad norms: [0.00095260044, 0.0024052621, 0.0096338717, 0.015656106, 0.0030847976]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.866700806045
tst_shape: (30, 30)
tst_pe: 0.569880176677
================================================================================
...
At iterate   40    f=  9.28951D-04    |proj g|=  3.82399D-03
.......
================================================================================
#calls: 50
elapsed: 128.582167864
fb norms: [1.2539489, 1.2804083, 1.652748, 1.9517534]
W norm: 1.26819
grad norms: [0.0003682134, 0.0019683817, 0.0060032313, 0.0073077502, 0.0011159438]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.937716740821
tst_shape: (30, 30)
tst_pe: 0.559037273261
================================================================================
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   49   53      1     0     0   0.000D+00   8.259D-05
  F =  8.25869137770496309E-005

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.750E-01 seconds.
 Line search           time 1.301E+02 seconds.

 Total User time 1.341E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.658010800471


********************************************************************************
>>> Finding a balanced patch...
bal: 0.781477627471 972 744
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.5656619072
fb norms: [0.99999982, 1.0000026, 0.99999976, 0.99999982]
W norm: 1.0
grad norms: [0.0021512306, 0.071831934, 0.38252351, 0.70585829, 0.15582681]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.548618139659
tst_shape: (30, 30)
tst_pe: 0.527704433662
================================================================================

At iterate    0    f=  1.59196D-02    |proj g|=  1.03677D-01
..........
================================================================================
#calls: 10
elapsed: 27.7265398502
fb norms: [0.99858618, 0.99861258, 0.99902153, 0.9995957]
W norm: 0.998593
grad norms: [0.0023273372, 0.007273972, 0.019731864, 0.033270132, 0.0068207546]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.633090946832
tst_shape: (30, 30)
tst_pe: 0.597170730129
================================================================================
..
At iterate   10    f=  9.23858D-03    |proj g|=  1.43454D-02
........
================================================================================
#calls: 20
elapsed: 52.8849978447
fb norms: [0.97807682, 0.98013991, 0.99845159, 1.0157102]
W norm: 0.980135
grad norms: [0.0013878716, 0.0044780383, 0.0093035745, 0.019059455, 0.0049554971]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.700023499558
tst_shape: (30, 30)
tst_pe: 0.600371675839
================================================================================
..
At iterate   20    f=  6.78498D-03    |proj g|=  3.87141D-03
........
================================================================================
#calls: 30
elapsed: 78.1164059639
fb norms: [0.99929667, 1.0061504, 1.0719703, 1.1397244]
W norm: 0.999758
grad norms: [0.0014401728, 0.0039373417, 0.0087631736, 0.013644234, 0.0021890691]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.766392896879
tst_shape: (30, 30)
tst_pe: 0.612688132067
================================================================================
..
At iterate   30    f=  4.84497D-03    |proj g|=  1.42677D-03
........
================================================================================
#calls: 40
elapsed: 103.344815969
fb norms: [1.0949662, 1.1125281, 1.2973891, 1.4767947]
W norm: 1.09738
grad norms: [0.00090377009, 0.0041706762, 0.012416403, 0.01640212, 0.0028410291]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.833408675157
tst_shape: (30, 30)
tst_pe: 0.582147146862
================================================================================
..
At iterate   40    f=  2.08732D-03    |proj g|=  1.89966D-03
........
================================================================================
#calls: 50
elapsed: 128.598912001
fb norms: [1.2076797, 1.2383945, 1.5808289, 1.8870842]
W norm: 1.21891
grad norms: [0.00087863137, 0.0050408891, 0.010939004, 0.017463341, 0.0035336984]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.902468646806
tst_shape: (30, 30)
tst_pe: 0.550261989266
================================================================================
..
At iterate   50    f=  5.55740D-04    |proj g|=  1.09982D-03
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   54      1     0     0   0.000D+00   3.798D-04
  F =  3.79775126930326223E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.994E-01 seconds.
 Line search           time 1.326E+02 seconds.

 Total User time 1.366E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.654825256064


********************************************************************************
>>> Finding a balanced patch...
bal: 0.779396462019 358 709
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57035398483
fb norms: [0.99999952, 1.0000012, 1.0000004, 0.9999997]
W norm: 1.0
grad norms: [0.0051413388, 0.067180283, 0.27710438, 0.65070814, 0.16090609]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.569216550164
tst_shape: (30, 30)
tst_pe: 0.520594500929
================================================================================

At iterate    0    f=  1.67659D-02    |proj g|=  1.15204D-01
..........
================================================================================
#calls: 10
elapsed: 27.7064139843
fb norms: [0.99879211, 0.99884826, 0.99946409, 1.0009204]
W norm: 0.997887
grad norms: [0.0021121204, 0.0066042873, 0.0205433, 0.03673647, 0.0072716773]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.650098848458
tst_shape: (30, 30)
tst_pe: 0.585683127402
================================================================================
..
At iterate   10    f=  8.69393D-03    |proj g|=  3.16081D-03
........
================================================================================
#calls: 20
elapsed: 52.844132185
fb norms: [0.98304546, 0.98531336, 1.0094577, 1.0370997]
W norm: 0.978701
grad norms: [0.0010171728, 0.004798729, 0.011163897, 0.01269052, 0.0017115127]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.725526541058
tst_shape: (30, 30)
tst_pe: 0.598847207574
================================================================================
..
At iterate   20    f=  6.50876D-03    |proj g|=  4.85143D-03
........
================================================================================
#calls: 30
elapsed: 78.0460240841
fb norms: [1.0013479, 1.006743, 1.0708758, 1.1344186]
W norm: 0.99487
grad norms: [0.000859786, 0.0022843592, 0.0092064608, 0.012880057, 0.0028712205]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.77792453378
tst_shape: (30, 30)
tst_pe: 0.597114039638
================================================================================
..
At iterate   30    f=  4.53829D-03    |proj g|=  1.40361D-03
........
================================================================================
#calls: 40
elapsed: 103.31548214
fb norms: [1.0728706, 1.0866927, 1.261444, 1.409318]
W norm: 1.06716
grad norms: [0.00078904413, 0.012465826, 0.044832047, 0.050058216, 0.014228541]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.829895069673
tst_shape: (30, 30)
tst_pe: 0.581734058979
================================================================================
..
At iterate   40    f=  2.77432D-03    |proj g|=  1.60094D-03
........
================================================================================
#calls: 50
elapsed: 128.625748158
fb norms: [1.1770709, 1.2024029, 1.5230801, 1.7637306]
W norm: 1.1755
grad norms: [0.00066323986, 0.0045548081, 0.011658609, 0.014152819, 0.0034673437]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.894202410148
tst_shape: (30, 30)
tst_pe: 0.596059524569
================================================================================
..
At iterate   50    f=  8.64729D-04    |proj g|=  8.50528D-04
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   2.060D-04
  F =  2.06011900445446372E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 4.775E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.462E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.654224840946


********************************************************************************
>>> Finding a balanced patch...
bal: 0.773673257024 317 683
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57059597969
fb norms: [0.99999964, 1.0000014, 0.9999994, 1.0000005]
W norm: 1.0
grad norms: [0.00051099563, 0.040507037, 0.18292336, 0.28372204, 0.069576457]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.573972663083
tst_shape: (30, 30)
tst_pe: 0.557679078236
================================================================================

At iterate    0    f=  1.17728D-02    |proj g|=  4.61972D-02
..........
================================================================================
#calls: 10
elapsed: 27.6823890209
fb norms: [0.99903429, 0.99908596, 0.99982619, 1.0010023]
W norm: 0.999765
grad norms: [0.0008033113, 0.012649199, 0.054754242, 0.072174966, 0.01698219]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.653759097187
tst_shape: (30, 30)
tst_pe: 0.614409290902
================================================================================
..
At iterate   10    f=  8.30154D-03    |proj g|=  3.44784D-03
........
================================================================================
#calls: 20
elapsed: 52.8556981087
fb norms: [0.98889315, 0.99145341, 1.016417, 1.0329581]
W norm: 0.994008
grad norms: [0.00099112059, 0.0051928158, 0.012005098, 0.013803389, 0.0024880578]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.738857160899
tst_shape: (30, 30)
tst_pe: 0.624502963524
================================================================================
..
At iterate   20    f=  6.40199D-03    |proj g|=  1.22575D-03
........
================================================================================
#calls: 30
elapsed: 78.1239740849
fb norms: [1.0143195, 1.0227882, 1.1055605, 1.1601167]
W norm: 1.02167
grad norms: [0.0014545183, 0.0072613731, 0.015892999, 0.023123395, 0.0048084855]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.783264524494
tst_shape: (30, 30)
tst_pe: 0.625518658994
================================================================================
..
At iterate   30    f=  4.26764D-03    |proj g|=  7.59416D-03
........
================================================================================
#calls: 40
elapsed: 103.380810022
fb norms: [1.089293, 1.1086125, 1.2963493, 1.4090307]
W norm: 1.09789
grad norms: [0.00080410682, 0.0040407837, 0.018946011, 0.025346473, 0.0060039433]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.843128217494
tst_shape: (30, 30)
tst_pe: 0.61506210238
================================================================================
..
At iterate   40    f=  2.34104D-03    |proj g|=  1.17134D-03
........
================================================================================
#calls: 50
elapsed: 128.666978121
fb norms: [1.1885121, 1.2215006, 1.5556239, 1.7436647]
W norm: 1.19882
grad norms: [0.0007924274, 0.0027259793, 0.0098066963, 0.015225919, 0.0036724154]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.902151417872
tst_shape: (30, 30)
tst_pe: 0.602777743898
================================================================================
..
At iterate   50    f=  4.96208D-04    |proj g|=  1.13062D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   55      1     0     0   0.000D+00   2.926D-04
  F =  2.92630313197150826E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.131E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.391E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.650902390968


********************************************************************************
>>> Finding a balanced patch...
bal: 0.776534859521 441 563
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62141895294
fb norms: [0.99999982, 1.0000019, 0.99999958, 0.99999964]
W norm: 1.0
grad norms: [0.0054367296, 0.061037242, 0.36104733, 0.50261873, 0.12060886]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.595488725418
tst_shape: (30, 30)
tst_pe: 0.550484606181
================================================================================

At iterate    0    f=  1.32023D-02    |proj g|=  8.15547D-02
..........
================================================================================
#calls: 10
elapsed: 27.7610399723
fb norms: [0.99980092, 0.99984306, 1.0003002, 1.0006601]
W norm: 0.99979
grad norms: [0.0018041859, 0.0095196767, 0.041853771, 0.051566314, 0.012837038]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.646723622265
tst_shape: (30, 30)
tst_pe: 0.594672671398
================================================================================
..
At iterate   10    f=  8.65871D-03    |proj g|=  1.32226D-02
........
================================================================================
#calls: 20
elapsed: 52.9691588879
fb norms: [0.98838693, 0.99055898, 1.0186752, 1.0352155]
W norm: 0.990163
grad norms: [0.00079119706, 0.0035707254, 0.011274215, 0.015530589, 0.0024271409]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.729222167741
tst_shape: (30, 30)
tst_pe: 0.609475813113
================================================================================
..
At iterate   20    f=  6.32434D-03    |proj g|=  1.24769D-03
........
================================================================================
#calls: 30
elapsed: 78.1741218567
fb norms: [1.0113441, 1.0174923, 1.1192521, 1.1846272]
W norm: 1.01258
grad norms: [0.00084362039, 0.0039404649, 0.011974601, 0.012864413, 0.0018336241]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.791784050011
tst_shape: (30, 30)
tst_pe: 0.608322974304
================================================================================
..
At iterate   30    f=  3.94820D-03    |proj g|=  1.15667D-03
........
================================================================================
#calls: 40
elapsed: 103.417123795
fb norms: [1.1045198, 1.1209046, 1.3821676, 1.5319413]
W norm: 1.10923
grad norms: [0.00053038017, 0.0076014437, 0.014036381, 0.016933702, 0.0029498225]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.859430805251
tst_shape: (30, 30)
tst_pe: 0.593193059276
================================================================================
..
At iterate   40    f=  1.70981D-03    |proj g|=  1.82354D-03
........
================================================================================
#calls: 50
elapsed: 128.684357882
fb norms: [1.2053195, 1.2360243, 1.6805623, 1.9136544]
W norm: 1.21596
grad norms: [0.00053255731, 0.0024500927, 0.0080218883, 0.0078993607, 0.0016912423]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.923976438637
tst_shape: (30, 30)
tst_pe: 0.588938929976
================================================================================
..
At iterate   50    f=  3.07625D-04    |proj g|=  1.03263D-03
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   54      1     0     0   0.000D+00   2.660D-04
  F =  2.66019807895645499E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.004E-01 seconds.
 Line search           time 1.325E+02 seconds.

 Total User time 1.366E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.645399458348


********************************************************************************
>>> Finding a balanced patch...
bal: 0.787721123829 509 385
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61855816841
fb norms: [1.0000001, 0.99999946, 0.99999917, 0.99999952]
W norm: 1.0
grad norms: [0.0091645001, 0.075308934, 0.40353474, 0.50774431, 0.13327548]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.568996862974
tst_shape: (30, 30)
tst_pe: 0.540037931147
================================================================================

At iterate    0    f=  1.43294D-02    |proj g|=  9.14559D-02
..........
================================================================================
#calls: 10
elapsed: 27.8282899857
fb norms: [0.99852306, 0.99862343, 0.99916321, 0.9998166]
W norm: 0.998367
grad norms: [0.0016500708, 0.011027232, 0.02673172, 0.0322133, 0.0053457958]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.628571096916
tst_shape: (30, 30)
tst_pe: 0.590419886031
================================================================================
..
At iterate   10    f=  8.81248D-03    |proj g|=  1.09549D-02
........
================================================================================
#calls: 20
elapsed: 52.9771220684
fb norms: [0.98501307, 0.98741496, 1.0074537, 1.0208943]
W norm: 0.985781
grad norms: [0.00089270982, 0.0037324361, 0.010576907, 0.016296681, 0.0023720579]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.710001721798
tst_shape: (30, 30)
tst_pe: 0.608491005573
================================================================================
..
At iterate   20    f=  6.56839D-03    |proj g|=  4.19621D-03
........
================================================================================
#calls: 30
elapsed: 78.1769759655
fb norms: [0.99707294, 1.00406, 1.0731012, 1.1187636]
W norm: 0.997271
grad norms: [0.0011028093, 0.003838392, 0.013338907, 0.017556062, 0.0038460775]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.769502989897
tst_shape: (30, 30)
tst_pe: 0.623624362674
================================================================================
..
At iterate   30    f=  4.54034D-03    |proj g|=  1.52605D-03
........
================================================================================
#calls: 40
elapsed: 103.382219076
fb norms: [1.0677706, 1.0838299, 1.2797242, 1.3953806]
W norm: 1.06864
grad norms: [0.0010720883, 0.004003284, 0.012991962, 0.012213928, 0.0015451523]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.83134930018
tst_shape: (30, 30)
tst_pe: 0.61521789457
================================================================================
..
At iterate   40    f=  2.31203D-03    |proj g|=  5.02646D-03
........
================================================================================
#calls: 50
elapsed: 128.660379171
fb norms: [1.1417857, 1.1658603, 1.4882851, 1.6641458]
W norm: 1.14477
grad norms: [0.00087422325, 0.0040151272, 0.011434169, 0.013343114, 0.0019727421]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.881220961223
tst_shape: (30, 30)
tst_pe: 0.598403112139
================================================================================
..
At iterate   50    f=  9.16758D-04    |proj g|=  9.60707D-04
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   3.224D-04
  F =  3.22355801472440362E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.521E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.439E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.647823371127


********************************************************************************
>>> Finding a balanced patch...
bal: 0.783558792924 612 624
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56533193588
fb norms: [1.0, 1.0, 0.99999875, 0.99999994]
W norm: 1.0
grad norms: [0.0030725675, 0.06947308, 0.33106819, 0.42604142, 0.095995352]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.59273484384
tst_shape: (30, 30)
tst_pe: 0.550660834739
================================================================================

At iterate    0    f=  1.27237D-02    |proj g|=  7.65150D-02
..........
================================================================================
#calls: 10
elapsed: 27.6980550289
fb norms: [0.99847388, 0.99869764, 1.0006024, 1.0020978]
W norm: 0.99993
grad norms: [0.00099427742, 0.0033217203, 0.013714378, 0.020211861, 0.0023573032]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.681285522698
tst_shape: (30, 30)
tst_pe: 0.602812480264
================================================================================
..
At iterate   10    f=  7.42411D-03    |proj g|=  8.83971D-03
........
================================================================================
#calls: 20
elapsed: 52.8715960979
fb norms: [0.99380511, 0.9965384, 1.0175648, 1.0348992]
W norm: 0.995965
grad norms: [0.00042804659, 0.0049072611, 0.0096070217, 0.011374877, 0.0010715063]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.747546574243
tst_shape: (30, 30)
tst_pe: 0.613580841657
================================================================================
..
At iterate   20    f=  5.99080D-03    |proj g|=  3.10562D-03
........
================================================================================
#calls: 30
elapsed: 78.1109080315
fb norms: [1.0288099, 1.0382962, 1.1598079, 1.2428675]
W norm: 1.03035
grad norms: [0.00065478665, 0.010662466, 0.035490502, 0.039050963, 0.0089916373]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.800002077703
tst_shape: (30, 30)
tst_pe: 0.600818267121
================================================================================
..
At iterate   30    f=  3.65599D-03    |proj g|=  2.06890D-03
........
================================================================================
#calls: 40
elapsed: 103.409847021
fb norms: [1.1142279, 1.133944, 1.4012446, 1.5520951]
W norm: 1.11739
grad norms: [0.0011592661, 0.0047310125, 0.014916642, 0.01559162, 0.0027531676]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.856802439017
tst_shape: (30, 30)
tst_pe: 0.59283123922
================================================================================
..
At iterate   40    f=  1.42577D-03    |proj g|=  2.35576D-03
........
================================================================================
#calls: 50
elapsed: 128.674103022
fb norms: [1.219811, 1.2550912, 1.7274261, 1.9614013]
W norm: 1.22788
grad norms: [0.00059530744, 0.0043095807, 0.011425378, 0.010222866, 0.0017397691]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.920844340832
tst_shape: (30, 30)
tst_pe: 0.60131342254
================================================================================
..
At iterate   50    f=  3.26686D-04    |proj g|=  7.57199D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   54      1     0     0   0.000D+00   1.923D-04
  F =  1.92342849913984537E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.975E-01 seconds.
 Line search           time 1.326E+02 seconds.

 Total User time 1.367E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.655218017534


********************************************************************************
>>> Finding a balanced patch...
bal: 0.778876170656 698 112
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58288192749
fb norms: [0.99999988, 1.0000001, 0.99999976, 0.99999994]
W norm: 1.0
grad norms: [0.00063212943, 0.05768967, 0.25085586, 0.33141792, 0.075477749]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.577297649736
tst_shape: (30, 30)
tst_pe: 0.54256917316
================================================================================

At iterate    0    f=  1.20059D-02    |proj g|=  5.68677D-02
..........
================================================================================
#calls: 10
elapsed: 27.7026798725
fb norms: [0.99812466, 0.99827325, 1.0009947, 1.0021528]
W norm: 1.00033
grad norms: [0.00071138202, 0.012906088, 0.041535053, 0.059204392, 0.01382478]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.675971780328
tst_shape: (30, 30)
tst_pe: 0.604059333481
================================================================================
...
At iterate   10    f=  7.73023D-03    |proj g|=  1.28633D-03
.......
================================================================================
#calls: 20
elapsed: 52.9186990261
fb norms: [0.98742837, 0.99113566, 1.0340216, 1.0532711]
W norm: 0.994592
grad norms: [0.0013962716, 0.0047671976, 0.013849364, 0.020416949, 0.0049629393]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.746548170987
tst_shape: (30, 30)
tst_pe: 0.614015311379
================================================================================
...
At iterate   20    f=  5.70650D-03    |proj g|=  1.20350D-03
.......
================================================================================
#calls: 30
elapsed: 78.1163420677
fb norms: [1.0225306, 1.0338128, 1.1590636, 1.2250187]
W norm: 1.02878
grad norms: [0.0015289793, 0.0049153431, 0.015324926, 0.019468147, 0.004893465]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.802716210098
tst_shape: (30, 30)
tst_pe: 0.63675217065
================================================================================
...
At iterate   30    f=  3.67384D-03    |proj g|=  1.30495D-03
.......
================================================================================
#calls: 40
elapsed: 103.340801001
fb norms: [1.1044605, 1.125877, 1.3621137, 1.4866771]
W norm: 1.11235
grad norms: [0.0011695446, 0.0084462669, 0.012434863, 0.013645479, 0.0020349575]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.852525475626
tst_shape: (30, 30)
tst_pe: 0.619104417371
================================================================================
...
At iterate   40    f=  1.63086D-03    |proj g|=  9.70573D-04
.......
================================================================================
#calls: 50
elapsed: 128.621659994
fb norms: [1.2249488, 1.2649225, 1.6913151, 1.9130397]
W norm: 1.23912
grad norms: [0.00056963944, 0.0037742574, 0.0089168493, 0.0095952479, 0.0015646525]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.917388852231
tst_shape: (30, 30)
tst_pe: 0.609787530109
================================================================================
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   49   53      1     0     0   0.000D+00   3.244D-04
  F =  3.24435939546674490E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.672E-01 seconds.
 Line search           time 1.302E+02 seconds.

 Total User time 1.342E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.660727577999


********************************************************************************
>>> Finding a balanced patch...
bal: 0.783818938606 219 224
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.617800951
fb norms: [0.99999988, 0.99999988, 1.0000011, 1.0000004]
W norm: 1.0
grad norms: [0.0052893953, 0.051406313, 0.27462077, 0.42758846, 0.11565118]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.585572930385
tst_shape: (30, 30)
tst_pe: 0.573757632404
================================================================================

At iterate    0    f=  1.36804D-02    |proj g|=  8.75496D-02
..........
================================================================================
#calls: 10
elapsed: 27.7740459442
fb norms: [1.0003326, 1.0004146, 1.0011464, 1.0020947]
W norm: 1.00075
grad norms: [0.0017196683, 0.0050319512, 0.02040494, 0.02843966, 0.0064237635]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.652970576209
tst_shape: (30, 30)
tst_pe: 0.631039052916
================================================================================
..
At iterate   10    f=  8.28614D-03    |proj g|=  6.11316D-03
........
================================================================================
#calls: 20
elapsed: 52.9687530994
fb norms: [0.99262857, 0.99673045, 1.0328431, 1.0576137]
W norm: 0.994073
grad norms: [0.00068104244, 0.0065640495, 0.021831144, 0.032227598, 0.0080867037]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.734838629118
tst_shape: (30, 30)
tst_pe: 0.637678914843
================================================================================
..
At iterate   20    f=  6.05881D-03    |proj g|=  1.19212D-03
........
================================================================================
#calls: 30
elapsed: 78.2592661381
fb norms: [1.0249004, 1.0345556, 1.1241103, 1.1938777]
W norm: 1.02357
grad norms: [0.0008136009, 0.0038800815, 0.011362251, 0.014539079, 0.0020831595]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.789928696911
tst_shape: (30, 30)
tst_pe: 0.62090427069
================================================================================
..
At iterate   30    f=  4.21908D-03    |proj g|=  1.79241D-03
........
================================================================================
#calls: 40
elapsed: 103.495908976
fb norms: [1.1113889, 1.132814, 1.3494054, 1.5126619]
W norm: 1.11147
grad norms: [0.00083960162, 0.0048340131, 0.015460328, 0.020200739, 0.0049222196]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.846792124482
tst_shape: (30, 30)
tst_pe: 0.589530677167
================================================================================
..
At iterate   40    f=  2.10741D-03    |proj g|=  1.37260D-03
........
================================================================================
#calls: 50
elapsed: 128.755243063
fb norms: [1.2102246, 1.2457415, 1.6165557, 1.8747479]
W norm: 1.2134
grad norms: [0.00062800292, 0.0039452654, 0.013818414, 0.015860328, 0.0040079099]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.906682100589
tst_shape: (30, 30)
tst_pe: 0.578017069391
================================================================================
..
At iterate   50    f=  4.80441D-04    |proj g|=  1.07352D-03
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   54      1     0     0   0.000D+00   3.392D-04
  F =  3.39181424351409078E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.955E-01 seconds.
 Line search           time 1.326E+02 seconds.

 Total User time 1.367E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.658129327558


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777835587929 1076 729
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60849189758
fb norms: [1.0, 0.99999809, 0.99999833, 0.9999997]
W norm: 1.0
grad norms: [0.00097389991, 0.019227702, 0.094470941, 0.13672613, 0.025673458]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.572204555606
tst_shape: (30, 30)
tst_pe: 0.513441312684
================================================================================

At iterate    0    f=  1.10804D-02    |proj g|=  1.38924D-02
..........
================================================================================
#calls: 10
elapsed: 27.7663948536
fb norms: [0.99968606, 0.99996287, 1.0027924, 1.0054837]
W norm: 1.00232
grad norms: [0.00096030609, 0.0042232033, 0.012612403, 0.020315457, 0.0026288156]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.68166958723
tst_shape: (30, 30)
tst_pe: 0.60846318744
================================================================================
..
At iterate   10    f=  7.85265D-03    |proj g|=  4.02786D-03
........
================================================================================
#calls: 20
elapsed: 52.9094889164
fb norms: [1.0008552, 1.004176, 1.0367256, 1.0703902]
W norm: 1.01006
grad norms: [0.0012435666, 0.0069230138, 0.017876728, 0.0214672, 0.0057335799]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.763196208163
tst_shape: (30, 30)
tst_pe: 0.630081126779
================================================================================
..
At iterate   20    f=  5.63263D-03    |proj g|=  3.81799D-03
........
================================================================================
#calls: 30
elapsed: 78.1123077869
fb norms: [1.0410084, 1.0507619, 1.1541675, 1.2495313]
W norm: 1.05012
grad norms: [0.00088923727, 0.0043531372, 0.011607636, 0.015230944, 0.0028667899]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.809792245332
tst_shape: (30, 30)
tst_pe: 0.610418650375
================================================================================
..
At iterate   30    f=  3.63709D-03    |proj g|=  1.10366D-03
........
================================================================================
#calls: 40
elapsed: 103.37309885
fb norms: [1.1320972, 1.1531767, 1.3915784, 1.5776055]
W norm: 1.14411
grad norms: [0.001065832, 0.0061349268, 0.010393464, 0.011799811, 0.0018156454]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.86706898593
tst_shape: (30, 30)
tst_pe: 0.593688476555
================================================================================
..
At iterate   40    f=  1.32357D-03    |proj g|=  2.32651D-03
........
================================================================================
#calls: 50
elapsed: 128.683987856
fb norms: [1.2664274, 1.3070166, 1.7618819, 2.0726366]
W norm: 1.2856
grad norms: [0.00038619206, 0.0081287585, 0.014230628, 0.015143944, 0.0037136397]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.937821233487
tst_shape: (30, 30)
tst_pe: 0.58348972447
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   51      1     0     0   0.000D+00   2.874D-04
  F =  2.87370989099144936E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 3.516E-01 seconds.
 Line search           time 1.254E+02 seconds.

 Total User time 1.294E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.656810066602


********************************************************************************
>>> Finding a balanced patch...
bal: 0.785639958377 709 415
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57635998726
fb norms: [0.99999958, 1.0000004, 0.99999899, 0.9999994]
W norm: 1.0
grad norms: [0.0041243867, 0.049925592, 0.31334156, 0.47934476, 0.1359998]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.60494083542
tst_shape: (30, 30)
tst_pe: 0.533197794951
================================================================================

At iterate    0    f=  1.40871D-02    |proj g|=  9.77987D-02
..........
================================================================================
#calls: 10
elapsed: 27.7249019146
fb norms: [1.0009873, 1.001106, 1.0022525, 1.0036578]
W norm: 1.0012
grad norms: [0.00071040797, 0.002972024, 0.011840206, 0.017038556, 0.0018356338]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.689085641629
tst_shape: (30, 30)
tst_pe: 0.602858578743
================================================================================
..
At iterate   10    f=  7.23706D-03    |proj g|=  1.53042D-03
........
================================================================================
#calls: 20
elapsed: 52.9047088623
fb norms: [1.0091599, 1.0120975, 1.0642799, 1.1070516]
W norm: 1.00794
grad norms: [0.00087848451, 0.0035623491, 0.01141022, 0.01760523, 0.0046328362]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.773762376436
tst_shape: (30, 30)
tst_pe: 0.610264952939
================================================================================
..
At iterate   20    f=  4.72938D-03    |proj g|=  2.84954D-03
........
================================================================================
#calls: 30
elapsed: 78.0980658531
fb norms: [1.0690721, 1.0766326, 1.2105783, 1.3136098]
W norm: 1.06729
grad norms: [0.0010930516, 0.0031395382, 0.0098473951, 0.014505261, 0.0024346234]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.82940218365
tst_shape: (30, 30)
tst_pe: 0.581994909705
================================================================================
..
At iterate   30    f=  2.40606D-03    |proj g|=  1.19033D-03
........
================================================================================
#calls: 40
elapsed: 103.32378602
fb norms: [1.2009242, 1.2194651, 1.5501939, 1.7859147]
W norm: 1.20157
grad norms: [0.0005549636, 0.0046926774, 0.012635413, 0.018619167, 0.004533127]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.907948574196
tst_shape: (30, 30)
tst_pe: 0.564712722449
================================================================================
..
At iterate   40    f=  5.84776D-04    |proj g|=  7.73329D-04
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   43   46      1     0     0   0.000D+00   2.302D-04
  F =  2.30241392273455858E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 2.754E-01 seconds.
 Line search           time 1.123E+02 seconds.

 Total User time 1.162E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.657355009571


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780437044745 835 438
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57599711418
fb norms: [0.99999964, 0.99999994, 1.0000008, 0.99999928]
W norm: 1.0
grad norms: [0.004083415, 0.03530062, 0.18184894, 0.34426627, 0.082080409]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.559720281616
tst_shape: (30, 30)
tst_pe: 0.518079094672
================================================================================

At iterate    0    f=  1.23981D-02    |proj g|=  5.84727D-02
..........
================================================================================
#calls: 10
elapsed: 27.6616101265
fb norms: [0.99552953, 0.99570972, 0.99812794, 1.0025508]
W norm: 0.997849
grad norms: [0.00052507827, 0.0030157662, 0.011716209, 0.016602885, 0.0024504266]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.666579278152
tst_shape: (30, 30)
tst_pe: 0.618778390826
================================================================================
...
At iterate   10    f=  7.49206D-03    |proj g|=  2.41572D-03
.......
================================================================================
#calls: 20
elapsed: 52.8346891403
fb norms: [0.99968988, 1.0023178, 1.0420315, 1.0898517]
W norm: 1.00371
grad norms: [0.0011017289, 0.003233342, 0.01415533, 0.016276438, 0.004061657]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.74127394005
tst_shape: (30, 30)
tst_pe: 0.63528702432
================================================================================
...
At iterate   20    f=  5.59592D-03    |proj g|=  1.24965D-03
.......
================================================================================
#calls: 30
elapsed: 78.0472841263
fb norms: [1.0306332, 1.0354983, 1.1154757, 1.1953291]
W norm: 1.03221
grad norms: [0.001432783, 0.0040543796, 0.02166437, 0.028885361, 0.0062736245]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.773948379609
tst_shape: (30, 30)
tst_pe: 0.60220277902
================================================================================
...
At iterate   30    f=  4.14270D-03    |proj g|=  1.76014D-03
.......
================================================================================
#calls: 40
elapsed: 103.295849085
fb norms: [1.096819, 1.1073886, 1.2856493, 1.4426512]
W norm: 1.09773
grad norms: [0.0012910644, 0.0072786459, 0.034347661, 0.040696993, 0.0090998821]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.821914097847
tst_shape: (30, 30)
tst_pe: 0.588730260078
================================================================================
...
At iterate   40    f=  2.28836D-03    |proj g|=  2.94563D-03
.......
================================================================================
#calls: 50
elapsed: 128.669684172
fb norms: [1.2082397, 1.2296683, 1.5771619, 1.8555672]
W norm: 1.21137
grad norms: [0.00090350577, 0.005777433, 0.020035909, 0.023522031, 0.0055348896]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.892949442678
tst_shape: (30, 30)
tst_pe: 0.591039206343
================================================================================
...
At iterate   50    f=  5.82025D-04    |proj g|=  8.03055D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   4.245D-04
  F =  4.24524332629516721E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.004E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.390E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.655255434206


********************************************************************************
>>> Finding a balanced patch...
bal: 0.776014568158 183 122
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61463880539
fb norms: [0.99999982, 1.0000014, 1.0, 1.0]
W norm: 1.0
grad norms: [0.00085192593, 0.03256717, 0.160843, 0.20451409, 0.043686215]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.568131394374
tst_shape: (30, 30)
tst_pe: 0.528211693989
================================================================================

At iterate    0    f=  1.10408D-02    |proj g|=  3.07684D-02
..........
================================================================================
#calls: 10
elapsed: 27.7345349789
fb norms: [1.0002314, 1.0002742, 1.0010506, 1.0018499]
W norm: 1.00121
grad norms: [0.00076158158, 0.0087055136, 0.031833135, 0.036384363, 0.0055777011]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.651103606866
tst_shape: (30, 30)
tst_pe: 0.615908031753
================================================================================
..
At iterate   10    f=  8.39850D-03    |proj g|=  6.70894D-03
........
================================================================================
#calls: 20
elapsed: 52.9952428341
fb norms: [0.99501753, 0.99683666, 1.0191903, 1.0345943]
W norm: 1.00293
grad norms: [0.00064178294, 0.0042682542, 0.011391738, 0.015507174, 0.0039737276]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.727020321647
tst_shape: (30, 30)
tst_pe: 0.64790489151
================================================================================
..
At iterate   20    f=  6.43278D-03    |proj g|=  6.60696D-03
........
================================================================================
#calls: 30
elapsed: 78.212998867
fb norms: [1.0203784, 1.0262195, 1.0981233, 1.1605066]
W norm: 1.02795
grad norms: [0.0012065021, 0.0062058992, 0.015944349, 0.022685148, 0.0047390037]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.78094630848
tst_shape: (30, 30)
tst_pe: 0.648064016286
================================================================================
..
At iterate   30    f=  4.41419D-03    |proj g|=  2.28477D-03
........
================================================================================
#calls: 40
elapsed: 103.482944012
fb norms: [1.0797175, 1.0931139, 1.2434144, 1.377705]
W norm: 1.08634
grad norms: [0.001160679, 0.002699825, 0.014857116, 0.016319746, 0.0024803351]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.822222058985
tst_shape: (30, 30)
tst_pe: 0.642276922906
================================================================================
..
At iterate   40    f=  2.78543D-03    |proj g|=  2.78501D-03
........
================================================================================
#calls: 50
elapsed: 128.745570898
fb norms: [1.1722276, 1.1969233, 1.4693911, 1.6979909]
W norm: 1.18077
grad norms: [0.00085859932, 0.004634086, 0.014125013, 0.016337166, 0.0024198301]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.883368146539
tst_shape: (30, 30)
tst_pe: 0.639606938264
================================================================================
..
At iterate   50    f=  9.42733D-04    |proj g|=  1.40271D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   4.852D-04
  F =  4.85236203530803323E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.561E-01 seconds.
 Line search           time 1.398E+02 seconds.

 Total User time 1.439E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.659242035873


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780957336108 293 279
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.6064209938
fb norms: [1.0000002, 1.0000004, 0.99999934, 1.0000001]
W norm: 1.0
grad norms: [0.0016839196, 0.03764081, 0.22449739, 0.29404414, 0.066792876]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.594829911949
tst_shape: (30, 30)
tst_pe: 0.585914853812
================================================================================

At iterate    0    f=  1.11747D-02    |proj g|=  5.12254D-02
..........
================================================================================
#calls: 10
elapsed: 27.7728261948
fb norms: [1.0012652, 1.0013034, 1.0020734, 1.0026618]
W norm: 1.00207
grad norms: [0.000456104, 0.007879205, 0.033609029, 0.044379134, 0.0078025297]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.66500824268
tst_shape: (30, 30)
tst_pe: 0.633120151881
================================================================================
...
At iterate   10    f=  7.87704D-03    |proj g|=  2.58844D-03
.......
================================================================================
#calls: 20
elapsed: 52.9416210651
fb norms: [1.0031258, 1.0053167, 1.034745, 1.0570173]
W norm: 1.00913
grad norms: [0.0020629386, 0.013451426, 0.068914413, 0.087037012, 0.021200418]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.741996458335
tst_shape: (30, 30)
tst_pe: 0.627902174427
================================================================================
...
At iterate   20    f=  5.91025D-03    |proj g|=  4.71199D-03
.......
================================================================================
#calls: 30
elapsed: 78.158591032
fb norms: [1.037357, 1.0437851, 1.1345611, 1.2035946]
W norm: 1.0416
grad norms: [0.0012505272, 0.0069063441, 0.016120354, 0.016025066, 0.0034987791]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.790757008102
tst_shape: (30, 30)
tst_pe: 0.603477854679
================================================================================
...
At iterate   30    f=  3.95631D-03    |proj g|=  1.47502D-03
.......
================================================================================
#calls: 40
elapsed: 103.428806067
fb norms: [1.0860561, 1.098019, 1.2569814, 1.3737245]
W norm: 1.09012
grad norms: [0.0011591947, 0.0035277703, 0.017669316, 0.018726217, 0.0043046977]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.83322697149
tst_shape: (30, 30)
tst_pe: 0.603205729489
================================================================================
...
At iterate   40    f=  1.92457D-03    |proj g|=  1.24894D-03
.......
================================================================================
#calls: 50
elapsed: 128.655027151
fb norms: [1.2065641, 1.2330242, 1.5619484, 1.7867918]
W norm: 1.21345
grad norms: [0.00076767599, 0.003300288, 0.0097528175, 0.010631313, 0.0015252527]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.910566193452
tst_shape: (30, 30)
tst_pe: 0.606224763924
================================================================================
...
At iterate   50    f=  2.47750D-04    |proj g|=  6.50250D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   1.709D-04
  F =  1.70944054843857884E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.053E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.390E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.657974005153


********************************************************************************
>>> Finding a balanced patch...
bal: 0.768470343392 883 197
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60173296928
fb norms: [0.9999997, 0.99999994, 0.99999958, 1.0000004]
W norm: 1.0
grad norms: [0.0016060058, 0.025976131, 0.21088277, 0.30417171, 0.070842206]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.584506609909
tst_shape: (30, 30)
tst_pe: 0.548832968381
================================================================================

At iterate    0    f=  1.18826D-02    |proj g|=  5.04460D-02
..........
================================================================================
#calls: 10
elapsed: 27.7538421154
fb norms: [0.99919307, 0.99922246, 0.99988008, 1.0001462]
W norm: 1.00003
grad norms: [0.0007593456, 0.011232775, 0.051772386, 0.078744754, 0.01643521]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.646953023528
tst_shape: (30, 30)
tst_pe: 0.599259139621
================================================================================
..
At iterate   10    f=  8.64134D-03    |proj g|=  5.90246D-03
........
================================================================================
#calls: 20
elapsed: 52.9117879868
fb norms: [0.98684728, 0.98849434, 1.0114043, 1.0316918]
W norm: 0.99493
grad norms: [0.00071309297, 0.0064225779, 0.029039308, 0.035296053, 0.0085656159]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.738159001919
tst_shape: (30, 30)
tst_pe: 0.624971057426
================================================================================
..
At iterate   20    f=  6.61538D-03    |proj g|=  3.20529D-03
........
================================================================================
#calls: 30
elapsed: 78.0884680748
fb norms: [0.99884963, 1.0046037, 1.0755422, 1.1400453]
W norm: 1.00709
grad norms: [0.0012115042, 0.0035607049, 0.011993359, 0.014039088, 0.0025368854]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.790518453456
tst_shape: (30, 30)
tst_pe: 0.626250135853
================================================================================
..
At iterate   30    f=  4.29001D-03    |proj g|=  2.68649D-03
........
================================================================================
#calls: 40
elapsed: 103.384106159
fb norms: [1.0603191, 1.0760407, 1.2522497, 1.4121804]
W norm: 1.07001
grad norms: [0.0010557804, 0.0037555124, 0.016000286, 0.015069632, 0.0021978396]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.840966392572
tst_shape: (30, 30)
tst_pe: 0.613906414265
================================================================================
..
At iterate   40    f=  2.38404D-03    |proj g|=  2.56239D-03
........
================================================================================
#calls: 50
elapsed: 128.707030058
fb norms: [1.134859, 1.1596359, 1.4467788, 1.6907588]
W norm: 1.1484
grad norms: [0.00086312252, 0.0048700818, 0.013055475, 0.013334114, 0.0024613938]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.89270244403
tst_shape: (30, 30)
tst_pe: 0.594778153207
================================================================================
..
At iterate   50    f=  7.58653D-04    |proj g|=  2.92326D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   2.570D-04
  F =  2.56981526035815477E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.697E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.463E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.658633375715


********************************************************************************
>>> Finding a balanced patch...
bal: 0.773673257024 143 608
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62088322639
fb norms: [0.99999958, 1.0000013, 1.0000004, 1.0]
W norm: 1.0
grad norms: [0.0082508335, 0.12556843, 0.48365232, 0.6249761, 0.15552016]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.581510011998
tst_shape: (30, 30)
tst_pe: 0.549480391327
================================================================================

At iterate    0    f=  1.56565D-02    |proj g|=  1.02747D-01
..........
================================================================================
#calls: 10
elapsed: 27.7597680092
fb norms: [0.99800265, 0.99802792, 0.99853635, 0.9993335]
W norm: 0.997706
grad norms: [0.001751765, 0.0064485669, 0.029864019, 0.041151218, 0.0078692203]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.657247373521
tst_shape: (30, 30)
tst_pe: 0.617546467424
================================================================================
..
At iterate   10    f=  8.91458D-03    |proj g|=  8.86121D-03
........
================================================================================
#calls: 20
elapsed: 52.923951149
fb norms: [0.98084539, 0.981655, 0.99627709, 1.0091103]
W norm: 0.980106
grad norms: [0.00088229921, 0.0072434116, 0.023181917, 0.029928682, 0.0076961969]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.720894623566
tst_shape: (30, 30)
tst_pe: 0.623327118724
================================================================================
..
At iterate   20    f=  6.55914D-03    |proj g|=  1.34894D-03
........
================================================================================
#calls: 30
elapsed: 78.0899670124
fb norms: [0.99275136, 0.99538147, 1.0503697, 1.0950909]
W norm: 0.990385
grad norms: [0.00075389282, 0.0062044756, 0.014954722, 0.014449818, 0.0027792735]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.773227226734
tst_shape: (30, 30)
tst_pe: 0.6233261628
================================================================================
..
At iterate   30    f=  4.79013D-03    |proj g|=  6.02100D-03
........
================================================================================
#calls: 40
elapsed: 103.345537186
fb norms: [1.0547727, 1.0645803, 1.2180876, 1.3385283]
W norm: 1.05179
grad norms: [0.00076689012, 0.0090707699, 0.025382398, 0.020631509, 0.0050058467]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.826233597731
tst_shape: (30, 30)
tst_pe: 0.584674120206
================================================================================
..
At iterate   40    f=  3.00377D-03    |proj g|=  1.59318D-03
........
================================================================================
#calls: 50
elapsed: 128.626409054
fb norms: [1.1211022, 1.137722, 1.3703847, 1.5464914]
W norm: 1.12025
grad norms: [0.00084073102, 0.0058787968, 0.012932356, 0.012218906, 0.0017279943]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.870873794788
tst_shape: (30, 30)
tst_pe: 0.583829796099
================================================================================
..
At iterate   50    f=  1.20110D-03    |proj g|=  1.07626D-03
........
================================================================================
#calls: 60
elapsed: 153.93979907
fb norms: [1.2357736, 1.2662561, 1.6571058, 1.9366415]
W norm: 1.23855
grad norms: [0.00042139294, 0.0035305601, 0.01154227, 0.0088903382, 0.0017729135]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.935008022359
tst_shape: (30, 30)
tst_pe: 0.579963247096
================================================================================
..
At iterate   60    f=  1.62359D-04    |proj g|=  3.81001D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   61   64      1     0     0   0.000D+00   1.032D-04
  F =  1.03229926025960594E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.781E-01 seconds.
 Line search           time 1.576E+02 seconds.

 Total User time 1.619E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.658077162884


********************************************************************************
>>> Finding a balanced patch...
bal: 0.772372528616 123 186
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61234784126
fb norms: [1.0000001, 1.0000015, 0.99999911, 0.99999958]
W norm: 1.0
grad norms: [0.0013072543, 0.057865769, 0.28984597, 0.23661177, 0.052362517]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.565381778402
tst_shape: (30, 30)
tst_pe: 0.547420907485
================================================================================

At iterate    0    f=  1.17871D-02    |proj g|=  3.62894D-02
..........
================================================================================
#calls: 10
elapsed: 27.7226040363
fb norms: [0.99799639, 0.9980799, 0.9992156, 0.9990387]
W norm: 0.998834
grad norms: [0.0019267956, 0.0088031916, 0.032797921, 0.032564919, 0.0041493573]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.648007774817
tst_shape: (30, 30)
tst_pe: 0.600126775707
================================================================================
...
At iterate   10    f=  8.49630D-03    |proj g|=  7.57512D-03
.......
================================================================================
#calls: 20
elapsed: 52.8895578384
fb norms: [0.98206091, 0.98569918, 1.0088286, 1.0196376]
W norm: 0.988652
grad norms: [0.0016061987, 0.011926773, 0.048972148, 0.054551486, 0.015318097]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.73865071362
tst_shape: (30, 30)
tst_pe: 0.606102211601
================================================================================
...
At iterate   20    f=  6.45264D-03    |proj g|=  1.69674D-03
.......
================================================================================
#calls: 30
elapsed: 78.0950419903
fb norms: [1.0025615, 1.0115179, 1.0866857, 1.1357089]
W norm: 1.01047
grad norms: [0.0018790424, 0.006296203, 0.02681176, 0.032229178, 0.0074660922]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.78913885816
tst_shape: (30, 30)
tst_pe: 0.599858909865
================================================================================
...
At iterate   30    f=  4.39346D-03    |proj g|=  1.85289D-03
.......
================================================================================
#calls: 40
elapsed: 103.352562904
fb norms: [1.0637921, 1.0800213, 1.2502769, 1.3705689]
W norm: 1.07315
grad norms: [0.0011079812, 0.0050948015, 0.016938848, 0.019179093, 0.0034523353]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.834694052333
tst_shape: (30, 30)
tst_pe: 0.58896088355
================================================================================
...
At iterate   40    f=  2.39980D-03    |proj g|=  1.79103D-03
.......
================================================================================
#calls: 50
elapsed: 128.626608849
fb norms: [1.1412286, 1.165071, 1.4353909, 1.626698]
W norm: 1.15198
grad norms: [0.00093919964, 0.0034324164, 0.010988365, 0.014388405, 0.0026229972]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.885547263682
tst_shape: (30, 30)
tst_pe: 0.579845276055
================================================================================
...
At iterate   50    f=  5.83770D-04    |proj g|=  2.18597D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   60      1     0     0   0.000D+00   9.124D-05
  F =  9.12441173568367958E-005

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.795E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.511E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.666275573728


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777835587929 463 659
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62056493759
fb norms: [1.0000002, 1.0000001, 1.0000001, 0.99999994]
W norm: 1.0
grad norms: [0.0055453624, 0.078347743, 0.42789587, 0.5034256, 0.1139142]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.581698532814
tst_shape: (30, 30)
tst_pe: 0.531745025254
================================================================================

At iterate    0    f=  1.41618D-02    |proj g|=  8.61823D-02
..........
================================================================================
#calls: 10
elapsed: 27.777807951
fb norms: [0.99580324, 0.99587387, 0.99689162, 0.99808794]
W norm: 0.995601
grad norms: [0.0026144208, 0.0077627329, 0.040652674, 0.057370536, 0.013455429]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.653531213221
tst_shape: (30, 30)
tst_pe: 0.577791306728
================================================================================
..
At iterate   10    f=  8.52000D-03    |proj g|=  4.66875D-03
........
================================================================================
#calls: 20
elapsed: 52.9569089413
fb norms: [0.9794389, 0.9808225, 1.0030112, 1.0195912]
W norm: 0.980049
grad norms: [0.00070071127, 0.0037505613, 0.013650117, 0.017911309, 0.0031088367]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.729514457013
tst_shape: (30, 30)
tst_pe: 0.610725737633
================================================================================
..
At iterate   20    f=  6.24134D-03    |proj g|=  2.03495D-03
........
================================================================================
#calls: 30
elapsed: 78.1447319984
fb norms: [0.99979019, 1.0048457, 1.090619, 1.1540496]
W norm: 1.0013
grad norms: [0.00072721776, 0.0044286484, 0.012452164, 0.014829841, 0.0020080009]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.783573895988
tst_shape: (30, 30)
tst_pe: 0.630290205812
================================================================================
..
At iterate   30    f=  4.37499D-03    |proj g|=  1.29399D-03
........
================================================================================
#calls: 40
elapsed: 103.40425992
fb norms: [1.0748656, 1.0889765, 1.2860702, 1.4318749]
W norm: 1.07665
grad norms: [0.00083049835, 0.0087750182, 0.024036584, 0.018713336, 0.0038662425]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.839233004126
tst_shape: (30, 30)
tst_pe: 0.622199286478
================================================================================
..
At iterate   40    f=  2.56902D-03    |proj g|=  1.52616D-03
........
================================================================================
#calls: 50
elapsed: 128.669950008
fb norms: [1.161611, 1.1856626, 1.5090224, 1.7372605]
W norm: 1.16607
grad norms: [0.00068339676, 0.0047470154, 0.015449059, 0.016070914, 0.0034903807]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.896163702731
tst_shape: (30, 30)
tst_pe: 0.62382980393
================================================================================
..
At iterate   50    f=  7.43578D-04    |proj g|=  4.47332D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   3.088D-04
  F =  3.08806367684155703E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.688E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.462E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.67134309867


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780176899063 402 345
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60419797897
fb norms: [0.99999988, 1.0000006, 1.0000008, 0.99999994]
W norm: 1.0
grad norms: [0.0032077443, 0.10553096, 0.4249166, 0.44757107, 0.10048703]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.580949922005
tst_shape: (30, 30)
tst_pe: 0.577424060019
================================================================================

At iterate    0    f=  1.26138D-02    |proj g|=  7.10306D-02
..........
================================================================================
#calls: 10
elapsed: 27.7637958527
fb norms: [0.9992255, 0.99926406, 0.99982852, 1.0004607]
W norm: 0.999743
grad norms: [0.0015789133, 0.0089802081, 0.02520363, 0.025347998, 0.0063124062]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.654832668896
tst_shape: (30, 30)
tst_pe: 0.623603869585
================================================================================
...
At iterate   10    f=  7.80173D-03    |proj g|=  2.31511D-03
.......
================================================================================
#calls: 20
elapsed: 52.9500720501
fb norms: [0.98722684, 0.98933607, 1.0134583, 1.0351286]
W norm: 0.990398
grad norms: [0.0005685357, 0.004799745, 0.01520253, 0.016786095, 0.002635251]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.732621133209
tst_shape: (30, 30)
tst_pe: 0.632824449856
================================================================================
...
At iterate   20    f=  5.58483D-03    |proj g|=  3.89542D-03
.......
================================================================================
#calls: 30
elapsed: 78.1636090279
fb norms: [1.020359, 1.0286074, 1.1291875, 1.2070253]
W norm: 1.02233
grad norms: [0.0012296988, 0.0065081725, 0.022822781, 0.028911278, 0.0073606898]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.793630651662
tst_shape: (30, 30)
tst_pe: 0.612878332184
================================================================================
...
At iterate   30    f=  3.71282D-03    |proj g|=  3.19167D-03
.......
================================================================================
#calls: 40
elapsed: 103.416607857
fb norms: [1.0804704, 1.0963579, 1.301156, 1.4468657]
W norm: 1.08269
grad norms: [0.00080237677, 0.005704199, 0.013577121, 0.012873968, 0.0022110944]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.837810406686
tst_shape: (30, 30)
tst_pe: 0.605857522155
================================================================================
...
At iterate   40    f=  2.06207D-03    |proj g|=  1.98836D-03
.......
================================================================================
#calls: 50
elapsed: 128.687612057
fb norms: [1.1798573, 1.2076839, 1.5664647, 1.8034594]
W norm: 1.18477
grad norms: [0.00059128954, 0.0053578452, 0.011949006, 0.011445072, 0.0016902392]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.900010370528
tst_shape: (30, 30)
tst_pe: 0.59774575962
================================================================================
...
At iterate   50    f=  5.75422D-04    |proj g|=  1.05839D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   56      1     0     0   0.000D+00   3.378D-04
  F =  3.37809760821983218E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.229E-01 seconds.
 Line search           time 1.374E+02 seconds.

 Total User time 1.415E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.671685500473


********************************************************************************
>>> Finding a balanced patch...
bal: 0.770551508845 863 488
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.63383197784
fb norms: [0.99999958, 1.0000002, 1.0000001, 1.0000012]
W norm: 1.0
grad norms: [0.0014954153, 0.053570893, 0.31172347, 0.32921508, 0.080568656]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.582821124657
tst_shape: (30, 30)
tst_pe: 0.54677208649
================================================================================

At iterate    0    f=  1.24077D-02    |proj g|=  6.23738D-02
..........
================================================================================
#calls: 10
elapsed: 27.7476809025
fb norms: [0.9972955, 0.99738634, 0.9989748, 0.99939138]
W norm: 0.998211
grad norms: [0.0010966752, 0.0061826454, 0.028563062, 0.030963719, 0.0055118091]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.668616674483
tst_shape: (30, 30)
tst_pe: 0.606800516064
================================================================================
...
At iterate   10    f=  7.87636D-03    |proj g|=  4.24437D-03
.......
================================================================================
#calls: 20
elapsed: 52.9461610317
fb norms: [0.98266983, 0.9860791, 1.022468, 1.0466863]
W norm: 0.98918
grad norms: [0.00068801508, 0.0036678724, 0.012847543, 0.013907135, 0.003229456]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.751460958037
tst_shape: (30, 30)
tst_pe: 0.616372472585
================================================================================
...
At iterate   20    f=  5.69838D-03    |proj g|=  1.60878D-02
.......
================================================================================
#calls: 30
elapsed: 78.1492488384
fb norms: [1.0090969, 1.0168748, 1.1015184, 1.1629561]
W norm: 1.01598
grad norms: [0.00074198487, 0.008959732, 0.033982344, 0.037345037, 0.0091185281]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.791627135148
tst_shape: (30, 30)
tst_pe: 0.605767929595
================================================================================
...
At iterate   30    f=  4.18869D-03    |proj g|=  2.45678D-03
.......
================================================================================
#calls: 40
elapsed: 103.40011692
fb norms: [1.0540706, 1.0677295, 1.2204101, 1.3323251]
W norm: 1.06
grad norms: [0.0010867016, 0.0038143962, 0.011115653, 0.014183824, 0.0027984385]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.823756853669
tst_shape: (30, 30)
tst_pe: 0.582043579148
================================================================================
...
At iterate   40    f=  2.41016D-03    |proj g|=  7.10809D-03
.......
================================================================================
#calls: 50
elapsed: 128.681136847
fb norms: [1.1439886, 1.1684581, 1.4342823, 1.6275504]
W norm: 1.15194
grad norms: [0.00082351215, 0.0027784251, 0.012228795, 0.014747112, 0.0028303834]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.88625189827
tst_shape: (30, 30)
tst_pe: 0.573375600751
================================================================================
...
At iterate   50    f=  7.01686D-04    |proj g|=  2.28373D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   59      1     0     0   0.000D+00   2.192D-04
  F =  2.19159352127462626E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.697E-01 seconds.
 Line search           time 1.445E+02 seconds.

 Total User time 1.487E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.672124273823


********************************************************************************
>>> Finding a balanced patch...
bal: 0.78459937565 550 337
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58607983589
fb norms: [0.99999982, 1.0000012, 1.0, 0.99999928]
W norm: 1.0
grad norms: [0.0078711649, 0.078570306, 0.35816672, 0.51512218, 0.1197854]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.609325226927
tst_shape: (30, 30)
tst_pe: 0.54209061564
================================================================================

At iterate    0    f=  1.35126D-02    |proj g|=  8.88207D-02
..........
================================================================================
#calls: 10
elapsed: 27.7112429142
fb norms: [0.99875563, 0.99880582, 0.99931037, 0.99979883]
W norm: 0.998344
grad norms: [0.0020693308, 0.0094266906, 0.038903855, 0.048171628, 0.012500461]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.65630936279
tst_shape: (30, 30)
tst_pe: 0.58512348156
================================================================================
..
At iterate   10    f=  8.19704D-03    |proj g|=  4.98495D-03
........
================================================================================
#calls: 20
elapsed: 52.861084938
fb norms: [0.99021524, 0.99245065, 1.0053144, 1.0206447]
W norm: 0.989895
grad norms: [0.00082066504, 0.003850874, 0.0088303844, 0.011734758, 0.0020459038]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.725452625167
tst_shape: (30, 30)
tst_pe: 0.604408857034
================================================================================
..
At iterate   20    f=  6.21108D-03    |proj g|=  1.15359D-03
........
================================================================================
#calls: 30
elapsed: 78.1009898186
fb norms: [1.0186048, 1.0274792, 1.0920035, 1.1619281]
W norm: 1.01476
grad norms: [0.0010377311, 0.0032639559, 0.010002144, 0.011313713, 0.0016152228]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.782629271596
tst_shape: (30, 30)
tst_pe: 0.603193438267
================================================================================
..
At iterate   30    f=  4.21599D-03    |proj g|=  1.16443D-03
........
================================================================================
#calls: 40
elapsed: 103.341511011
fb norms: [1.0864406, 1.1029173, 1.2396736, 1.364645]
W norm: 1.08257
grad norms: [0.0011223527, 0.0034776845, 0.012826882, 0.015492457, 0.0027651645]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.827509281835
tst_shape: (30, 30)
tst_pe: 0.573273811807
================================================================================
..
At iterate   40    f=  2.34415D-03    |proj g|=  2.97262D-03
........
================================================================================
#calls: 50
elapsed: 128.649909019
fb norms: [1.189256, 1.2199535, 1.496227, 1.7223072]
W norm: 1.18741
grad norms: [0.00062859594, 0.0033506844, 0.011135087, 0.013973626, 0.0022127503]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.893763640285
tst_shape: (30, 30)
tst_pe: 0.574922392239
================================================================================
..
At iterate   50    f=  7.35156D-04    |proj g|=  6.94486D-04
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   1.905D-04
  F =  1.90547652891837060E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.834E-01 seconds.
 Line search           time 1.445E+02 seconds.

 Total User time 1.487E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.669839424447


********************************************************************************
>>> Finding a balanced patch...
bal: 0.785119667014 472 150
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61250090599
fb norms: [0.99999976, 1.0000015, 1.0000006, 1.0000007]
W norm: 1.0
grad norms: [0.0015309796, 0.011020167, 0.060274065, 0.086557768, 0.01587145]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.568969300082
tst_shape: (30, 30)
tst_pe: 0.525639253837
================================================================================

At iterate    0    f=  1.06748D-02    |proj g|=  8.33544D-03
..........
================================================================================
#calls: 10
elapsed: 27.7761847973
fb norms: [0.99188715, 0.99245948, 0.99734765, 1.0008221]
W norm: 0.995448
grad norms: [0.0011082686, 0.0047365394, 0.018217307, 0.026402242, 0.0059583373]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.679898404787
tst_shape: (30, 30)
tst_pe: 0.607382124609
================================================================================
...
At iterate   10    f=  7.56195D-03    |proj g|=  3.90169D-03
.......
================================================================================
#calls: 20
elapsed: 52.9478499889
fb norms: [0.9835577, 0.98879105, 1.0293905, 1.0651659]
W norm: 0.991175
grad norms: [0.00088485063, 0.0052625635, 0.0089801662, 0.013361645, 0.0030847148]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.753243309948
tst_shape: (30, 30)
tst_pe: 0.613411387437
================================================================================
...
At iterate   20    f=  5.21777D-03    |proj g|=  2.80144D-03
.......
================================================================================
#calls: 30
elapsed: 78.1221709251
fb norms: [1.036553, 1.0515602, 1.1883957, 1.3013345]
W norm: 1.04888
grad norms: [0.00068043807, 0.005663042, 0.021733562, 0.028486583, 0.0063003497]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.814214124335
tst_shape: (30, 30)
tst_pe: 0.605156840229
================================================================================
...
At iterate   30    f=  3.13125D-03    |proj g|=  2.07349D-03
.......
================================================================================
#calls: 40
elapsed: 103.395484924
fb norms: [1.1157434, 1.1415724, 1.3971472, 1.5917366]
W norm: 1.13164
grad norms: [0.00068586238, 0.003245349, 0.013661524, 0.019343982, 0.0042155483]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.867016062461
tst_shape: (30, 30)
tst_pe: 0.593963923059
================================================================================
...
At iterate   40    f=  1.02515D-03    |proj g|=  1.45461D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   45   49      1     0     0   0.000D+00   4.398D-04
  F =  4.39757597632706165E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.145E-01 seconds.
 Line search           time 1.194E+02 seconds.

 Total User time 1.234E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.668597451169


********************************************************************************
>>> Finding a balanced patch...
bal: 0.77133194589 262 143
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56475305557
fb norms: [0.99999982, 1.0000011, 1.000001, 0.99999934]
W norm: 1.0
grad norms: [0.0057053384, 0.052913867, 0.35051203, 0.54370332, 0.14619449]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.572826774503
tst_shape: (30, 30)
tst_pe: 0.545495589591
================================================================================

At iterate    0    f=  1.61851D-02    |proj g|=  1.08639D-01
..........
================================================================================
#calls: 10
elapsed: 27.7034220695
fb norms: [0.999268, 0.99930519, 0.99979025, 1.0004525]
W norm: 0.998666
grad norms: [0.0023204039, 0.0072898301, 0.022819292, 0.034849592, 0.010063045]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.652845770699
tst_shape: (30, 30)
tst_pe: 0.607408590164
================================================================================
..
At iterate   10    f=  8.71511D-03    |proj g|=  7.74559D-03
........
================================================================================
#calls: 20
elapsed: 52.8497300148
fb norms: [0.98100859, 0.98385692, 1.008991, 1.0345286]
W norm: 0.979634
grad norms: [0.00091326935, 0.0069026109, 0.015595134, 0.020207131, 0.0050769574]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.744444316376
tst_shape: (30, 30)
tst_pe: 0.610539475388
================================================================================
..
At iterate   20    f=  6.21543D-03    |proj g|=  2.19361D-03
........
================================================================================
#calls: 30
elapsed: 78.0913701057
fb norms: [1.0044713, 1.0113504, 1.0843638, 1.1477367]
W norm: 1.00075
grad norms: [0.00097202149, 0.0040281382, 0.010738488, 0.012919434, 0.0018563287]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.792111258043
tst_shape: (30, 30)
tst_pe: 0.604282089098
================================================================================
..
At iterate   30    f=  4.24602D-03    |proj g|=  1.10917D-03
........
================================================================================
#calls: 40
elapsed: 103.397911072
fb norms: [1.0790367, 1.0941224, 1.270191, 1.4075743]
W norm: 1.07632
grad norms: [0.00094405678, 0.0054538664, 0.016449768, 0.021897662, 0.0057948167]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.843260695337
tst_shape: (30, 30)
tst_pe: 0.583823622634
================================================================================
..
At iterate   40    f=  2.43281D-03    |proj g|=  1.08404D-03
........
================================================================================
#calls: 50
elapsed: 128.630160093
fb norms: [1.19214, 1.2198561, 1.5582099, 1.8039068]
W norm: 1.19402
grad norms: [0.00069123984, 0.003922293, 0.015115718, 0.017582092, 0.0037014398]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.909097707647
tst_shape: (30, 30)
tst_pe: 0.568482842824
================================================================================
..
At iterate   50    f=  5.90203D-04    |proj g|=  1.09676D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   55      1     0     0   0.000D+00   3.787D-04
  F =  3.78677650587633252E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 9.766E-04 seconds.
 Subspace minimization time 4.092E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.390E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.663532246034


********************************************************************************
>>> Finding a balanced patch...
bal: 0.776534859521 623 571
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.6136469841
fb norms: [0.99999988, 0.99999899, 0.9999994, 1.0000002]
W norm: 1.0
grad norms: [0.0019068365, 0.026755845, 0.17110883, 0.25882131, 0.065603606]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.598621325151
tst_shape: (30, 30)
tst_pe: 0.515964797872
================================================================================

At iterate    0    f=  1.11784D-02    |proj g|=  4.49613D-02
..........
================================================================================
#calls: 10
elapsed: 27.7471239567
fb norms: [0.99888611, 0.99896371, 1.0000806, 1.0012752]
W norm: 0.999645
grad norms: [0.00096983887, 0.0072164945, 0.036872562, 0.049139015, 0.011794296]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.675279236408
tst_shape: (30, 30)
tst_pe: 0.592971708869
================================================================================
..
At iterate   10    f=  8.16340D-03    |proj g|=  1.98483D-03
........
================================================================================
#calls: 20
elapsed: 52.9013819695
fb norms: [0.99490094, 0.99847937, 1.0361202, 1.0712411]
W norm: 0.998453
grad norms: [0.00094444561, 0.0054906295, 0.023357511, 0.033937398, 0.0097861271]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.755577287221
tst_shape: (30, 30)
tst_pe: 0.608319052662
================================================================================
..
At iterate   20    f=  5.88340D-03    |proj g|=  2.73687D-03
........
================================================================================
#calls: 30
elapsed: 78.0954711437
fb norms: [1.0393717, 1.0497025, 1.1646812, 1.2789516]
W norm: 1.04385
grad norms: [0.00099822029, 0.0055208439, 0.013583357, 0.015581861, 0.0031426931]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.805188996059
tst_shape: (30, 30)
tst_pe: 0.603153965823
================================================================================
..
At iterate   30    f=  3.57454D-03    |proj g|=  2.28599D-03
........
================================================================================
#calls: 40
elapsed: 103.287681103
fb norms: [1.1127882, 1.1322483, 1.3575014, 1.5649943]
W norm: 1.11803
grad norms: [0.00088928774, 0.0037369689, 0.0094071776, 0.010810511, 0.001471082]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.865288224095
tst_shape: (30, 30)
tst_pe: 0.582776902979
================================================================================
..
At iterate   40    f=  1.44972D-03    |proj g|=  1.59228D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   46   49      1     0     0   0.000D+00   4.473D-04
  F =  4.47288388386368752E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.223E-01 seconds.
 Line search           time 1.194E+02 seconds.

 Total User time 1.233E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.65655847993


********************************************************************************
>>> Finding a balanced patch...
bal: 0.783558792924 303 253
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58676099777
fb norms: [0.9999997, 0.99999964, 1.0, 1.000001]
W norm: 1.0
grad norms: [0.0020359713, 0.041123889, 0.22769472, 0.3281962, 0.079884723]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.592453488365
tst_shape: (30, 30)
tst_pe: 0.53682956985
================================================================================

At iterate    0    f=  1.15941D-02    |proj g|=  5.76532D-02
..........
================================================================================
#calls: 10
elapsed: 27.7531399727
fb norms: [0.99718016, 0.9976024, 1.0012269, 1.003775]
W norm: 0.998845
grad norms: [0.00062144926, 0.0038389724, 0.011468056, 0.014532778, 0.0015864488]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.689139858845
tst_shape: (30, 30)
tst_pe: 0.611564232654
================================================================================
...
At iterate   10    f=  7.01591D-03    |proj g|=  3.60052D-03
.......
================================================================================
#calls: 20
elapsed: 52.9049949646
fb norms: [0.99691755, 1.0015422, 1.0392382, 1.0670717]
W norm: 1.00055
grad norms: [0.00084106979, 0.0030958185, 0.012595817, 0.01664868, 0.0041560186]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.755836845113
tst_shape: (30, 30)
tst_pe: 0.619172269442
================================================================================
...
At iterate   20    f=  4.87152D-03    |proj g|=  2.18073D-03
.......
================================================================================
#calls: 30
elapsed: 78.1039459705
fb norms: [1.0435393, 1.0552025, 1.1760075, 1.2644932]
W norm: 1.04978
grad norms: [0.0012535435, 0.0048908014, 0.011180821, 0.015510675, 0.002487021]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.816305808331
tst_shape: (30, 30)
tst_pe: 0.610832051829
================================================================================
...
At iterate   30    f=  2.64224D-03    |proj g|=  1.26691D-03
.......
================================================================================
#calls: 40
elapsed: 103.387359142
fb norms: [1.1257824, 1.1472769, 1.3884602, 1.5654364]
W norm: 1.13442
grad norms: [0.00085957319, 0.0024149753, 0.0080722235, 0.012087623, 0.0017776219]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.877181649711
tst_shape: (30, 30)
tst_pe: 0.615914554037
================================================================================
...
At iterate   40    f=  7.00058D-04    |proj g|=  1.36221D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   46   50      1     0     0   0.000D+00   1.374D-04
  F =  1.37391907628625631E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.193E-01 seconds.
 Line search           time 1.219E+02 seconds.

 Total User time 1.258E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.656433971344


********************************************************************************
>>> Finding a balanced patch...
bal: 0.788761706556 452 1060
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58403205872
fb norms: [1.0000002, 1.0000002, 0.99999928, 0.99999958]
W norm: 1.0
grad norms: [0.010579351, 0.074720792, 0.36221689, 0.67304927, 0.15642032]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.584114238547
tst_shape: (30, 30)
tst_pe: 0.565193576636
================================================================================

At iterate    0    f=  1.59190D-02    |proj g|=  1.09066D-01
..........
================================================================================
#calls: 10
elapsed: 27.6839189529
fb norms: [0.99908173, 0.99913174, 0.99945927, 1.0004419]
W norm: 0.998367
grad norms: [0.0019593062, 0.0067063323, 0.026187064, 0.045844194, 0.010830779]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.652684908511
tst_shape: (30, 30)
tst_pe: 0.604426726749
================================================================================
..
At iterate   10    f=  8.31253D-03    |proj g|=  4.40853D-03
........
================================================================================
#calls: 20
elapsed: 52.8276340961
fb norms: [0.98854047, 0.99025625, 1.0027658, 1.0258331]
W norm: 0.985303
grad norms: [0.0011974922, 0.005070494, 0.013387123, 0.026812607, 0.0053667282]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.714276775944
tst_shape: (30, 30)
tst_pe: 0.597591934546
================================================================================
..
At iterate   20    f=  6.41068D-03    |proj g|=  6.94070D-03
........
================================================================================
#calls: 30
elapsed: 78.0369939804
fb norms: [1.0033509, 1.0084809, 1.0629501, 1.1433504]
W norm: 0.998186
grad norms: [0.001140162, 0.0036152015, 0.01098784, 0.014422022, 0.0017148323]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.776033742416
tst_shape: (30, 30)
tst_pe: 0.611255235462
================================================================================
..
At iterate   30    f=  4.36358D-03    |proj g|=  3.15560D-03
........
================================================================================
#calls: 40
elapsed: 103.293540001
fb norms: [1.0837456, 1.0964807, 1.2408431, 1.4241376]
W norm: 1.07999
grad norms: [0.0008152111, 0.0040214485, 0.013873529, 0.022835022, 0.0050779069]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.835624695113
tst_shape: (30, 30)
tst_pe: 0.584221132647
================================================================================
..
At iterate   40    f=  2.13576D-03    |proj g|=  1.02803D-03
........
================================================================================
#calls: 50
elapsed: 128.527083158
fb norms: [1.201225, 1.2276831, 1.529084, 1.866601]
W norm: 1.20195
grad norms: [0.00076414109, 0.004768074, 0.0096834674, 0.010557511, 0.0016404876]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.907778964492
tst_shape: (30, 30)
tst_pe: 0.588812122887
================================================================================
..
At iterate   50    f=  4.67212D-04    |proj g|=  1.45378D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   55      1     0     0   0.000D+00   3.168D-04
  F =  3.16838704748079181E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.248E-01 seconds.
 Line search           time 1.348E+02 seconds.

 Total User time 1.389E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.655623759088


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775754422477 8 232
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61788487434
fb norms: [0.99999988, 0.99999923, 0.99999964, 0.99999946]
W norm: 1.0
grad norms: [0.0012899487, 0.02624842, 0.15291855, 0.29487029, 0.062848106]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.582737502191
tst_shape: (30, 30)
tst_pe: 0.542062027406
================================================================================

At iterate    0    f=  1.15289D-02    |proj g|=  4.22503D-02
..........
================================================================================
#calls: 10
elapsed: 27.7585909367
fb norms: [0.99644434, 0.99653208, 0.99822658, 1.0010833]
W norm: 0.998496
grad norms: [0.00090350583, 0.0098395143, 0.034971509, 0.073077329, 0.01463671]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.67244765529
tst_shape: (30, 30)
tst_pe: 0.608581830048
================================================================================
..
At iterate   10    f=  7.86888D-03    |proj g|=  2.87927D-03
........
================================================================================
#calls: 20
elapsed: 52.9436519146
fb norms: [0.9856351, 0.98906541, 1.0157813, 1.0609469]
W norm: 0.992312
grad norms: [0.00085062912, 0.0028788776, 0.011173628, 0.017464383, 0.0040314407]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.747274416811
tst_shape: (30, 30)
tst_pe: 0.600673551263
================================================================================
..
At iterate   20    f=  5.75210D-03    |proj g|=  1.03467D-03
........
================================================================================
#calls: 30
elapsed: 78.1653630733
fb norms: [1.0279185, 1.0376983, 1.1279627, 1.2502999]
W norm: 1.03395
grad norms: [0.0016339747, 0.004589567, 0.017441718, 0.021343181, 0.0053323135]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.805244321027
tst_shape: (30, 30)
tst_pe: 0.594776900613
================================================================================
..
At iterate   30    f=  3.63713D-03    |proj g|=  1.82340D-03
........
================================================================================
#calls: 40
elapsed: 103.389988899
fb norms: [1.0988306, 1.1157559, 1.2957547, 1.4912151]
W norm: 1.10518
grad norms: [0.0011085875, 0.0055534481, 0.017211724, 0.020626219, 0.0052278158]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.854794638651
tst_shape: (30, 30)
tst_pe: 0.59473141647
================================================================================
..
At iterate   40    f=  1.53521D-03    |proj g|=  6.80784D-03
........
================================================================================
#calls: 50
elapsed: 128.687614918
fb norms: [1.2047192, 1.2338715, 1.5770762, 1.8979642]
W norm: 1.21731
grad norms: [0.00047535609, 0.0032427146, 0.013567459, 0.019349039, 0.0049062283]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.920896846027
tst_shape: (30, 30)
tst_pe: 0.598116836616
================================================================================
..
At iterate   50    f=  4.31149D-04    |proj g|=  6.95570D-04
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   55      1     0     0   0.000D+00   1.980D-04
  F =  1.98008347069844604E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.102E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.391E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.64757350713


********************************************************************************
>>> Finding a balanced patch...
bal: 0.778095733611 658 207
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61551499367
fb norms: [1.0000002, 0.9999997, 1.0000011, 1.0000006]
W norm: 1.0
grad norms: [0.0068896725, 0.052596156, 0.30331427, 0.47599861, 0.11404709]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.603381027048
tst_shape: (30, 30)
tst_pe: 0.547800095654
================================================================================

At iterate    0    f=  1.25594D-02    |proj g|=  7.56535D-02
..........
================================================================================
#calls: 10
elapsed: 27.7537870407
fb norms: [0.99870223, 0.99873281, 0.99925059, 0.99996042]
W norm: 0.998506
grad norms: [0.0018515225, 0.0080700098, 0.02680077, 0.037766505, 0.0082246512]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.657283918064
tst_shape: (30, 30)
tst_pe: 0.600926406107
================================================================================
..
At iterate   10    f=  8.35276D-03    |proj g|=  3.64678D-03
........
================================================================================
#calls: 20
elapsed: 52.9092509747
fb norms: [0.98695296, 0.98838174, 1.0041548, 1.0207752]
W norm: 0.986587
grad norms: [0.00081508578, 0.0027231416, 0.011656154, 0.018672949, 0.0036689867]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.724809735841
tst_shape: (30, 30)
tst_pe: 0.609763594553
================================================================================
..
At iterate   20    f=  6.09758D-03    |proj g|=  3.25751D-03
........
================================================================================
#calls: 30
elapsed: 78.1691498756
fb norms: [1.0227218, 1.0288706, 1.109883, 1.1886765]
W norm: 1.0218
grad norms: [0.00096882746, 0.0056520845, 0.016105203, 0.021946369, 0.0058630016]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.792090139309
tst_shape: (30, 30)
tst_pe: 0.598818996783
================================================================================
..
At iterate   30    f=  4.19229D-03    |proj g|=  1.54886D-03
........
================================================================================
#calls: 40
elapsed: 103.434926033
fb norms: [1.1021025, 1.1149884, 1.2911928, 1.4545895]
W norm: 1.10253
grad norms: [0.00083921017, 0.0038869989, 0.014527662, 0.017856831, 0.0032037834]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.850288785303
tst_shape: (30, 30)
tst_pe: 0.59958526535
================================================================================
..
At iterate   40    f=  1.76994D-03    |proj g|=  1.27565D-03
........
================================================================================
#calls: 50
elapsed: 128.720301867
fb norms: [1.2393869, 1.2668711, 1.6336204, 1.9520676]
W norm: 1.24299
grad norms: [0.00044209728, 0.0051526516, 0.014677303, 0.019199485, 0.0039265021]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.926040123477
tst_shape: (30, 30)
tst_pe: 0.587883410384
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   49   52      1     0     0   0.000D+00   3.327D-04
  F =  3.32654744852334261E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 3.555E-01 seconds.
 Line search           time 1.279E+02 seconds.

 Total User time 1.319E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.643950155296


********************************************************************************
>>> Finding a balanced patch...
bal: 0.784859521332 403 151
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.59452199936
fb norms: [1.0000001, 0.99999887, 1.0, 1.0000001]
W norm: 1.0
grad norms: [0.0015703057, 0.017566085, 0.091772437, 0.16150427, 0.033132304]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.575281179924
tst_shape: (30, 30)
tst_pe: 0.535868024088
================================================================================

At iterate    0    f=  1.05702D-02    |proj g|=  1.88633D-02
..........
================================================================================
#calls: 10
elapsed: 27.7062621117
fb norms: [0.99884742, 0.99892497, 0.99968898, 1.0007753]
W norm: 1.00004
grad norms: [0.0014672069, 0.014635115, 0.048687711, 0.090242654, 0.018568499]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.648430943653
tst_shape: (30, 30)
tst_pe: 0.581532802353
================================================================================
..
At iterate   10    f=  7.87536D-03    |proj g|=  1.74637D-03
........
================================================================================
#calls: 20
elapsed: 52.8747470379
fb norms: [0.98901594, 0.99048144, 1.0048997, 1.025025]
W norm: 0.995532
grad norms: [0.00055944367, 0.0050724051, 0.01655452, 0.019912101, 0.0039688898]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.720123512568
tst_shape: (30, 30)
tst_pe: 0.606707578869
================================================================================
..
At iterate   20    f=  5.83873D-03    |proj g|=  4.25335D-03
........
================================================================================
#calls: 30
elapsed: 78.0829319954
fb norms: [1.005381, 1.0121545, 1.0871626, 1.162323]
W norm: 1.01337
grad norms: [0.0015483181, 0.0059202453, 0.021199575, 0.034723144, 0.0093676755]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.794172249758
tst_shape: (30, 30)
tst_pe: 0.605106909009
================================================================================
..
At iterate   30    f=  4.03001D-03    |proj g|=  2.94702D-03
........
================================================================================
#calls: 40
elapsed: 103.322724104
fb norms: [1.0639735, 1.078308, 1.2428108, 1.3879185]
W norm: 1.07314
grad norms: [0.00080623355, 0.0044114841, 0.017261399, 0.03052122, 0.0091133919]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.841569562389
tst_shape: (30, 30)
tst_pe: 0.59503154183
================================================================================
..
At iterate   40    f=  2.23783D-03    |proj g|=  1.17836D-03
........
================================================================================
#calls: 50
elapsed: 128.653254986
fb norms: [1.1599637, 1.1855462, 1.4739479, 1.7131993]
W norm: 1.17129
grad norms: [0.00072681223, 0.0048457705, 0.015308502, 0.018481169, 0.0052571045]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.899020212724
tst_shape: (30, 30)
tst_pe: 0.597687562342
================================================================================
..
At iterate   50    f=  8.26259D-04    |proj g|=  9.88443D-04
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   2.083D-04
  F =  2.08342375117354095E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.941E-01 seconds.
 Line search           time 1.445E+02 seconds.

 Total User time 1.486E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.633449720354


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775234131113 627 586
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61169815063
fb norms: [1.0000001, 1.0000001, 1.0000007, 0.99999958]
W norm: 1.0
grad norms: [0.0042455299, 0.044870079, 0.34839281, 0.5659923, 0.15492634]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.578085715212
tst_shape: (30, 30)
tst_pe: 0.547729326876
================================================================================

At iterate    0    f=  1.49291D-02    |proj g|=  9.74209D-02
..........
================================================================================
#calls: 10
elapsed: 27.7291400433
fb norms: [0.99740154, 0.99748713, 0.99804342, 0.99959981]
W norm: 0.997514
grad norms: [0.0024676833, 0.0081426045, 0.030823508, 0.04327438, 0.011970835]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.672844600519
tst_shape: (30, 30)
tst_pe: 0.611182731802
================================================================================
..
At iterate   10    f=  8.25044D-03    |proj g|=  8.10215D-03
........
================================================================================
#calls: 20
elapsed: 52.915418148
fb norms: [0.97946757, 0.98169231, 1.0042523, 1.0380657]
W norm: 0.978027
grad norms: [0.0018489842, 0.0062136739, 0.019267634, 0.020541757, 0.005093412]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.747029137889
tst_shape: (30, 30)
tst_pe: 0.620304677431
================================================================================
..
At iterate   20    f=  6.03226D-03    |proj g|=  1.31560D-03
........
================================================================================
#calls: 30
elapsed: 78.1659340858
fb norms: [1.0067967, 1.0136019, 1.0825547, 1.1686897]
W norm: 1.00517
grad norms: [0.0011509681, 0.0062825396, 0.014820783, 0.016077382, 0.0027197381]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.787377722251
tst_shape: (30, 30)
tst_pe: 0.611859058311
================================================================================
..
At iterate   30    f=  4.08472D-03    |proj g|=  1.29521D-03
........
================================================================================
#calls: 40
elapsed: 103.424250126
fb norms: [1.0789173, 1.0938716, 1.2424774, 1.39627]
W norm: 1.07792
grad norms: [0.00088611752, 0.0050153341, 0.016820135, 0.018323483, 0.0042440412]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.835550967998
tst_shape: (30, 30)
tst_pe: 0.590452165141
================================================================================
..
At iterate   40    f=  2.23604D-03    |proj g|=  2.76734D-03
........
================================================================================
#calls: 50
elapsed: 128.744709015
fb norms: [1.2259257, 1.2592661, 1.5995969, 1.9043041]
W norm: 1.23118
grad norms: [0.00075667934, 0.0090462826, 0.032339927, 0.046158921, 0.011997835]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.920438568188
tst_shape: (30, 30)
tst_pe: 0.597209387984
================================================================================
..
At iterate   50    f=  4.97371D-04    |proj g|=  9.28703D-04
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   1.836D-04
  F =  1.83634081622585654E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 4.551E-01 seconds.
 Line search           time 1.398E+02 seconds.

 Total User time 1.439E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.625009924433


********************************************************************************
>>> Finding a balanced patch...
bal: 0.767169614984 967 419
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57615208626
fb norms: [0.99999982, 0.99999928, 1.0000011, 0.99999946]
W norm: 1.0
grad norms: [0.0047385879, 0.070139296, 0.33145371, 0.53893381, 0.13090681]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.603479417815
tst_shape: (30, 30)
tst_pe: 0.547928368139
================================================================================

At iterate    0    f=  1.40765D-02    |proj g|=  9.16848D-02
..........
================================================================================
#calls: 10
elapsed: 27.7449259758
fb norms: [0.99958068, 0.99961025, 0.99997211, 1.0005757]
W norm: 0.999786
grad norms: [0.0019896543, 0.0071298163, 0.023308981, 0.032111805, 0.0086685168]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.666656748744
tst_shape: (30, 30)
tst_pe: 0.606785419328
================================================================================
..
At iterate   10    f=  8.54868D-03    |proj g|=  3.38959D-03
........
================================================================================
#calls: 20
elapsed: 52.9883561134
fb norms: [0.98670989, 0.98926455, 1.006178, 1.0275428]
W norm: 0.990593
grad norms: [0.00062321912, 0.0044034356, 0.011791409, 0.013867079, 0.0022592628]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.74440730708
tst_shape: (30, 30)
tst_pe: 0.605151511375
================================================================================
..
At iterate   20    f=  6.37330D-03    |proj g|=  1.15008D-03
........
================================================================================
#calls: 30
elapsed: 78.192027092
fb norms: [1.0031956, 1.0106107, 1.0761518, 1.1428056]
W norm: 1.00615
grad norms: [0.0010189596, 0.0024599056, 0.0090940986, 0.010851624, 0.0018518566]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.790124448999
tst_shape: (30, 30)
tst_pe: 0.595225654173
================================================================================
..
At iterate   30    f=  4.53655D-03    |proj g|=  7.12189D-03
........
================================================================================
#calls: 40
elapsed: 103.413516998
fb norms: [1.069322, 1.0849977, 1.2526278, 1.3982255]
W norm: 1.07233
grad norms: [0.0010695256, 0.0054210266, 0.014471986, 0.020289237, 0.0043128086]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.838481178623
tst_shape: (30, 30)
tst_pe: 0.574880574978
================================================================================
..
At iterate   40    f=  2.75060D-03    |proj g|=  3.49670D-03
........
================================================================================
#calls: 50
elapsed: 128.70314312
fb norms: [1.1457007, 1.1705277, 1.4508404, 1.6697997]
W norm: 1.15019
grad norms: [0.00095222844, 0.0039385874, 0.012776917, 0.013381843, 0.001914285]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.884758258738
tst_shape: (30, 30)
tst_pe: 0.566469319734
================================================================================
..
At iterate   50    f=  9.42773D-04    |proj g|=  1.32858D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   2.522D-04
  F =  2.52199184615164995E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.844E-01 seconds.
 Line search           time 1.446E+02 seconds.

 Total User time 1.487E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.622369622769


********************************************************************************
>>> Finding a balanced patch...
bal: 0.778095733611 253 226
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60233783722
fb norms: [0.99999958, 1.0000007, 1.0000005, 1.0000013]
W norm: 1.0
grad norms: [0.0012993215, 0.030136168, 0.1616942, 0.31307444, 0.068002596]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.590331622105
tst_shape: (30, 30)
tst_pe: 0.514209382064
================================================================================

At iterate    0    f=  1.11506D-02    |proj g|=  4.19856D-02
..........
================================================================================
#calls: 10
elapsed: 27.7311139107
fb norms: [0.99984086, 0.99989194, 1.0008726, 1.0017996]
W norm: 1.00107
grad norms: [0.00077731145, 0.0065874229, 0.028477853, 0.062344953, 0.012114001]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.661064287661
tst_shape: (30, 30)
tst_pe: 0.584929035288
================================================================================
..
At iterate   10    f=  7.96103D-03    |proj g|=  1.99584D-03
........
================================================================================
#calls: 20
elapsed: 52.8895068169
fb norms: [0.99431926, 0.99532264, 1.0158968, 1.032485]
W norm: 1.00199
grad norms: [0.00070736179, 0.0037321714, 0.01299681, 0.01837009, 0.0027258722]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.730849967288
tst_shape: (30, 30)
tst_pe: 0.593338084269
================================================================================
..
At iterate   20    f=  5.59474D-03    |proj g|=  1.50590D-03
........
================================================================================
#calls: 30
elapsed: 78.1117517948
fb norms: [1.0246235, 1.0290383, 1.1128713, 1.180672]
W norm: 1.03572
grad norms: [0.0010913748, 0.0055192527, 0.011025087, 0.014021351, 0.0019751266]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.796416043167
tst_shape: (30, 30)
tst_pe: 0.606101375862
================================================================================
..
At iterate   30    f=  3.85589D-03    |proj g|=  2.22437D-03
........
================================================================================
#calls: 40
elapsed: 103.380662918
fb norms: [1.0859295, 1.095363, 1.2588978, 1.3935876]
W norm: 1.09878
grad norms: [0.0016099757, 0.005294594, 0.020388277, 0.032753538, 0.0072520943]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.841939525677
tst_shape: (30, 30)
tst_pe: 0.590295425639
================================================================================
..
At iterate   40    f=  2.21712D-03    |proj g|=  1.54266D-03
........
================================================================================
#calls: 50
elapsed: 128.653862953
fb norms: [1.1824886, 1.20047, 1.4999365, 1.7430965]
W norm: 1.20032
grad norms: [0.00063810963, 0.0024388093, 0.0087708924, 0.011470573, 0.0015642688]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.906528194599
tst_shape: (30, 30)
tst_pe: 0.592936859833
================================================================================
..
At iterate   50    f=  4.16065D-04    |proj g|=  3.72074D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   1.309D-04
  F =  1.30864747916348279E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.570E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.462E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.609459759576


********************************************************************************
>>> Finding a balanced patch...
bal: 0.782258064516 509 472
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62306809425
fb norms: [1.0, 0.99999863, 1.0000002, 0.99999994]
W norm: 1.0
grad norms: [0.0054605473, 0.055639423, 0.43375275, 0.78670669, 0.16617998]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.610332970744
tst_shape: (30, 30)
tst_pe: 0.551369789253
================================================================================

At iterate    0    f=  1.57689D-02    |proj g|=  1.09693D-01
..........
================================================================================
#calls: 10
elapsed: 27.7493851185
fb norms: [0.99876058, 0.99879426, 0.99902046, 0.999614]
W norm: 0.998454
grad norms: [0.001860584, 0.0058830776, 0.019671036, 0.030981628, 0.0067589171]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.669968332945
tst_shape: (30, 30)
tst_pe: 0.60096009684
================================================================================
..
At iterate   10    f=  8.17851D-03    |proj g|=  5.21031D-03
........
================================================================================
#calls: 20
elapsed: 52.9469380379
fb norms: [0.98195952, 0.98430294, 1.0006728, 1.0254409]
W norm: 0.9823
grad norms: [0.00094493572, 0.0038771965, 0.0097642746, 0.012790304, 0.0014537007]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.739673488128
tst_shape: (30, 30)
tst_pe: 0.620468811553
================================================================================
..
At iterate   20    f=  5.46376D-03    |proj g|=  5.82411D-03
........
================================================================================
#calls: 30
elapsed: 78.1428940296
fb norms: [1.0059856, 1.0132436, 1.0869046, 1.1787835]
W norm: 1.00368
grad norms: [0.0011227468, 0.0049294489, 0.014836241, 0.021409284, 0.0055271937]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.799708090126
tst_shape: (30, 30)
tst_pe: 0.630117630726
================================================================================
..
At iterate   30    f=  3.83165D-03    |proj g|=  2.43215D-03
........
================================================================================
#calls: 40
elapsed: 103.375991106
fb norms: [1.081322, 1.0957592, 1.2587688, 1.4317167]
W norm: 1.07892
grad norms: [0.00081709964, 0.0032432526, 0.011061618, 0.013660362, 0.0024543253]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.850256877407
tst_shape: (30, 30)
tst_pe: 0.609383756419
================================================================================
..
At iterate   40    f=  1.83428D-03    |proj g|=  1.57671D-03
........
================================================================================
#calls: 50
elapsed: 128.655862093
fb norms: [1.1818348, 1.2074695, 1.512391, 1.7965584]
W norm: 1.18078
grad norms: [0.00072161527, 0.0034685982, 0.012118167, 0.012806332, 0.0028093066]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.914049935126
tst_shape: (30, 30)
tst_pe: 0.600450744867
================================================================================
..
At iterate   50    f=  3.99192D-04    |proj g|=  9.53618D-04
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   1.189D-04
  F =  1.18863768875598907E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.668E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.462E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.611880116725


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777315296566 152 337
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61836791039
fb norms: [1.0000001, 0.99999863, 1.0000005, 1.0000005]
W norm: 1.0
grad norms: [0.0030263071, 0.061921284, 0.30915534, 0.43712321, 0.096106812]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.607093893382
tst_shape: (30, 30)
tst_pe: 0.543480324019
================================================================================

At iterate    0    f=  1.15877D-02    |proj g|=  6.15423D-02
..........
================================================================================
#calls: 10
elapsed: 27.7749209404
fb norms: [0.99888629, 0.99894071, 0.99982536, 1.0011929]
W norm: 0.999615
grad norms: [0.0014242259, 0.0048678424, 0.021686235, 0.029208127, 0.0052898997]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.683539266328
tst_shape: (30, 30)
tst_pe: 0.606367548139
================================================================================
...
At iterate   10    f=  6.96609D-03    |proj g|=  1.12804D-02
.......
================================================================================
#calls: 20
elapsed: 52.9000148773
fb norms: [0.99744737, 0.99918896, 1.0223674, 1.0496634]
W norm: 0.999645
grad norms: [0.00099927781, 0.0037946235, 0.013262145, 0.016595159, 0.0030633521]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.758978443014
tst_shape: (30, 30)
tst_pe: 0.621336672232
================================================================================
...
At iterate   20    f=  5.03895D-03    |proj g|=  1.09124D-03
.......
================================================================================
#calls: 30
elapsed: 78.1631088257
fb norms: [1.0435615, 1.0501696, 1.1476496, 1.2438068]
W norm: 1.04577
grad norms: [0.0010426587, 0.0038456384, 0.011088471, 0.012311531, 0.0015474434]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.81085290196
tst_shape: (30, 30)
tst_pe: 0.599046584708
================================================================================
...
At iterate   30    f=  2.90616D-03    |proj g|=  1.57025D-03
.......
================================================================================
#calls: 40
elapsed: 103.452101946
fb norms: [1.1363076, 1.1506288, 1.3641638, 1.551173]
W norm: 1.13906
grad norms: [0.0008665651, 0.0033707772, 0.014696817, 0.017730508, 0.003001021]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.873873620249
tst_shape: (30, 30)
tst_pe: 0.581419532205
================================================================================
...
At iterate   40    f=  1.21557D-03    |proj g|=  1.07812D-03
.......
================================================================================
#calls: 50
elapsed: 128.761397839
fb norms: [1.2502452, 1.2752153, 1.6491942, 1.9535791]
W norm: 1.25567
grad norms: [0.0003340441, 0.0023345875, 0.0048196381, 0.006477735, 0.00098433509]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.941181644526
tst_shape: (30, 30)
tst_pe: 0.582346303056
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   1.124D-04
  F =  1.12405512481927872E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.418E-01 seconds.
 Line search           time 1.279E+02 seconds.

 Total User time 1.319E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.613022608012


********************************************************************************
>>> Finding a balanced patch...
bal: 0.774453694069 162 719
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60640001297
fb norms: [1.0000005, 0.99999917, 0.9999994, 0.99999988]
W norm: 1.0
grad norms: [0.0012712274, 0.031209046, 0.2127438, 0.36647007, 0.067953892]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.580628917536
tst_shape: (30, 30)
tst_pe: 0.536844012159
================================================================================

At iterate    0    f=  1.16092D-02    |proj g|=  4.44878D-02
..........
================================================================================
#calls: 10
elapsed: 27.7331359386
fb norms: [0.9927811, 0.99307448, 0.99662083, 1.0014173]
W norm: 0.99575
grad norms: [0.00098518014, 0.0067421854, 0.024057616, 0.027628178, 0.0044165934]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.692005402061
tst_shape: (30, 30)
tst_pe: 0.59998627398
================================================================================
...
At iterate   10    f=  7.53395D-03    |proj g|=  5.39553D-03
.......
================================================================================
#calls: 20
elapsed: 52.9008719921
fb norms: [0.98467606, 0.98693794, 1.0127822, 1.0441388]
W norm: 0.990086
grad norms: [0.00095446844, 0.0035345019, 0.011325423, 0.012436952, 0.0018782432]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.758782588605
tst_shape: (30, 30)
tst_pe: 0.608045039809
================================================================================
...
At iterate   20    f=  5.40466D-03    |proj g|=  5.25531D-03
.......
================================================================================
#calls: 30
elapsed: 78.1616120338
fb norms: [1.0191115, 1.0257336, 1.1115421, 1.198889]
W norm: 1.024
grad norms: [0.0014876586, 0.0061607901, 0.031143554, 0.042419724, 0.0090093315]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.802733418551
tst_shape: (30, 30)
tst_pe: 0.5942301022
================================================================================
...
At iterate   30    f=  3.61847D-03    |proj g|=  5.66643D-03
.......
================================================================================
#calls: 40
elapsed: 103.405109882
fb norms: [1.081, 1.0933106, 1.2600285, 1.4145482]
W norm: 1.0857
grad norms: [0.0010902432, 0.0034413415, 0.015751002, 0.01730971, 0.0028884679]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.847172588922
tst_shape: (30, 30)
tst_pe: 0.568093474642
================================================================================
...
At iterate   40    f=  1.99329D-03    |proj g|=  2.18318D-03
.......
================================================================================
#calls: 50
elapsed: 128.64990592
fb norms: [1.1758796, 1.1968762, 1.4902114, 1.738578]
W norm: 1.18168
grad norms: [0.00070972898, 0.0047572991, 0.015121252, 0.019786635, 0.0039096391]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.899311041246
tst_shape: (30, 30)
tst_pe: 0.555046588663
================================================================================
...
At iterate   50    f=  6.75955D-04    |proj g|=  1.84780D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   59      1     0     0   0.000D+00   1.554D-04
  F =  1.55361951328814030E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.551E-01 seconds.
 Line search           time 1.445E+02 seconds.

 Total User time 1.487E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.619077704164


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775234131113 160 579
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58594894409
fb norms: [0.99999976, 0.99999851, 1.000001, 0.9999994]
W norm: 1.0
grad norms: [0.0017041152, 0.047888242, 0.25205678, 0.42224613, 0.077727877]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.60238509434
tst_shape: (30, 30)
tst_pe: 0.502915654526
================================================================================

At iterate    0    f=  1.15999D-02    |proj g|=  5.43845D-02
..........
================================================================================
#calls: 10
elapsed: 27.6732368469
fb norms: [0.9966107, 0.99677998, 0.99860078, 1.0005635]
W norm: 0.997613
grad norms: [0.00062691013, 0.0034326946, 0.011934565, 0.016776072, 0.0017836647]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.68816330358
tst_shape: (30, 30)
tst_pe: 0.601338104407
================================================================================
...
At iterate   10    f=  7.81044D-03    |proj g|=  2.75929D-03
.......
================================================================================
#calls: 20
elapsed: 52.8554129601
fb norms: [0.9942373, 0.99632573, 1.0192721, 1.0406717]
W norm: 0.996648
grad norms: [0.00073968456, 0.002920982, 0.010011607, 0.014832824, 0.0018347268]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.747233286885
tst_shape: (30, 30)
tst_pe: 0.620825858333
================================================================================
...
At iterate   20    f=  5.86598D-03    |proj g|=  1.42929D-03
.......
================================================================================
#calls: 30
elapsed: 78.054899931
fb norms: [1.0163696, 1.021149, 1.0897436, 1.1435025]
W norm: 1.01848
grad norms: [0.00085967913, 0.0051191798, 0.018803841, 0.033618603, 0.0059126513]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.78311780026
tst_shape: (30, 30)
tst_pe: 0.61015231823
================================================================================
...
At iterate   30    f=  4.21427D-03    |proj g|=  1.38878D-03
.......
================================================================================
#calls: 40
elapsed: 103.364193916
fb norms: [1.0759439, 1.086573, 1.2479744, 1.3609555]
W norm: 1.07777
grad norms: [0.00107835, 0.0047584996, 0.017957693, 0.028849801, 0.0046055615]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.835222163833
tst_shape: (30, 30)
tst_pe: 0.600739830525
================================================================================
...
At iterate   40    f=  2.19626D-03    |proj g|=  1.05086D-03
.......
================================================================================
#calls: 50
elapsed: 128.646099806
fb norms: [1.1796492, 1.2033434, 1.5436575, 1.7693014]
W norm: 1.18475
grad norms: [0.00077575253, 0.0042931484, 0.01235317, 0.012653571, 0.0020075245]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.900790371819
tst_shape: (30, 30)
tst_pe: 0.57986481258
================================================================================
...
At iterate   50    f=  6.92099D-04    |proj g|=  1.00171D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   58      1     0     0   0.000D+00   3.119D-04
  F =  3.11933370539918542E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.473E-01 seconds.
 Line search           time 1.422E+02 seconds.

 Total User time 1.463E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.614938263329


********************************************************************************
>>> Finding a balanced patch...
bal: 0.784339229969 397 276
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56630182266
fb norms: [1.0000001, 1.0000005, 0.9999997, 0.99999994]
W norm: 1.0
grad norms: [0.0019722555, 0.010100515, 0.053107515, 0.077464916, 0.0083332527]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.564393520288
tst_shape: (30, 30)
tst_pe: 0.523794299199
================================================================================

At iterate    0    f=  1.07547D-02    |proj g|=  5.50762D-03
..........
================================================================================
#calls: 10
elapsed: 27.7105219364
fb norms: [0.99462879, 0.99480951, 0.99898177, 1.001312]
W norm: 0.996843
grad norms: [0.00037207882, 0.0038623405, 0.011842699, 0.018815495, 0.0015361651]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.66614408548
tst_shape: (30, 30)
tst_pe: 0.585427866301
================================================================================
...
At iterate   10    f=  7.77482D-03    |proj g|=  1.63505D-03
.......
================================================================================
#calls: 20
elapsed: 52.8803617954
fb norms: [0.98871148, 0.99022621, 1.0161352, 1.036411]
W norm: 0.993725
grad norms: [0.00071183377, 0.0040885592, 0.0096519832, 0.014488852, 0.0016509439]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.733123363622
tst_shape: (30, 30)
tst_pe: 0.612438050603
================================================================================
...
At iterate   20    f=  5.95525D-03    |proj g|=  1.16703D-03
.......
================================================================================
#calls: 30
elapsed: 78.0533328056
fb norms: [1.0238804, 1.0294276, 1.1182178, 1.1951672]
W norm: 1.03021
grad norms: [0.00083564047, 0.0065274485, 0.015963567, 0.018253192, 0.003564294]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.790313049787
tst_shape: (30, 30)
tst_pe: 0.602190232498
================================================================================
...
At iterate   30    f=  3.96028D-03    |proj g|=  2.25441D-03
.......
================================================================================
#calls: 40
elapsed: 103.285564899
fb norms: [1.1056812, 1.1178393, 1.3101952, 1.4721324]
W norm: 1.11305
grad norms: [0.0010436211, 0.0032120699, 0.0099303583, 0.012746089, 0.0017550304]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.846279233297
tst_shape: (30, 30)
tst_pe: 0.590860950207
================================================================================
...
At iterate   40    f=  1.57327D-03    |proj g|=  1.51242D-03
.......
================================================================================
#calls: 50
elapsed: 128.562041998
fb norms: [1.2313178, 1.2540772, 1.6072139, 1.8864836]
W norm: 1.24091
grad norms: [0.00063926791, 0.002591962, 0.0083812186, 0.01242997, 0.0025243252]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.918721480639
tst_shape: (30, 30)
tst_pe: 0.58244729522
================================================================================
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   49   53      1     0     0   0.000D+00   2.208D-04
  F =  2.20767804421484470E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.672E-01 seconds.
 Line search           time 1.301E+02 seconds.

 Total User time 1.341E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.617733883023


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780697190427 400 639
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60961604118
fb norms: [1.0000002, 0.99999964, 0.99999857, 0.99999952]
W norm: 1.0
grad norms: [0.00094600738, 0.034127723, 0.21845421, 0.39398897, 0.083636306]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.58635310305
tst_shape: (30, 30)
tst_pe: 0.532134781484
================================================================================

At iterate    0    f=  1.18153D-02    |proj g|=  5.80273D-02
..........
================================================================================
#calls: 10
elapsed: 27.7173380852
fb norms: [0.99667299, 0.99690837, 1.00008, 1.0036073]
W norm: 0.998195
grad norms: [0.00080445106, 0.0026505885, 0.012130417, 0.016149022, 0.0020962311]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.695129289906
tst_shape: (30, 30)
tst_pe: 0.602520591245
================================================================================
...
At iterate   10    f=  7.14271D-03    |proj g|=  1.59087D-03
.......
================================================================================
#calls: 20
elapsed: 52.8960111141
fb norms: [0.99315161, 0.99631298, 1.0403069, 1.0825493]
W norm: 0.995474
grad norms: [0.00076554291, 0.0042283195, 0.015591112, 0.018661415, 0.0040719332]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.763939521278
tst_shape: (30, 30)
tst_pe: 0.598117465457
================================================================================
...
At iterate   20    f=  5.13138D-03    |proj g|=  1.89489D-03
.......
================================================================================
#calls: 30
elapsed: 78.0713009834
fb norms: [1.0258573, 1.0331173, 1.1406376, 1.2266529]
W norm: 1.02737
grad norms: [0.0012685233, 0.0047792876, 0.014560396, 0.015691999, 0.0028418659]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.810332096802
tst_shape: (30, 30)
tst_pe: 0.587162000092
================================================================================
...
At iterate   30    f=  3.13241D-03    |proj g|=  4.07570D-03
.......
================================================================================
#calls: 40
elapsed: 103.314378977
fb norms: [1.1181014, 1.136284, 1.4084578, 1.5971072]
W norm: 1.11964
grad norms: [0.00073562644, 0.0035391636, 0.011199108, 0.013955802, 0.0028099439]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.87461742887
tst_shape: (30, 30)
tst_pe: 0.581467704345
================================================================================
...
At iterate   40    f=  1.31629D-03    |proj g|=  1.08447D-03
.......
================================================================================
#calls: 50
elapsed: 128.565029144
fb norms: [1.2120163, 1.2420952, 1.6788279, 1.9585706]
W norm: 1.21498
grad norms: [0.00045651104, 0.0017898103, 0.0067832978, 0.0071099182, 0.0012813061]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.934426064317
tst_shape: (30, 30)
tst_pe: 0.570565426077
================================================================================
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   49   53      1     0     0   0.000D+00   2.012D-04
  F =  2.01243106857873499E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.652E-01 seconds.
 Line search           time 1.301E+02 seconds.

 Total User time 1.341E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.623899900481


********************************************************************************
>>> Finding a balanced patch...
bal: 0.786940686785 687 459
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57741808891
fb norms: [0.9999997, 1.0000011, 1.0000007, 1.0000001]
W norm: 1.0
grad norms: [0.002093541, 0.014424687, 0.078032248, 0.11022893, 0.016923007]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.558463812004
tst_shape: (30, 30)
tst_pe: 0.528582291125
================================================================================

At iterate    0    f=  1.10466D-02    |proj g|=  8.47256D-03
..........
================================================================================
#calls: 10
elapsed: 27.7239861488
fb norms: [0.99179983, 0.99231136, 0.99717736, 0.99935949]
W norm: 0.994308
grad norms: [0.0014025656, 0.0089366119, 0.038751666, 0.047123391, 0.011947457]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.667529960982
tst_shape: (30, 30)
tst_pe: 0.602310492623
================================================================================
...
At iterate   10    f=  7.75386D-03    |proj g|=  5.00179D-03
.......
================================================================================
#calls: 20
elapsed: 52.8849451542
fb norms: [0.98405391, 0.98636472, 1.0076786, 1.021642]
W norm: 0.988181
grad norms: [0.0014498821, 0.0063664233, 0.012507873, 0.017919658, 0.0040152892]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.719097046478
tst_shape: (30, 30)
tst_pe: 0.604898712237
================================================================================
...
At iterate   20    f=  5.82578D-03    |proj g|=  1.24892D-02
.......
================================================================================
#calls: 30
elapsed: 78.0788140297
fb norms: [1.0140474, 1.0223554, 1.1055535, 1.1639701]
W norm: 1.02135
grad norms: [0.0010919799, 0.0062054913, 0.010836418, 0.011656289, 0.0015080997]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.786604437223
tst_shape: (30, 30)
tst_pe: 0.584760593588
================================================================================
...
At iterate   30    f=  3.74481D-03    |proj g|=  2.73296D-03
.......
================================================================================
#calls: 40
elapsed: 103.292811155
fb norms: [1.0772214, 1.0960748, 1.2789431, 1.4010085]
W norm: 1.08764
grad norms: [0.00092995353, 0.0044756914, 0.010598673, 0.012532877, 0.0013644001]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.835612145206
tst_shape: (30, 30)
tst_pe: 0.568562826333
================================================================================
...
At iterate   40    f=  1.97459D-03    |proj g|=  7.90982D-03
.......
================================================================================
#calls: 50
elapsed: 128.613181114
fb norms: [1.1859019, 1.2196928, 1.558286, 1.7711099]
W norm: 1.20061
grad norms: [0.00063427171, 0.0024370335, 0.0091943471, 0.011253727, 0.002492165]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.905192332309
tst_shape: (30, 30)
tst_pe: 0.571674627763
================================================================================
...
At iterate   50    f=  5.68052D-04    |proj g|=  9.55055D-04
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   56      1     0     0   0.000D+00   2.797D-04
  F =  2.79661297099664807E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 4.180E-01 seconds.
 Line search           time 1.374E+02 seconds.

 Total User time 1.414E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.635781785458


********************************************************************************
>>> Finding a balanced patch...
bal: 0.77471383975 749 669
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.5713698864
fb norms: [0.99999964, 0.99999899, 1.0000001, 0.99999934]
W norm: 1.0
grad norms: [0.0056071957, 0.064146705, 0.3291862, 0.66853678, 0.16347644]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.586753531563
tst_shape: (30, 30)
tst_pe: 0.530471105522
================================================================================

At iterate    0    f=  1.57807D-02    |proj g|=  1.07006D-01
..........
================================================================================
#calls: 10
elapsed: 27.6747310162
fb norms: [0.9986214, 0.99866027, 0.99919254, 0.99952859]
W norm: 0.998009
grad norms: [0.0015716781, 0.0049889195, 0.017635565, 0.024064735, 0.0026169941]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.649900100599
tst_shape: (30, 30)
tst_pe: 0.588712189881
================================================================================
..
At iterate   10    f=  8.84748D-03    |proj g|=  3.93024D-03
........
================================================================================
#calls: 20
elapsed: 52.8898389339
fb norms: [0.98767591, 0.988998, 1.0072788, 1.0235386]
W norm: 0.985437
grad norms: [0.0010114803, 0.0032663003, 0.013282956, 0.017103283, 0.0025672666]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.711274118993
tst_shape: (30, 30)
tst_pe: 0.600407332742
================================================================================
..
At iterate   20    f=  6.86935D-03    |proj g|=  1.68253D-03
........
================================================================================
#calls: 30
elapsed: 78.0956659317
fb norms: [1.0143045, 1.0191561, 1.0881867, 1.1445273]
W norm: 1.0119
grad norms: [0.0013129301, 0.0052734399, 0.01813391, 0.019241503, 0.0040486432]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.771432641963
tst_shape: (30, 30)
tst_pe: 0.598107886806
================================================================================
..
At iterate   30    f=  4.90307D-03    |proj g|=  2.37955D-03
........
================================================================================
#calls: 40
elapsed: 103.422906876
fb norms: [1.0669656, 1.0771755, 1.2143037, 1.316186]
W norm: 1.06645
grad norms: [0.0010868872, 0.0044718804, 0.013545295, 0.015132274, 0.001744288]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.813403809269
tst_shape: (30, 30)
tst_pe: 0.590503515463
================================================================================
..
At iterate   40    f=  3.07326D-03    |proj g|=  1.92496D-03
........
================================================================================
#calls: 50
elapsed: 128.728297949
fb norms: [1.147558, 1.1653222, 1.4055488, 1.5708573]
W norm: 1.15089
grad norms: [0.00067381171, 0.0038423447, 0.017668549, 0.025051445, 0.0068924767]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.86567232632
tst_shape: (30, 30)
tst_pe: 0.576728622163
================================================================================
..
At iterate   50    f=  1.44826D-03    |proj g|=  1.28810D-03
........
================================================================================
#calls: 60
elapsed: 154.025589943
fb norms: [1.2426744, 1.2716798, 1.6559389, 1.9064302]
W norm: 1.25166
grad norms: [0.00046820822, 0.0025907052, 0.012014217, 0.016910121, 0.0052440413]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.923976328071
tst_shape: (30, 30)
tst_pe: 0.583905274433
================================================================================
..
At iterate   60    f=  2.68154D-04    |proj g|=  4.64438D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   61   64      1     0     0   0.000D+00   1.678D-04
  F =  1.67754493304528296E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.684E-01 seconds.
 Line search           time 1.577E+02 seconds.

 Total User time 1.620E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.638808963626


********************************************************************************
>>> Finding a balanced patch...
bal: 0.795265348595 229 562
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56266903877
fb norms: [0.99999928, 0.99999994, 1.0000002, 1.0]
W norm: 1.0
grad norms: [0.0018599815, 0.055494253, 0.39813232, 0.66519666, 0.16983852]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.557090908692
tst_shape: (30, 30)
tst_pe: 0.543204436984
================================================================================

At iterate    0    f=  1.44566D-02    |proj g|=  9.50775D-02
..........
================================================================================
#calls: 10
elapsed: 27.7125451565
fb norms: [0.9995572, 0.99958515, 1.0001351, 1.0003715]
W norm: 0.999999
grad norms: [0.0017511985, 0.0059410301, 0.029095037, 0.044496689, 0.012250678]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.63727096733
tst_shape: (30, 30)
tst_pe: 0.612732891687
================================================================================
..
At iterate   10    f=  8.20796D-03    |proj g|=  1.01378D-02
........
================================================================================
#calls: 20
elapsed: 52.8769011497
fb norms: [0.99283111, 0.99344188, 1.0026646, 1.0086448]
W norm: 0.996046
grad norms: [0.00071510876, 0.0043866909, 0.01240021, 0.017138904, 0.0034885325]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.696621750375
tst_shape: (30, 30)
tst_pe: 0.615484735036
================================================================================
..
At iterate   20    f=  6.51263D-03    |proj g|=  3.45823D-03
........
================================================================================
#calls: 30
elapsed: 78.0599141121
fb norms: [1.0045805, 1.008414, 1.0745196, 1.1293901]
W norm: 1.00885
grad norms: [0.00080561871, 0.0051653166, 0.014996916, 0.025950825, 0.005768924]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.774987665122
tst_shape: (30, 30)
tst_pe: 0.624780998727
================================================================================
..
At iterate   30    f=  4.41860D-03    |proj g|=  1.23084D-03
........
================================================================================
#calls: 40
elapsed: 103.280826092
fb norms: [1.0524743, 1.0611976, 1.2140471, 1.3297412]
W norm: 1.05918
grad norms: [0.00085762097, 0.0065717003, 0.018633332, 0.022329118, 0.0049611861]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.819937290726
tst_shape: (30, 30)
tst_pe: 0.633231599442
================================================================================
..
At iterate   40    f=  2.70861D-03    |proj g|=  2.29988D-03
........
================================================================================
#calls: 50
elapsed: 128.559535027
fb norms: [1.1291087, 1.145798, 1.4151325, 1.6002429]
W norm: 1.13713
grad norms: [0.00085485337, 0.0038554205, 0.0098533379, 0.01157464, 0.0018397757]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.871555554015
tst_shape: (30, 30)
tst_pe: 0.622449543138
================================================================================
..
At iterate   50    f=  1.24647D-03    |proj g|=  1.28015D-03
........
================================================================================
#calls: 60
elapsed: 153.869369984
fb norms: [1.2094454, 1.2359465, 1.6409428, 1.9033817]
W norm: 1.21969
grad norms: [0.00056774402, 0.0025105623, 0.0071783634, 0.0083970958, 0.00122079]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.922155276379
tst_shape: (30, 30)
tst_pe: 0.613881322723
================================================================================
..
At iterate   60    f=  2.88993D-04    |proj g|=  1.58919D-03
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   61   64      1     0     0   0.000D+00   1.894D-04
  F =  1.89415790373459458E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.742E-01 seconds.
 Line search           time 1.576E+02 seconds.

 Total User time 1.618E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.638881953375


********************************************************************************
>>> Finding a balanced patch...
bal: 0.784079084287 282 26
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.5842769146
fb norms: [0.99999958, 0.99999982, 0.99999934, 1.0000002]
W norm: 1.0
grad norms: [0.0041308836, 0.071000785, 0.41797188, 0.82488179, 0.18060747]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.577649523674
tst_shape: (30, 30)
tst_pe: 0.572025109112
================================================================================

At iterate    0    f=  1.62392D-02    |proj g|=  1.08782D-01
..........
================================================================================
#calls: 10
elapsed: 27.7599179745
fb norms: [0.99817377, 0.99820304, 0.99849284, 0.99893147]
W norm: 0.997845
grad norms: [0.0014265135, 0.0065860585, 0.02322608, 0.042379159, 0.0084802369]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.63490951595
tst_shape: (30, 30)
tst_pe: 0.61264384599
================================================================================
..
At iterate   10    f=  9.16672D-03    |proj g|=  8.84842D-03
........
================================================================================
#calls: 20
elapsed: 52.9237420559
fb norms: [0.98337823, 0.98455697, 0.99351043, 1.0020709]
W norm: 0.982645
grad norms: [0.00049885164, 0.0094035054, 0.031042442, 0.047330454, 0.010297303]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.691070902656
tst_shape: (30, 30)
tst_pe: 0.616867289443
================================================================================
..
At iterate   20    f=  7.28934D-03    |proj g|=  2.06200D-03
........
================================================================================
#calls: 30
elapsed: 78.160572052
fb norms: [0.98464161, 0.98865527, 1.0339537, 1.0726283]
W norm: 0.982871
grad norms: [0.00092194654, 0.0060653859, 0.013905616, 0.014909529, 0.0024934099]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.762037736052
tst_shape: (30, 30)
tst_pe: 0.62719523509
================================================================================
..
At iterate   30    f=  5.28575D-03    |proj g|=  4.02958D-03
........
================================================================================
#calls: 40
elapsed: 103.476845026
fb norms: [1.044138, 1.0556104, 1.1959004, 1.3040814]
W norm: 1.04512
grad norms: [0.001340228, 0.0091096032, 0.030587772, 0.039478812, 0.0094584953]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.822685910254
tst_shape: (30, 30)
tst_pe: 0.624636057984
================================================================================
..
At iterate   40    f=  3.23264D-03    |proj g|=  1.04535D-03
........
================================================================================
#calls: 50
elapsed: 128.77502203
fb norms: [1.1321481, 1.1539309, 1.430162, 1.6188598]
W norm: 1.13908
grad norms: [0.00082571281, 0.0049097892, 0.011268553, 0.012935066, 0.0025529282]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.880144330463
tst_shape: (30, 30)
tst_pe: 0.600719680019
================================================================================
..
At iterate   50    f=  8.27008D-04    |proj g|=  2.99900D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   2.355D-04
  F =  2.35521729337051511E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.805E-01 seconds.
 Line search           time 1.447E+02 seconds.

 Total User time 1.488E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.638047304633


********************************************************************************
>>> Finding a balanced patch...
bal: 0.770291363163 797 283
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60254192352
fb norms: [1.0000004, 1.0000011, 1.0000002, 1.0000004]
W norm: 1.0
grad norms: [0.0051628277, 0.090683445, 0.43031749, 0.55844808, 0.12623906]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.591800416214
tst_shape: (30, 30)
tst_pe: 0.556470322607
================================================================================

At iterate    0    f=  1.38237D-02    |proj g|=  8.47905D-02
..........
================================================================================
#calls: 10
elapsed: 27.7531678677
fb norms: [0.99819374, 0.99823827, 0.99918723, 0.99960119]
W norm: 0.998695
grad norms: [0.0025039797, 0.010185036, 0.040085882, 0.055566225, 0.012687571]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.667960189799
tst_shape: (30, 30)
tst_pe: 0.604668035822
================================================================================
..
At iterate   10    f=  8.46826D-03    |proj g|=  1.98332D-03
........
================================================================================
#calls: 20
elapsed: 52.9239079952
fb norms: [0.98320675, 0.98546237, 1.0089417, 1.0223505]
W norm: 0.98667
grad norms: [0.0012491274, 0.0078579858, 0.020904021, 0.022869289, 0.0048355241]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.735985526966
tst_shape: (30, 30)
tst_pe: 0.600806566257
================================================================================
..
At iterate   20    f=  6.40424D-03    |proj g|=  9.60622D-04
........
================================================================================
#calls: 30
elapsed: 78.1020109653
fb norms: [0.99875283, 1.0041076, 1.0695342, 1.1016914]
W norm: 1.00218
grad norms: [0.00096644217, 0.0054624011, 0.01611983, 0.017639568, 0.0033993071]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.781812141736
tst_shape: (30, 30)
tst_pe: 0.610800732612
================================================================================
..
At iterate   30    f=  4.87161D-03    |proj g|=  1.71271D-03
........
================================================================================
#calls: 40
elapsed: 103.344825029
fb norms: [1.0463628, 1.0585418, 1.2048869, 1.2727664]
W norm: 1.05131
grad norms: [0.0011829244, 0.0051552332, 0.011992333, 0.014580124, 0.0020698824]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.819687483466
tst_shape: (30, 30)
tst_pe: 0.596332660791
================================================================================
..
At iterate   40    f=  3.00020D-03    |proj g|=  1.59108D-03
........
================================================================================
#calls: 50
elapsed: 128.621965885
fb norms: [1.1427134, 1.1699367, 1.4880193, 1.6285658]
W norm: 1.15495
grad norms: [0.0010138726, 0.0074640093, 0.023169769, 0.035671305, 0.008052079]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.886417764665
tst_shape: (30, 30)
tst_pe: 0.582451191457
================================================================================
..
At iterate   50    f=  9.65508D-04    |proj g|=  1.46208D-03
.......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   60      1     0     0   0.000D+00   2.097D-04
  F =  2.09688208997249603E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.941E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.511E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.633332939896


********************************************************************************
>>> Finding a balanced patch...
bal: 0.769250780437 815 658
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60374498367
fb norms: [1.0000001, 0.99999797, 0.99999934, 1.0000005]
W norm: 1.0
grad norms: [0.0042073242, 0.13712588, 0.50734484, 0.88025045, 0.18311866]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.587641598833
tst_shape: (30, 30)
tst_pe: 0.540401090902
================================================================================

At iterate    0    f=  1.70032D-02    |proj g|=  1.18506D-01
..........
================================================================================
#calls: 10
elapsed: 27.7336518764
fb norms: [0.99977452, 0.99978554, 1.0001466, 1.000394]
W norm: 0.999735
grad norms: [0.0013122234, 0.0083421338, 0.020758744, 0.021533769, 0.003077324]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.649232978331
tst_shape: (30, 30)
tst_pe: 0.598768084238
================================================================================
..
At iterate   10    f=  9.14845D-03    |proj g|=  1.25209D-02
........
================================================================================
#calls: 20
elapsed: 52.8823800087
fb norms: [0.99252337, 0.99327588, 1.0019187, 1.0055761]
W norm: 0.993467
grad norms: [0.0010905735, 0.0064568869, 0.017642466, 0.02846176, 0.0058403555]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.698087933256
tst_shape: (30, 30)
tst_pe: 0.618036287356
================================================================================
..
At iterate   20    f=  7.51148D-03    |proj g|=  4.67691D-03
........
================================================================================
#calls: 30
elapsed: 78.0634458065
fb norms: [0.99016887, 0.99399048, 1.0374299, 1.0603051]
W norm: 0.991907
grad norms: [0.0012902525, 0.0040806453, 0.01291966, 0.017637705, 0.0027386157]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.743757253704
tst_shape: (30, 30)
tst_pe: 0.622741978218
================================================================================
..
At iterate   30    f=  5.60661D-03    |proj g|=  4.69178D-03
........
================================================================================
#calls: 40
elapsed: 103.306036949
fb norms: [1.0169026, 1.0249197, 1.119177, 1.1727722]
W norm: 1.01962
grad norms: [0.0014627285, 0.0034990441, 0.01225749, 0.01794425, 0.0042913291]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.79017371266
tst_shape: (30, 30)
tst_pe: 0.631819166221
================================================================================
..
At iterate   40    f=  4.04877D-03    |proj g|=  2.31212D-03
........
================================================================================
#calls: 50
elapsed: 128.602837801
fb norms: [1.0768179, 1.092936, 1.2824345, 1.3908474]
W norm: 1.08067
grad norms: [0.0010015699, 0.0055753351, 0.014189597, 0.019574648, 0.0040634619]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.836519803368
tst_shape: (30, 30)
tst_pe: 0.597087623145
================================================================================
..
At iterate   50    f=  2.37488D-03    |proj g|=  1.02627D-03
........
================================================================================
#calls: 60
elapsed: 153.949232817
fb norms: [1.1384367, 1.1624539, 1.4417055, 1.5990969]
W norm: 1.14416
grad norms: [0.00099636521, 0.0049097934, 0.014600344, 0.019477991, 0.005317973]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.879145205785
tst_shape: (30, 30)
tst_pe: 0.59051499884
================================================================================
..
At iterate   60    f=  8.39272D-04    |proj g|=  1.21428D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   64   67      1     0     0   0.000D+00   3.282D-04
  F =  3.28161753714084625E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 6.250E-01 seconds.
 Line search           time 1.647E+02 seconds.

 Total User time 1.691E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.63673865422


********************************************************************************
>>> Finding a balanced patch...
bal: 0.79448491155 546 191
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56413292885
fb norms: [1.0, 0.99999952, 0.99999964, 0.99999923]
W norm: 1.0
grad norms: [0.0040164404, 0.097755775, 0.41211671, 0.6129725, 0.13989173]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.564457223243
tst_shape: (30, 30)
tst_pe: 0.537209570094
================================================================================

At iterate    0    f=  1.36867D-02    |proj g|=  8.47792D-02
..........
================================================================================
#calls: 10
elapsed: 27.7277188301
fb norms: [0.99841577, 0.99845415, 0.99889153, 0.99914342]
W norm: 0.998597
grad norms: [0.0015172692, 0.011634253, 0.031956911, 0.041136164, 0.0083525945]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.629924574051
tst_shape: (30, 30)
tst_pe: 0.590540354004
================================================================================
..
At iterate   10    f=  8.69964D-03    |proj g|=  8.82039D-03
........
================================================================================
#calls: 20
elapsed: 52.8522357941
fb norms: [0.9818092, 0.98424345, 0.99834228, 1.0081993]
W norm: 0.983117
grad norms: [0.00043209412, 0.0047774254, 0.018330835, 0.030632447, 0.0071203522]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.713798503994
tst_shape: (30, 30)
tst_pe: 0.62866805682
================================================================================
..
At iterate   20    f=  6.62957D-03    |proj g|=  1.12295D-03
........
================================================================================
#calls: 30
elapsed: 78.0417649746
fb norms: [1.0140524, 1.0237511, 1.0999726, 1.15994]
W norm: 1.01575
grad norms: [0.0021980631, 0.0082762409, 0.039304014, 0.07452517, 0.018252248]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.776688669622
tst_shape: (30, 30)
tst_pe: 0.611374465691
================================================================================
..
At iterate   30    f=  4.66109D-03    |proj g|=  2.06356D-03
........
================================================================================
#calls: 40
elapsed: 103.298409939
fb norms: [1.0738072, 1.0902669, 1.240414, 1.352152]
W norm: 1.07613
grad norms: [0.00080483709, 0.0079276413, 0.032579634, 0.053789772, 0.012397819]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.818674862181
tst_shape: (30, 30)
tst_pe: 0.608649431956
================================================================================
..
At iterate   40    f=  2.98298D-03    |proj g|=  1.88503D-03
........
================================================================================
#calls: 50
elapsed: 128.541379929
fb norms: [1.1638716, 1.1904501, 1.4563942, 1.6408787]
W norm: 1.16787
grad norms: [0.00062516436, 0.0027449594, 0.010490298, 0.014257038, 0.0028862529]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.874845463016
tst_shape: (30, 30)
tst_pe: 0.604119720312
================================================================================
..
At iterate   50    f=  9.36488D-04    |proj g|=  9.95359D-04
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   2.009D-04
  F =  2.00886323000304401E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 4.805E-01 seconds.
 Line search           time 1.444E+02 seconds.

 Total User time 1.485E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.638346519458


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775494276795 16 157
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61266303062
fb norms: [1.0000001, 0.99999905, 0.99999899, 0.99999893]
W norm: 1.0
grad norms: [0.0013596386, 0.048525915, 0.24937591, 0.43550661, 0.096721537]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.543194561216
tst_shape: (30, 30)
tst_pe: 0.554217883778
================================================================================

At iterate    0    f=  1.31411D-02    |proj g|=  6.58863D-02
..........
================================================================================
#calls: 10
elapsed: 27.7613899708
fb norms: [0.9975189, 0.99772191, 0.99956024, 1.0018859]
W norm: 0.999407
grad norms: [0.0014167251, 0.0062542269, 0.019353986, 0.026681989, 0.0048285471]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.647993546363
tst_shape: (30, 30)
tst_pe: 0.61909985282
================================================================================
...
At iterate   10    f=  8.05399D-03    |proj g|=  1.41477D-03
.......
================================================================================
#calls: 20
elapsed: 52.9663829803
fb norms: [0.99278611, 0.99669105, 1.0371668, 1.0719961]
W norm: 0.998736
grad norms: [0.0011018917, 0.0057574902, 0.012441271, 0.015153161, 0.0024477493]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.737958102368
tst_shape: (30, 30)
tst_pe: 0.617651123644
================================================================================
...
At iterate   20    f=  5.54881D-03    |proj g|=  1.14612D-03
.......
================================================================================
#calls: 30
elapsed: 78.1254880428
fb norms: [1.044594, 1.055768, 1.1701189, 1.2560239]
W norm: 1.05021
grad norms: [0.0010887734, 0.0030967107, 0.0097478759, 0.011515222, 0.0015166891]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.806009588811
tst_shape: (30, 30)
tst_pe: 0.615309135661
================================================================================
...
At iterate   30    f=  3.14588D-03    |proj g|=  9.59180D-04
.......
================================================================================
#calls: 40
elapsed: 103.393432856
fb norms: [1.1436709, 1.1701536, 1.4342159, 1.5999064]
W norm: 1.1527
grad norms: [0.0011781894, 0.0042793849, 0.012417261, 0.015037769, 0.0034322534]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.868202357869
tst_shape: (30, 30)
tst_pe: 0.608766926349
================================================================================
...
At iterate   40    f=  1.28326D-03    |proj g|=  1.63828D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   46   50      1     0     0   0.000D+00   3.323D-04
  F =  3.32258641719818115E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.145E-01 seconds.
 Line search           time 1.218E+02 seconds.

 Total User time 1.258E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.646862145571


********************************************************************************
>>> Finding a balanced patch...
bal: 0.781997918835 517 98
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62342596054
fb norms: [1.0000001, 1.0000008, 0.99999958, 0.9999997]
W norm: 1.0
grad norms: [0.0019898398, 0.080124587, 0.33888367, 0.53767467, 0.13623294]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.589806010673
tst_shape: (30, 30)
tst_pe: 0.563544686459
================================================================================

At iterate    0    f=  1.39211D-02    |proj g|=  9.08972D-02
..........
================================================================================
#calls: 10
elapsed: 27.7928910255
fb norms: [0.99927235, 0.99933511, 1.0000871, 1.0008088]
W norm: 0.999774
grad norms: [0.0012675293, 0.004176138, 0.015062796, 0.020371839, 0.002756536]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.669249623111
tst_shape: (30, 30)
tst_pe: 0.613006860173
================================================================================
..
At iterate   10    f=  8.19136D-03    |proj g|=  5.17484D-03
........
================================================================================
#calls: 20
elapsed: 52.9521598816
fb norms: [0.98474872, 0.98725504, 1.0145986, 1.0322782]
W norm: 0.987108
grad norms: [0.00057496794, 0.004630412, 0.0098571479, 0.01580438, 0.0029141575]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.732862827079
tst_shape: (30, 30)
tst_pe: 0.605050680681
================================================================================
..
At iterate   20    f=  5.61512D-03    |proj g|=  1.12215D-02
........
================================================================================
#calls: 30
elapsed: 78.1543700695
fb norms: [1.0202109, 1.0291262, 1.1494397, 1.2211982]
W norm: 1.02154
grad norms: [0.00076165883, 0.0039729155, 0.0093163792, 0.013177106, 0.0013927975]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.802377246684
tst_shape: (30, 30)
tst_pe: 0.603254250504
================================================================================
..
At iterate   30    f=  3.54027D-03    |proj g|=  4.09403D-03
........
================================================================================
#calls: 40
elapsed: 103.394687891
fb norms: [1.0746036, 1.0918659, 1.3183374, 1.4460641]
W norm: 1.07695
grad norms: [0.00077138166, 0.0041381759, 0.01033938, 0.013942455, 0.0022459766]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.844981645153
tst_shape: (30, 30)
tst_pe: 0.591174281148
================================================================================
..
At iterate   40    f=  2.24547D-03    |proj g|=  9.82865D-04
........
================================================================================
#calls: 50
elapsed: 128.656214952
fb norms: [1.164571, 1.1942755, 1.5658915, 1.7617588]
W norm: 1.17029
grad norms: [0.00055197586, 0.0041066222, 0.0088180546, 0.011578505, 0.001446805]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.905380098878
tst_shape: (30, 30)
tst_pe: 0.591216120137
================================================================================
..
At iterate   50    f=  6.59049D-04    |proj g|=  9.11729D-04
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   1.613D-04
  F =  1.61293515702709556E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.844E-01 seconds.
 Line search           time 1.445E+02 seconds.

 Total User time 1.487E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.648944299656


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777315296566 1060 279
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57720899582
fb norms: [1.0000002, 1.0000011, 0.99999946, 1.0000005]
W norm: 1.0
grad norms: [0.0022829534, 0.11653212, 0.39884114, 0.6754055, 0.14559217]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.600382753234
tst_shape: (30, 30)
tst_pe: 0.546426205095
================================================================================

At iterate    0    f=  1.40861D-02    |proj g|=  9.29274D-02
..........
================================================================================
#calls: 10
elapsed: 27.6956501007
fb norms: [0.99873161, 0.99876946, 0.99935949, 1.0001308]
W norm: 0.998826
grad norms: [0.0017676142, 0.009477945, 0.027816795, 0.039846223, 0.0077086887]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.669377491755
tst_shape: (30, 30)
tst_pe: 0.595267321588
================================================================================
..
At iterate   10    f=  8.02503D-03    |proj g|=  2.94706D-03
........
================================================================================
#calls: 20
elapsed: 52.8522160053
fb norms: [0.98995239, 0.99159431, 1.0078329, 1.0195312]
W norm: 0.990669
grad norms: [0.0021881396, 0.013290955, 0.031495363, 0.043743629, 0.010198569]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.746936217852
tst_shape: (30, 30)
tst_pe: 0.629601524508
================================================================================
..
At iterate   20    f=  6.02201D-03    |proj g|=  2.20986D-03
........
================================================================================
#calls: 30
elapsed: 78.033066988
fb norms: [1.0115891, 1.0176811, 1.0820777, 1.1273917]
W norm: 1.01245
grad norms: [0.0011866343, 0.006766188, 0.012356433, 0.014152275, 0.0019673838]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.797497940074
tst_shape: (30, 30)
tst_pe: 0.634081455741
================================================================================
..
At iterate   30    f=  4.06911D-03    |proj g|=  9.38870D-04
........
================================================================================
#calls: 40
elapsed: 103.281967163
fb norms: [1.0835159, 1.098448, 1.2560824, 1.3599795]
W norm: 1.0837
grad norms: [0.0010755216, 0.0049599209, 0.01353716, 0.015303932, 0.0025232029]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.848152609515
tst_shape: (30, 30)
tst_pe: 0.626193325565
================================================================================
..
At iterate   40    f=  2.39550D-03    |proj g|=  1.10027D-03
........
================================================================================
#calls: 50
elapsed: 128.544448137
fb norms: [1.1731404, 1.2005842, 1.4868499, 1.6610339]
W norm: 1.17491
grad norms: [0.00065440108, 0.0034350681, 0.013431117, 0.015536609, 0.0025705816]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.899672122645
tst_shape: (30, 30)
tst_pe: 0.608287715101
================================================================================
..
At iterate   50    f=  7.88809D-04    |proj g|=  1.43849D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   1.663D-04
  F =  1.66274418006651103E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.902E-01 seconds.
 Line search           time 1.444E+02 seconds.

 Total User time 1.486E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.646034889976


********************************************************************************
>>> Finding a balanced patch...
bal: 0.78616024974 496 301
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62712407112
fb norms: [0.9999997, 1.0000017, 0.99999994, 1.0000001]
W norm: 1.0
grad norms: [0.00078770553, 0.062049899, 0.2366327, 0.30484307, 0.057996992]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.586575001004
tst_shape: (30, 30)
tst_pe: 0.543594820151
================================================================================

At iterate    0    f=  1.11637D-02    |proj g|=  4.43826D-02
..........
================================================================================
#calls: 10
elapsed: 27.7700529099
fb norms: [0.99647379, 0.99670666, 0.99873161, 0.99992681]
W norm: 0.998033
grad norms: [0.00094838347, 0.0060252952, 0.024264369, 0.029193802, 0.0052652629]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.670016924566
tst_shape: (30, 30)
tst_pe: 0.602077258711
================================================================================
...
At iterate   10    f=  7.62974D-03    |proj g|=  5.29400D-03
.......
================================================================================
#calls: 20
elapsed: 52.9394528866
fb norms: [0.987571, 0.99066508, 1.027215, 1.0535206]
W norm: 0.990486
grad norms: [0.00080283638, 0.0032010542, 0.013495516, 0.01996699, 0.0040906803]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.754056986055
tst_shape: (30, 30)
tst_pe: 0.609514054551
================================================================================
...
At iterate   20    f=  5.25467D-03    |proj g|=  2.32056D-03
.......
================================================================================
#calls: 30
elapsed: 78.21540308
fb norms: [1.0524827, 1.0652223, 1.226266, 1.3302026]
W norm: 1.05417
grad norms: [0.00086848257, 0.0047169928, 0.02034872, 0.027508166, 0.0066170576]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.803423760573
tst_shape: (30, 30)
tst_pe: 0.555653422308
================================================================================
...
At iterate   30    f=  3.19082D-03    |proj g|=  2.69233D-03
.......
================================================================================
#calls: 40
elapsed: 103.454880953
fb norms: [1.1261097, 1.1462671, 1.3865385, 1.5289342]
W norm: 1.1285
grad norms: [0.00078611553, 0.0041501713, 0.016937008, 0.024014737, 0.0047494294]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.856701098629
tst_shape: (30, 30)
tst_pe: 0.554838763519
================================================================================
...
At iterate   40    f=  1.45108D-03    |proj g|=  8.75013D-04
.......
================================================================================
#calls: 50
elapsed: 128.729753971
fb norms: [1.2672029, 1.3053164, 1.742663, 1.9846838]
W norm: 1.27302
grad norms: [0.00063593371, 0.0044194083, 0.011088993, 0.014667251, 0.0041617942]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.937216088665
tst_shape: (30, 30)
tst_pe: 0.555803933429
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   2.314D-04
  F =  2.31396130402572453E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.516E-01 seconds.
 Line search           time 1.278E+02 seconds.

 Total User time 1.319E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.646553961386


********************************************************************************
>>> Finding a balanced patch...
bal: 0.772632674298 98 115
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60914611816
fb norms: [1.0, 0.99999958, 1.0000002, 1.0000004]
W norm: 1.0
grad norms: [0.00057692284, 0.026103295, 0.15103807, 0.25413689, 0.056611143]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.578428144378
tst_shape: (30, 30)
tst_pe: 0.504398121723
================================================================================

At iterate    0    f=  1.12895D-02    |proj g|=  3.44337D-02
..........
================================================================================
#calls: 10
elapsed: 27.748262167
fb norms: [0.99920046, 0.99930567, 1.0002103, 1.0010043]
W norm: 0.999747
grad norms: [0.0010795592, 0.0059305099, 0.03043149, 0.048638754, 0.0077410568]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.658498079187
tst_shape: (30, 30)
tst_pe: 0.578887883574
================================================================================
..
At iterate   10    f=  8.26923D-03    |proj g|=  4.17603D-03
........
================================================================================
#calls: 20
elapsed: 52.9231979847
fb norms: [0.99317467, 0.99606144, 1.0137718, 1.0310088]
W norm: 0.996572
grad norms: [0.0014254148, 0.0048306342, 0.018818323, 0.023534363, 0.0055952971]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.740506865909
tst_shape: (30, 30)
tst_pe: 0.599082536735
================================================================================
..
At iterate   20    f=  6.21704D-03    |proj g|=  2.57523D-03
........
================================================================================
#calls: 30
elapsed: 78.1490371227
fb norms: [1.0129464, 1.0222515, 1.0956424, 1.1619465]
W norm: 1.01865
grad norms: [0.0011208991, 0.0033139137, 0.013029938, 0.015841907, 0.0023868659]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.791508428359
tst_shape: (30, 30)
tst_pe: 0.584108151415
================================================================================
..
At iterate   30    f=  3.99466D-03    |proj g|=  3.25783D-03
........
================================================================================
#calls: 40
elapsed: 103.363543034
fb norms: [1.0919291, 1.1105223, 1.2881716, 1.4216558]
W norm: 1.10005
grad norms: [0.001206786, 0.0057687657, 0.021777738, 0.034564581, 0.0080736643]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.852347686805
tst_shape: (30, 30)
tst_pe: 0.563240052986
================================================================================
..
At iterate   40    f=  2.15874D-03    |proj g|=  1.44896D-03
........
================================================================================
#calls: 50
elapsed: 128.772478104
fb norms: [1.1740372, 1.2028129, 1.5076243, 1.7097459]
W norm: 1.18541
grad norms: [0.00082066836, 0.0039324048, 0.011051562, 0.011752596, 0.0017908214]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.903928700618
tst_shape: (30, 30)
tst_pe: 0.558507339692
================================================================================
..
At iterate   50    f=  6.61024D-04    |proj g|=  8.54686D-04
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   1.848D-04
  F =  1.84782024007290602E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.453E-01 seconds.
 Line search           time 1.398E+02 seconds.

 Total User time 1.440E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.644164774301


********************************************************************************
>>> Finding a balanced patch...
bal: 0.787981269511 252 160
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58607196808
fb norms: [1.0000002, 0.99999952, 0.99999982, 1.0000005]
W norm: 1.0
grad norms: [0.0023149105, 0.086951397, 0.45965174, 0.69845271, 0.14409846]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.589191205332
tst_shape: (30, 30)
tst_pe: 0.510953575193
================================================================================

At iterate    0    f=  1.37961D-02    |proj g|=  8.98010D-02
..........
================================================================================
#calls: 10
elapsed: 27.7413320541
fb norms: [0.9990012, 0.9990288, 0.99925846, 0.99966747]
W norm: 0.99904
grad norms: [0.0017451288, 0.0047335695, 0.018368952, 0.024880346, 0.0043994701]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.655078325403
tst_shape: (30, 30)
tst_pe: 0.584652038955
================================================================================
..
At iterate   10    f=  8.55171D-03    |proj g|=  8.67657D-03
........
================================================================================
#calls: 20
elapsed: 52.9209709167
fb norms: [0.98816466, 0.98918498, 0.99913675, 1.0125911]
W norm: 0.9891
grad norms: [0.00092691375, 0.0038118332, 0.0111946, 0.014282467, 0.0018318251]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.710142676465
tst_shape: (30, 30)
tst_pe: 0.597536510104
================================================================================
..
At iterate   20    f=  6.10474D-03    |proj g|=  5.79139D-03
........
================================================================================
#calls: 30
elapsed: 78.1633090973
fb norms: [0.99900699, 1.0025651, 1.0465412, 1.0913123]
W norm: 0.998372
grad norms: [0.0012599742, 0.0035080474, 0.014700474, 0.020598799, 0.0044209915]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.767908015346
tst_shape: (30, 30)
tst_pe: 0.615510239353
================================================================================
..
At iterate   30    f=  4.45494D-03    |proj g|=  1.74617D-03
........
================================================================================
#calls: 40
elapsed: 103.431857109
fb norms: [1.0528415, 1.0642595, 1.2022352, 1.3124751]
W norm: 1.05179
grad norms: [0.0012047811, 0.0052018831, 0.011023189, 0.014163763, 0.0023098879]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.815867676259
tst_shape: (30, 30)
tst_pe: 0.596603918249
================================================================================
..
At iterate   40    f=  2.72759D-03    |proj g|=  9.85978D-04
........
================================================================================
#calls: 50
elapsed: 128.667584896
fb norms: [1.1392611, 1.1609368, 1.4081537, 1.5858463]
W norm: 1.13986
grad norms: [0.00084347959, 0.0046860701, 0.012094756, 0.013366916, 0.0026672708]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.878221439335
tst_shape: (30, 30)
tst_pe: 0.594628175837
================================================================================
..
At iterate   50    f=  9.04760D-04    |proj g|=  9.69146D-04
........
================================================================================
#calls: 60
elapsed: 154.022959948
fb norms: [1.2469547, 1.2815523, 1.66909, 1.9249663]
W norm: 1.25117
grad norms: [0.00045697569, 0.0016871907, 0.004851535, 0.0061838045, 0.00099799701]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.939948601312
tst_shape: (30, 30)
tst_pe: 0.608748056535
================================================================================
..
At iterate   60    f=  6.04646D-05    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   60   63      1     0     0   0.000D+00   6.046D-05
  F =  6.04646447754930705E-005

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.605E-01 seconds.
 Line search           time 1.553E+02 seconds.

 Total User time 1.596E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.639498025945


********************************************************************************
>>> Finding a balanced patch...
bal: 0.771592091571 322 127
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62115502357
fb norms: [0.99999994, 1.0000007, 0.99999976, 0.9999997]
W norm: 1.0
grad norms: [0.00093959324, 0.070351869, 0.28396332, 0.38476914, 0.073090255]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.590892897773
tst_shape: (30, 30)
tst_pe: 0.552888300438
================================================================================

At iterate    0    f=  1.15332D-02    |proj g|=  4.83918D-02
..........
================================================================================
#calls: 10
elapsed: 27.7371811867
fb norms: [0.99770552, 0.99780959, 0.99901539, 0.9995507]
W norm: 0.998633
grad norms: [0.0014901307, 0.0095468638, 0.032668013, 0.042851835, 0.0076632332]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.670768587568
tst_shape: (30, 30)
tst_pe: 0.607521124269
================================================================================
...
At iterate   10    f=  7.94208D-03    |proj g|=  2.03010D-03
.......
================================================================================
#calls: 20
elapsed: 52.9136521816
fb norms: [0.98091, 0.9831512, 1.0075841, 1.0242537]
W norm: 0.985099
grad norms: [0.00075160369, 0.0024706367, 0.0098402426, 0.013898153, 0.0010991318]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.745787071594
tst_shape: (30, 30)
tst_pe: 0.613651427598
================================================================================
...
At iterate   20    f=  5.86011D-03    |proj g|=  3.22353D-03
.......
================================================================================
#calls: 30
elapsed: 78.1399960518
fb norms: [1.0103647, 1.0194869, 1.1244025, 1.2011427]
W norm: 1.0171
grad norms: [0.0020723946, 0.010512926, 0.056038119, 0.061957471, 0.014013088]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.80921661208
tst_shape: (30, 30)
tst_pe: 0.582187681236
================================================================================
...
At iterate   30    f=  4.00894D-03    |proj g|=  9.11419D-04
.......
================================================================================
#calls: 40
elapsed: 103.420530081
fb norms: [1.061741, 1.0775796, 1.2580092, 1.3860661]
W norm: 1.06874
grad norms: [0.0010068899, 0.003542057, 0.012182909, 0.013832881, 0.0018601129]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.847288294417
tst_shape: (30, 30)
tst_pe: 0.565603052308
================================================================================
...
At iterate   40    f=  1.98399D-03    |proj g|=  1.79749D-03
.......
================================================================================
#calls: 50
elapsed: 128.725095987
fb norms: [1.1801379, 1.2120513, 1.5631137, 1.7947451]
W norm: 1.18873
grad norms: [0.00068482949, 0.0044567655, 0.015096623, 0.017003855, 0.0027320113]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.907790717681
tst_shape: (30, 30)
tst_pe: 0.546872203569
================================================================================
...
At iterate   50    f=  6.91795D-04    |proj g|=  1.18509D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   59      1     0     0   0.000D+00   1.805D-04
  F =  1.80477989488281310E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.727E-01 seconds.
 Line search           time 1.445E+02 seconds.

 Total User time 1.487E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.641569715608


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780957336108 792 734
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57426786423
fb norms: [0.99999988, 1.0000005, 0.99999988, 1.0]
W norm: 1.0
grad norms: [0.0010746453, 0.042092115, 0.30827543, 0.44049901, 0.088664182]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.564467379429
tst_shape: (30, 30)
tst_pe: 0.501095470868
================================================================================

At iterate    0    f=  1.23201D-02    |proj g|=  5.78636D-02
..........
================================================================================
#calls: 10
elapsed: 27.7130639553
fb norms: [0.99547726, 0.99561208, 0.9970268, 0.99923581]
W norm: 0.99727
grad norms: [0.0020774093, 0.0090667885, 0.02098557, 0.027578751, 0.0038345938]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.669106536339
tst_shape: (30, 30)
tst_pe: 0.585871182767
================================================================================
...
At iterate   10    f=  7.96010D-03    |proj g|=  2.39160D-03
.......
================================================================================
#calls: 20
elapsed: 52.8951978683
fb norms: [0.97802305, 0.98142004, 1.0061879, 1.03334]
W norm: 0.985124
grad norms: [0.00096238236, 0.0034638096, 0.011879796, 0.014768561, 0.0023737478]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.740218406805
tst_shape: (30, 30)
tst_pe: 0.603387622226
================================================================================
...
At iterate   20    f=  5.81779D-03    |proj g|=  1.10671D-03
.......
================================================================================
#calls: 30
elapsed: 78.0699088573
fb norms: [1.024819, 1.0350705, 1.1363134, 1.224483]
W norm: 1.03531
grad norms: [0.0012179399, 0.0025091979, 0.011149543, 0.014084172, 0.002110905]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.800317086983
tst_shape: (30, 30)
tst_pe: 0.572017222862
================================================================================
...
At iterate   30    f=  3.52229D-03    |proj g|=  2.24755D-03
.......
================================================================================
#calls: 40
elapsed: 103.3019979
fb norms: [1.1131791, 1.1326307, 1.3427662, 1.5034138]
W norm: 1.12514
grad norms: [0.001090124, 0.0048157866, 0.015230199, 0.018907782, 0.003197253]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.856029985386
tst_shape: (30, 30)
tst_pe: 0.553464524471
================================================================================
...
At iterate   40    f=  1.79634D-03    |proj g|=  1.34141D-03
.......
================================================================================
#calls: 50
elapsed: 128.613038778
fb norms: [1.2067418, 1.2372353, 1.5831976, 1.8250928]
W norm: 1.22305
grad norms: [0.00070097565, 0.0024657163, 0.0091154976, 0.010281129, 0.0015201228]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.908536626985
tst_shape: (30, 30)
tst_pe: 0.550955280461
================================================================================
...
At iterate   50    f=  3.99595D-04    |proj g|=  5.88094D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   3.126D-04
  F =  3.12613032292574644E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.082E-01 seconds.
 Line search           time 1.349E+02 seconds.

 Total User time 1.390E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.648095557665


********************************************************************************
>>> Finding a balanced patch...
bal: 0.779136316337 569 685
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62757086754
fb norms: [1.0, 0.99999911, 0.99999952, 1.0]
W norm: 1.0
grad norms: [0.004498139, 0.081744656, 0.44744107, 0.77067608, 0.1686915]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.57630088527
tst_shape: (30, 30)
tst_pe: 0.512920923125
================================================================================

At iterate    0    f=  1.86350D-02    |proj g|=  1.28957D-01
..........
================================================================================
#calls: 10
elapsed: 27.7396440506
fb norms: [0.99902314, 0.9990567, 0.99964893, 1.0007339]
W norm: 0.997991
grad norms: [0.00098664407, 0.0046928665, 0.014303349, 0.018702308, 0.0019359575]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.638084227134
tst_shape: (30, 30)
tst_pe: 0.581509930682
================================================================================
..
At iterate   10    f=  8.91676D-03    |proj g|=  3.28591D-03
........
================================================================================
#calls: 20
elapsed: 52.9389939308
fb norms: [0.98940313, 0.99137151, 1.0170299, 1.0415658]
W norm: 0.987386
grad norms: [0.00047684871, 0.0026559054, 0.013055088, 0.014144351, 0.0017390095]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.70481992357
tst_shape: (30, 30)
tst_pe: 0.591269270259
================================================================================
..
At iterate   20    f=  6.52676D-03    |proj g|=  3.13392D-03
........
================================================================================
#calls: 30
elapsed: 78.1381919384
fb norms: [1.0138371, 1.0191953, 1.1182406, 1.1936001]
W norm: 1.01013
grad norms: [0.0014534893, 0.0046567423, 0.011680192, 0.012875981, 0.0022265327]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.770555855011
tst_shape: (30, 30)
tst_pe: 0.593673751212
================================================================================
..
At iterate   30    f=  4.48996D-03    |proj g|=  4.23279D-03
........
================================================================================
#calls: 40
elapsed: 103.413439035
fb norms: [1.0878904, 1.100476, 1.3006094, 1.4352549]
W norm: 1.08765
grad norms: [0.0010816078, 0.0063481224, 0.022908952, 0.027398158, 0.0059380536]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.829491533499
tst_shape: (30, 30)
tst_pe: 0.591053203647
================================================================================
..
At iterate   40    f=  2.79284D-03    |proj g|=  1.59579D-03
........
================================================================================
#calls: 50
elapsed: 128.684977055
fb norms: [1.1839635, 1.2075052, 1.5367308, 1.7405306]
W norm: 1.19068
grad norms: [0.00056701031, 0.0068441653, 0.024178129, 0.029548202, 0.0070327199]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.888355130077
tst_shape: (30, 30)
tst_pe: 0.590997674954
================================================================================
..
At iterate   50    f=  1.04482D-03    |proj g|=  9.04974D-04
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   3.419D-04
  F =  3.41897160978987813E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.844E-01 seconds.
 Line search           time 1.445E+02 seconds.

 Total User time 1.487E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.657581711463


********************************************************************************
>>> Finding a balanced patch...
bal: 0.771071800208 625 287
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57531785965
fb norms: [1.0000004, 0.99999988, 1.0000005, 0.99999934]
W norm: 1.0
grad norms: [0.0049919472, 0.10219675, 0.48279554, 0.68293643, 0.16778067]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.568923198324
tst_shape: (30, 30)
tst_pe: 0.552306283522
================================================================================

At iterate    0    f=  1.80382D-02    |proj g|=  1.24829D-01
..........
================================================================================
#calls: 10
elapsed: 27.7068228722
fb norms: [0.9993847, 0.9994179, 0.9999153, 1.0005269]
W norm: 0.999135
grad norms: [0.0016799425, 0.0074013681, 0.020884618, 0.030284021, 0.0060456274]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.644175847261
tst_shape: (30, 30)
tst_pe: 0.607301527657
================================================================================
..
At iterate   10    f=  9.24422D-03    |proj g|=  1.76775D-03
........
================================================================================
#calls: 20
elapsed: 52.9202868938
fb norms: [0.98317307, 0.98678052, 1.0198214, 1.0446185]
W norm: 0.982825
grad norms: [0.00022169473, 0.0070789154, 0.030991899, 0.043747675, 0.011174511]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.735622704254
tst_shape: (30, 30)
tst_pe: 0.616542626555
================================================================================
..
At iterate   20    f=  6.77781D-03    |proj g|=  1.59120D-03
........
================================================================================
#calls: 30
elapsed: 78.1425950527
fb norms: [1.0140671, 1.024412, 1.1175911, 1.1776272]
W norm: 1.0121
grad norms: [0.0013187802, 0.0071598212, 0.024699422, 0.027283782, 0.0068104323]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.78910675948
tst_shape: (30, 30)
tst_pe: 0.608297351569
================================================================================
..
At iterate   30    f=  4.67745D-03    |proj g|=  2.08713D-03
........
================================================================================
#calls: 40
elapsed: 103.369768858
fb norms: [1.1008756, 1.124398, 1.3523887, 1.4846925]
W norm: 1.10112
grad norms: [0.00088234054, 0.0043945932, 0.014003694, 0.0155218, 0.0025673711]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.846043810968
tst_shape: (30, 30)
tst_pe: 0.590486436058
================================================================================
..
At iterate   40    f=  2.04829D-03    |proj g|=  3.08652D-03
........
================================================================================
#calls: 50
elapsed: 128.764809847
fb norms: [1.1949692, 1.2329047, 1.614596, 1.8250909]
W norm: 1.20153
grad norms: [0.00071914657, 0.0043291133, 0.011270578, 0.011735025, 0.0022935371]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.900943302485
tst_shape: (30, 30)
tst_pe: 0.577054494161
================================================================================
..
At iterate   50    f=  6.24416D-04    |proj g|=  2.14325D-03
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   54      1     0     0   0.000D+00   4.274D-04
  F =  4.27386054070666432E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.906E-01 seconds.
 Line search           time 1.327E+02 seconds.

 Total User time 1.367E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.663886102506


********************************************************************************
>>> Finding a balanced patch...
bal: 0.78459937565 662 638
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57000398636
fb norms: [1.0000001, 1.0000005, 1.0000001, 1.0]
W norm: 1.0
grad norms: [0.0042924192, 0.089338355, 0.40628511, 0.48235515, 0.12990314]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.579729447025
tst_shape: (30, 30)
tst_pe: 0.53388424522
================================================================================

At iterate    0    f=  1.45169D-02    |proj g|=  9.71023D-02
..........
================================================================================
#calls: 10
elapsed: 27.7059388161
fb norms: [1.0005012, 1.0005406, 1.0008632, 1.0012653]
W norm: 1.00059
grad norms: [0.0015920164, 0.00981226, 0.03075509, 0.033226665, 0.0090853944]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.649596974974
tst_shape: (30, 30)
tst_pe: 0.595175521556
================================================================================
..
At iterate   10    f=  8.66910D-03    |proj g|=  1.11450D-02
........
================================================================================
#calls: 20
elapsed: 52.9025738239
fb norms: [0.98967469, 0.99192804, 1.0142022, 1.0307618]
W norm: 0.993141
grad norms: [0.001617054, 0.0067497576, 0.019730758, 0.030055644, 0.0082597043]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.728732118938
tst_shape: (30, 30)
tst_pe: 0.624856958834
================================================================================
..
At iterate   20    f=  6.26508D-03    |proj g|=  1.08599D-03
........
================================================================================
#calls: 30
elapsed: 78.1256828308
fb norms: [1.0111141, 1.0171726, 1.0847752, 1.1288745]
W norm: 1.01642
grad norms: [0.001164189, 0.0026915607, 0.0101648, 0.013925372, 0.0020988723]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.789742051978
tst_shape: (30, 30)
tst_pe: 0.640825655856
================================================================================
..
At iterate   30    f=  4.31585D-03    |proj g|=  1.20917D-03
........
================================================================================
#calls: 40
elapsed: 103.399166822
fb norms: [1.091797, 1.1087704, 1.3069928, 1.4194864]
W norm: 1.09951
grad norms: [0.00088320085, 0.0071131298, 0.012726298, 0.014277483, 0.001455037]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.840835523064
tst_shape: (30, 30)
tst_pe: 0.619000667533
================================================================================
..
At iterate   40    f=  2.43573D-03    |proj g|=  1.28737D-03
........
================================================================================
#calls: 50
elapsed: 128.727368832
fb norms: [1.1696939, 1.1976587, 1.5089417, 1.6763417]
W norm: 1.17951
grad norms: [0.00057258119, 0.0035763907, 0.0096207177, 0.01156509, 0.0016538147]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.889271010978
tst_shape: (30, 30)
tst_pe: 0.623014712729
================================================================================
..
At iterate   50    f=  8.39863D-04    |proj g|=  9.21871D-04
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   2.141D-04
  F =  2.14088082429952919E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.512E-01 seconds.
 Line search           time 1.398E+02 seconds.

 Total User time 1.439E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.662167292714


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777055150884 489 784
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62203288078
fb norms: [0.99999982, 1.0000018, 1.0000002, 0.99999994]
W norm: 1.0
grad norms: [0.003773316, 0.11850943, 0.39992025, 0.78322464, 0.19028692]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.594892891951
tst_shape: (30, 30)
tst_pe: 0.569074968057
================================================================================

At iterate    0    f=  1.86174D-02    |proj g|=  1.31759D-01
..........
================================================================================
#calls: 10
elapsed: 27.7830150127
fb norms: [1.0005183, 1.0005395, 1.0007817, 1.0014251]
W norm: 1.00006
grad norms: [0.0009781752, 0.0058426601, 0.0145895, 0.022080973, 0.0034016133]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.659904241888
tst_shape: (30, 30)
tst_pe: 0.610690464819
================================================================================
...
At iterate   10    f=  8.02956D-03    |proj g|=  3.13476D-03
.......
================================================================================
#calls: 20
elapsed: 52.9724340439
fb norms: [1.001639, 1.0038906, 1.0255052, 1.0437599]
W norm: 1.00121
grad norms: [0.0015435475, 0.0091852192, 0.025409309, 0.034064125, 0.0096837375]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.736595390759
tst_shape: (30, 30)
tst_pe: 0.617252393077
================================================================================
...
At iterate   20    f=  5.97870D-03    |proj g|=  1.65889D-03
.......
================================================================================
#calls: 30
elapsed: 78.1604130268
fb norms: [1.0402647, 1.050082, 1.1527441, 1.2316022]
W norm: 1.03744
grad norms: [0.0007866337, 0.0037990722, 0.011694169, 0.014884314, 0.0019669347]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.792731913676
tst_shape: (30, 30)
tst_pe: 0.596293547526
================================================================================
...
At iterate   30    f=  4.22955D-03    |proj g|=  1.32389D-03
.......
================================================================================
#calls: 40
elapsed: 103.389004946
fb norms: [1.1325464, 1.1575379, 1.4071026, 1.5698272]
W norm: 1.1332
grad norms: [0.0018194232, 0.017197074, 0.059791256, 0.070443995, 0.019632177]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.85651979968
tst_shape: (30, 30)
tst_pe: 0.593283859263
================================================================================
...
At iterate   40    f=  2.01550D-03    |proj g|=  1.48821D-03
.......
================================================================================
#calls: 50
elapsed: 128.660650969
fb norms: [1.2069255, 1.245739, 1.6195766, 1.8456935]
W norm: 1.2099
grad norms: [0.00067741569, 0.0035629608, 0.0081392247, 0.0093899742, 0.0012819743]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.908430314584
tst_shape: (30, 30)
tst_pe: 0.593798323233
================================================================================
...
At iterate   50    f=  3.17793D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   50   54      1     0     0   0.000D+00   3.178D-04
  F =  3.17793223075568676E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.711E-01 seconds.
 Line search           time 1.326E+02 seconds.

 Total User time 1.366E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.665367805116


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777315296566 392 810
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62814903259
fb norms: [0.99999988, 0.99999851, 0.99999952, 1.0000006]
W norm: 1.0
grad norms: [0.0049727205, 0.077922665, 0.36633444, 0.49665102, 0.12177823]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.571428515052
tst_shape: (30, 30)
tst_pe: 0.545948960041
================================================================================

At iterate    0    f=  1.37360D-02    |proj g|=  8.34153D-02
..........
================================================================================
#calls: 10
elapsed: 27.7965829372
fb norms: [0.99886197, 0.99891055, 0.99945688, 0.99989903]
W norm: 0.999373
grad norms: [0.0024479751, 0.0087245731, 0.028918682, 0.043251328, 0.011195523]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.649895055689
tst_shape: (30, 30)
tst_pe: 0.597052424298
================================================================================
..
At iterate   10    f=  8.89812D-03    |proj g|=  1.13156D-02
........
================================================================================
#calls: 20
elapsed: 52.9686839581
fb norms: [0.98186141, 0.98391318, 1.0092416, 1.0256718]
W norm: 0.98519
grad norms: [0.00081111875, 0.0059502916, 0.014082897, 0.016311467, 0.0025743998]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.714674691732
tst_shape: (30, 30)
tst_pe: 0.602484386355
================================================================================
..
At iterate   20    f=  6.77726D-03    |proj g|=  4.65802D-03
........
================================================================================
#calls: 30
elapsed: 78.1676111221
fb norms: [1.0042126, 1.0111506, 1.1056932, 1.1587636]
W norm: 1.00721
grad norms: [0.0011952154, 0.0047202911, 0.012935556, 0.016510809, 0.0036417008]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.790770378667
tst_shape: (30, 30)
tst_pe: 0.604773580482
================================================================================
..
At iterate   30    f=  4.41281D-03    |proj g|=  1.39611D-03
........
================================================================================
#calls: 40
elapsed: 103.420639992
fb norms: [1.0759833, 1.0937153, 1.3172742, 1.4255484]
W norm: 1.08132
grad norms: [0.0014595129, 0.0086173117, 0.023831088, 0.045686483, 0.010801092]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.831664150411
tst_shape: (30, 30)
tst_pe: 0.566606728975
================================================================================
..
At iterate   40    f=  2.72248D-03    |proj g|=  1.69948D-03
........
================================================================================
#calls: 50
elapsed: 128.75330615
fb norms: [1.1413885, 1.169172, 1.5018911, 1.6537722]
W norm: 1.1501
grad norms: [0.00068327266, 0.005092348, 0.010484897, 0.013768988, 0.0034196824]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.880714462975
tst_shape: (30, 30)
tst_pe: 0.55892978914
================================================================================
..
At iterate   50    f=  1.23355D-03    |proj g|=  2.28361D-03
........
================================================================================
#calls: 60
elapsed: 154.070065022
fb norms: [1.2463126, 1.292673, 1.809245, 2.0322213]
W norm: 1.26161
grad norms: [0.00041442248, 0.0021996659, 0.0072061974, 0.011431085, 0.0028908509]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.944847664342
tst_shape: (30, 30)
tst_pe: 0.557346038902
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   58   61      1     0     0   0.000D+00   1.782D-04
  F =  1.78164715180173516E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.195E-01 seconds.
 Line search           time 1.505E+02 seconds.

 Total User time 1.548E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.666087476261


********************************************************************************
>>> Finding a balanced patch...
bal: 0.784339229969 175 38
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58042907715
fb norms: [0.99999994, 1.0000004, 0.99999928, 0.9999997]
W norm: 1.0
grad norms: [0.0043987986, 0.079250909, 0.40523431, 0.76356614, 0.17098333]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.571113321219
tst_shape: (30, 30)
tst_pe: 0.506040923584
================================================================================

At iterate    0    f=  1.68548D-02    |proj g|=  1.14389D-01
..........
================================================================================
#calls: 10
elapsed: 27.7393260002
fb norms: [0.99827027, 0.99829924, 0.99874443, 0.99973667]
W norm: 0.997832
grad norms: [0.0021569172, 0.0064439583, 0.018615901, 0.031138381, 0.0060252296]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.649318205904
tst_shape: (30, 30)
tst_pe: 0.587366079209
================================================================================
..
At iterate   10    f=  8.80642D-03    |proj g|=  1.02132D-02
........
================================================================================
#calls: 20
elapsed: 52.8769590855
fb norms: [0.98033512, 0.98149753, 0.99622619, 1.0153927]
W norm: 0.980111
grad norms: [0.00070625829, 0.0033934207, 0.010405682, 0.015801037, 0.0022363511]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.708222093838
tst_shape: (30, 30)
tst_pe: 0.587662583378
================================================================================
..
At iterate   20    f=  6.69004D-03    |proj g|=  1.07626D-03
........
================================================================================
#calls: 30
elapsed: 78.0828649998
fb norms: [0.99163151, 0.99647123, 1.057242, 1.1206541]
W norm: 0.98915
grad norms: [0.000747971, 0.0045714201, 0.012473773, 0.015344445, 0.0031456433]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.775411012138
tst_shape: (30, 30)
tst_pe: 0.599596717069
================================================================================
..
At iterate   30    f=  4.97759D-03    |proj g|=  2.37709D-03
........
================================================================================
#calls: 40
elapsed: 103.355745077
fb norms: [1.0520144, 1.0660747, 1.2195888, 1.3454746]
W norm: 1.04864
grad norms: [0.0012475223, 0.005046031, 0.013915109, 0.015335099, 0.0024892273]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.814456620624
tst_shape: (30, 30)
tst_pe: 0.591345991444
================================================================================
..
At iterate   40    f=  2.85420D-03    |proj g|=  1.16449D-03
........
================================================================================
#calls: 50
elapsed: 128.621194124
fb norms: [1.1299143, 1.1540684, 1.4115267, 1.5980434]
W norm: 1.12955
grad norms: [0.0006552501, 0.0096289096, 0.027009226, 0.030538088, 0.0075450968]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.872634917147
tst_shape: (30, 30)
tst_pe: 0.60410961574
================================================================================
..
At iterate   50    f=  1.24083D-03    |proj g|=  3.78837D-03
........
================================================================================
#calls: 60
elapsed: 153.990589142
fb norms: [1.2509046, 1.2927243, 1.7270192, 2.0035908]
W norm: 1.25726
grad norms: [0.00032761792, 0.0014606749, 0.0049283816, 0.0056043589, 0.0006508287]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.944105371109
tst_shape: (30, 30)
tst_pe: 0.613367924438
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   58   61      1     0     0   0.000D+00   2.184D-04
  F =  2.18406887142919004E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.215E-01 seconds.
 Line search           time 1.505E+02 seconds.

 Total User time 1.547E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.667667759806


********************************************************************************
>>> Finding a balanced patch...
bal: 0.776014568158 758 537
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61025595665
fb norms: [0.99999928, 0.99999994, 1.0000018, 1.0000012]
W norm: 1.0
grad norms: [0.00076110318, 0.07422787, 0.26969126, 0.38553536, 0.084288985]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.58230301664
tst_shape: (30, 30)
tst_pe: 0.571506856723
================================================================================

At iterate    0    f=  1.19356D-02    |proj g|=  5.41029D-02
..........
================================================================================
#calls: 10
elapsed: 27.7150950432
fb norms: [0.99273223, 0.99314624, 0.9975692, 0.99989289]
W norm: 0.99541
grad norms: [0.00080563995, 0.0047718398, 0.016545458, 0.021897061, 0.0040553221]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.680118549161
tst_shape: (30, 30)
tst_pe: 0.61232320251
================================================================================
...
At iterate   10    f=  7.52634D-03    |proj g|=  2.63878D-03
.......
================================================================================
#calls: 20
elapsed: 52.8428719044
fb norms: [0.98520797, 0.98816085, 1.0256338, 1.0476315]
W norm: 0.9909
grad norms: [0.0012397557, 0.0051695933, 0.020569142, 0.027289391, 0.0063568861]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.741693350307
tst_shape: (30, 30)
tst_pe: 0.618726017559
================================================================================
...
At iterate   20    f=  5.36113D-03    |proj g|=  1.01426D-03
.......
================================================================================
#calls: 30
elapsed: 78.0031929016
fb norms: [1.020013, 1.0291926, 1.1581802, 1.235884]
W norm: 1.02604
grad norms: [0.00064085057, 0.0046823528, 0.015726697, 0.018307736, 0.0039789076]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.797228769005
tst_shape: (30, 30)
tst_pe: 0.603879131819
================================================================================
...
At iterate   30    f=  3.57459D-03    |proj g|=  2.82839D-03
.......
================================================================================
#calls: 40
elapsed: 103.243725061
fb norms: [1.0886667, 1.1066344, 1.3616836, 1.5034821]
W norm: 1.09559
grad norms: [0.00087668811, 0.0048690345, 0.014878788, 0.016760334, 0.0022991467]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.850206357538
tst_shape: (30, 30)
tst_pe: 0.594130696935
================================================================================
...
At iterate   40    f=  1.88099D-03    |proj g|=  1.42427D-03
.......
================================================================================
#calls: 50
elapsed: 128.503942013
fb norms: [1.1855338, 1.2170889, 1.6478624, 1.8737414]
W norm: 1.19507
grad norms: [0.00052091049, 0.0039394093, 0.014144558, 0.019182963, 0.0044452921]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.911365052799
tst_shape: (30, 30)
tst_pe: 0.581647555746
================================================================================
...
At iterate   50    f=  3.78888D-04    |proj g|=  9.14570D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   3.196D-04
  F =  3.19609884172677994E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 3.906E-01 seconds.
 Line search           time 1.348E+02 seconds.

 Total User time 1.389E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.669640680293


********************************************************************************
>>> Finding a balanced patch...
bal: 0.786420395421 407 524
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56918597221
fb norms: [0.99999994, 1.0000014, 1.0000011, 0.99999952]
W norm: 1.0
grad norms: [0.0017564867, 0.064886451, 0.22085536, 0.31914008, 0.068842784]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.570622754382
tst_shape: (30, 30)
tst_pe: 0.542956764176
================================================================================

At iterate    0    f=  1.15055D-02    |proj g|=  4.86627D-02
..........
================================================================================
#calls: 10
elapsed: 27.7022590637
fb norms: [0.99976707, 0.99980664, 1.0003308, 1.001104]
W norm: 1.00019
grad norms: [0.0010332025, 0.010064052, 0.032713342, 0.044008993, 0.0081228297]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.629809656753
tst_shape: (30, 30)
tst_pe: 0.59543147802
================================================================================
...
At iterate   10    f=  8.21865D-03    |proj g|=  1.93769D-03
.......
================================================================================
#calls: 20
elapsed: 52.8536880016
fb norms: [0.98673314, 0.98829597, 1.0183221, 1.0395124]
W norm: 0.98925
grad norms: [0.00082375825, 0.006417172, 0.018031696, 0.022846088, 0.0055888616]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.715310038801
tst_shape: (30, 30)
tst_pe: 0.612896552724
================================================================================
...
At iterate   20    f=  6.38111D-03    |proj g|=  3.66907D-03
.......
================================================================================
#calls: 30
elapsed: 78.0743119717
fb norms: [1.0065541, 1.0126531, 1.1101834, 1.1657639]
W norm: 1.01052
grad norms: [0.0012230009, 0.0071361768, 0.01755907, 0.022326577, 0.0048726909]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.771943333193
tst_shape: (30, 30)
tst_pe: 0.625896420762
================================================================================
...
At iterate   30    f=  4.43963D-03    |proj g|=  1.51225D-03
.......
================================================================================
#calls: 40
elapsed: 103.328093052
fb norms: [1.0623573, 1.0761602, 1.2814575, 1.3861333]
W norm: 1.06968
grad norms: [0.0014841311, 0.006696024, 0.016250212, 0.023507543, 0.0054800422]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.826389395135
tst_shape: (30, 30)
tst_pe: 0.636006245726
================================================================================
...
At iterate   40    f=  2.42482D-03    |proj g|=  1.48156D-03
.......
================================================================================
#calls: 50
elapsed: 128.558701992
fb norms: [1.1559358, 1.1815652, 1.5461242, 1.7153041]
W norm: 1.1691
grad norms: [0.00082923722, 0.0061520478, 0.012098435, 0.012790547, 0.0016000279]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.88774620754
tst_shape: (30, 30)
tst_pe: 0.641337394005
================================================================================
...
At iterate   50    f=  6.57904D-04    |proj g|=  2.02322D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   58      1     0     0   0.000D+00   3.672D-04
  F =  3.67179891327396035E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.531E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.462E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.667803836


********************************************************************************
>>> Finding a balanced patch...
bal: 0.786420395421 902 35
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57076311111
fb norms: [1.0000002, 1.0000011, 1.0000001, 1.0]
W norm: 1.0
grad norms: [0.0033145321, 0.12221701, 0.40218034, 0.6056909, 0.14145505]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.588146385381
tst_shape: (30, 30)
tst_pe: 0.596875963029
================================================================================

At iterate    0    f=  1.46175D-02    |proj g|=  9.85662D-02
..........
================================================================================
#calls: 10
elapsed: 27.6779069901
fb norms: [0.99969447, 0.99972636, 1.0003284, 1.0009731]
W norm: 0.999752
grad norms: [0.001283246, 0.0066714627, 0.018103862, 0.021250855, 0.003425898]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.662803556003
tst_shape: (30, 30)
tst_pe: 0.631511061781
================================================================================
..
At iterate   10    f=  8.34389D-03    |proj g|=  4.58792D-03
........
================================================================================
#calls: 20
elapsed: 52.9215829372
fb norms: [0.99182552, 0.99391639, 1.0214497, 1.0388436]
W norm: 0.992185
grad norms: [0.00090093038, 0.0050199139, 0.0097606173, 0.01335418, 0.0015536913]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.752590965145
tst_shape: (30, 30)
tst_pe: 0.655645879908
================================================================================
..
At iterate   20    f=  5.67466D-03    |proj g|=  3.06552D-03
........
================================================================================
#calls: 30
elapsed: 78.1277160645
fb norms: [1.0168452, 1.0233026, 1.1053275, 1.1551251]
W norm: 1.01585
grad norms: [0.00091051921, 0.0025217717, 0.0116985, 0.017283624, 0.0030905572]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.79399066422
tst_shape: (30, 30)
tst_pe: 0.643728736172
================================================================================
..
At iterate   30    f=  3.68498D-03    |proj g|=  2.13117D-03
........
================================================================================
#calls: 40
elapsed: 103.386837959
fb norms: [1.0951666, 1.1115022, 1.3104994, 1.4231453]
W norm: 1.09427
grad norms: [0.00075494318, 0.0025796143, 0.0114185, 0.016639333, 0.0031073133]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.854450511052
tst_shape: (30, 30)
tst_pe: 0.609790436171
================================================================================
..
At iterate   40    f=  1.86555D-03    |proj g|=  1.60877D-03
........
================================================================================
#calls: 50
elapsed: 128.639002085
fb norms: [1.2134265, 1.2444587, 1.6204754, 1.8198426]
W norm: 1.21625
grad norms: [0.00066818646, 0.0022311942, 0.0081090787, 0.0090464596, 0.0011536153]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.920266711478
tst_shape: (30, 30)
tst_pe: 0.604246124873
================================================================================
..
At iterate   50    f=  3.93135D-04    |proj g|=  1.25091D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   56      1     0     0   0.000D+00   1.301D-04
  F =  1.30132146296091378E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.277E-01 seconds.
 Line search           time 1.374E+02 seconds.

 Total User time 1.415E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.665978396009


********************************************************************************
>>> Finding a balanced patch...
bal: 0.773673257024 19 320
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57928299904
fb norms: [1.0000001, 0.99999994, 0.9999997, 1.0000004]
W norm: 1.0
grad norms: [0.0014465979, 0.066875122, 0.37838697, 0.52800858, 0.11193918]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.593254142136
tst_shape: (30, 30)
tst_pe: 0.55529947662
================================================================================

At iterate    0    f=  1.33526D-02    |proj g|=  8.10779D-02
..........
================================================================================
#calls: 10
elapsed: 27.8349070549
fb norms: [0.99850392, 0.99855173, 0.99901897, 0.99979788]
W norm: 0.998763
grad norms: [0.0016204782, 0.0040824679, 0.019313391, 0.024586771, 0.004732803]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.657572549721
tst_shape: (30, 30)
tst_pe: 0.613079191919
================================================================================
..
At iterate   10    f=  8.77882D-03    |proj g|=  9.01683D-03
........
================================================================================
#calls: 20
elapsed: 52.9902789593
fb norms: [0.98451954, 0.98654491, 1.0048046, 1.0202352]
W norm: 0.98682
grad norms: [0.00081209041, 0.003235379, 0.010441232, 0.012372198, 0.0015186961]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.720637065325
tst_shape: (30, 30)
tst_pe: 0.611956304562
================================================================================
...
At iterate   20    f=  6.43322D-03    |proj g|=  1.26130D-03
.......
================================================================================
#calls: 30
elapsed: 78.179338932
fb norms: [1.0104933, 1.017432, 1.1006474, 1.1586778]
W norm: 1.01179
grad norms: [0.0010481512, 0.0060446803, 0.01155211, 0.013569245, 0.0017643351]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.773850292945
tst_shape: (30, 30)
tst_pe: 0.603914323691
================================================================================
...
At iterate   30    f=  4.23042D-03    |proj g|=  4.01147D-03
.......
================================================================================
#calls: 40
elapsed: 103.430003881
fb norms: [1.0993315, 1.1160703, 1.3270403, 1.4468944]
W norm: 1.10153
grad norms: [0.0013910973, 0.013769536, 0.051734466, 0.058661513, 0.014030133]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.841710535445
tst_shape: (30, 30)
tst_pe: 0.583014427398
================================================================================
...
At iterate   40    f=  2.33120D-03    |proj g|=  1.84016D-03
.......
================================================================================
#calls: 50
elapsed: 128.702771902
fb norms: [1.1979828, 1.2276324, 1.6104664, 1.8044312]
W norm: 1.20365
grad norms: [0.00068143813, 0.0033403067, 0.0087521896, 0.0092850933, 0.0013124762]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.903723258509
tst_shape: (30, 30)
tst_pe: 0.590640568216
================================================================================
...
At iterate   50    f=  6.79591D-04    |proj g|=  2.70487D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   57      1     0     0   0.000D+00   3.405D-04
  F =  3.40475759003311396E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.219E-01 seconds.
 Line search           time 1.399E+02 seconds.

 Total User time 1.440E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.665158966079


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775494276795 511 399
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61081385612
fb norms: [1.0, 0.9999994, 1.0000018, 1.0000005]
W norm: 1.0
grad norms: [0.0014599854, 0.076663464, 0.30810133, 0.4132809, 0.094041072]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.576878993817
tst_shape: (30, 30)
tst_pe: 0.534031330194
================================================================================

At iterate    0    f=  1.25000D-02    |proj g|=  6.48959D-02
..........
================================================================================
#calls: 10
elapsed: 27.7854888439
fb norms: [0.99440348, 0.99473387, 0.99903095, 1.0007483]
W norm: 0.997764
grad norms: [0.00091829238, 0.0039531831, 0.012856696, 0.018883478, 0.0024698914]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.685510774641
tst_shape: (30, 30)
tst_pe: 0.611904216513
================================================================================
...
At iterate   10    f=  7.30996D-03    |proj g|=  4.00348D-03
.......
================================================================================
#calls: 20
elapsed: 52.9403600693
fb norms: [0.98955709, 0.99322295, 1.0370392, 1.0520909]
W norm: 0.99564
grad norms: [0.00037920396, 0.0051033068, 0.014114248, 0.02071231, 0.0052657719]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.762680377496
tst_shape: (30, 30)
tst_pe: 0.645317546554
================================================================================
...
At iterate   20    f=  5.33778D-03    |proj g|=  1.09580D-03
.......
================================================================================
#calls: 30
elapsed: 78.1349020004
fb norms: [1.0319487, 1.0438309, 1.1704862, 1.2139127]
W norm: 1.03866
grad norms: [0.0011100699, 0.0035393774, 0.0092465645, 0.015676819, 0.0030977814]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.804982078414
tst_shape: (30, 30)
tst_pe: 0.614451058055
================================================================================
...
At iterate   30    f=  3.44641D-03    |proj g|=  1.40674D-03
.......
================================================================================
#calls: 40
elapsed: 103.363942862
fb norms: [1.1238165, 1.1491411, 1.4273849, 1.5251684]
W norm: 1.13367
grad norms: [0.00081361743, 0.0052047907, 0.013774712, 0.020286208, 0.0038107848]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.863326827958
tst_shape: (30, 30)
tst_pe: 0.584259225545
================================================================================
...
At iterate   40    f=  1.33286D-03    |proj g|=  1.70065D-03
.......
================================================================================
#calls: 50
elapsed: 128.642334938
fb norms: [1.2350004, 1.2771034, 1.7417754, 1.9024798]
W norm: 1.24847
grad norms: [0.00051640492, 0.0029752383, 0.0081608128, 0.0096861664, 0.0020615775]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.929224058131
tst_shape: (30, 30)
tst_pe: 0.587640282566
================================================================================
...
At iterate   50    f=  2.74984D-04    |proj g|=  7.19548D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   1.630D-04
  F =  1.62983807967975736E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.004E-01 seconds.
 Line search           time 1.349E+02 seconds.

 Total User time 1.390E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.664764138707


********************************************************************************
>>> Finding a balanced patch...
bal: 0.77627471384 971 470
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58554601669
fb norms: [0.99999988, 0.99999803, 0.99999899, 1.0000001]
W norm: 1.0
grad norms: [0.0014672381, 0.064611651, 0.2856527, 0.48410943, 0.11457793]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.587155216695
tst_shape: (30, 30)
tst_pe: 0.542526482688
================================================================================

At iterate    0    f=  1.37269D-02    |proj g|=  8.64080D-02
..........
================================================================================
#calls: 10
elapsed: 27.7069139481
fb norms: [0.99900222, 0.99906886, 0.99977732, 1.000708]
W norm: 0.999216
grad norms: [0.0018382943, 0.0061180736, 0.018717434, 0.029557036, 0.0063716355]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.654270172768
tst_shape: (30, 30)
tst_pe: 0.59838041
================================================================================
..
At iterate   10    f=  8.46397D-03    |proj g|=  1.85744D-03
........
================================================================================
#calls: 20
elapsed: 52.8912489414
fb norms: [0.98901224, 0.99330741, 1.0271497, 1.0426855]
W norm: 0.990425
grad norms: [0.0010381748, 0.0032933436, 0.0099687492, 0.01313956, 0.0023892887]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.737086031437
tst_shape: (30, 30)
tst_pe: 0.606862972531
================================================================================
..
At iterate   20    f=  6.01568D-03    |proj g|=  1.66845D-02
........
================================================================================
#calls: 30
elapsed: 78.2143008709
fb norms: [1.0386662, 1.0521644, 1.1887887, 1.2401379]
W norm: 1.04023
grad norms: [0.00082966441, 0.0048671784, 0.012584356, 0.016326951, 0.0031511365]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.798454087722
tst_shape: (30, 30)
tst_pe: 0.589012623132
================================================================================
..
At iterate   30    f=  4.18267D-03    |proj g|=  2.10603D-03
........
================================================================================
#calls: 40
elapsed: 103.438570023
fb norms: [1.1202343, 1.1452819, 1.4215068, 1.5219159]
W norm: 1.12288
grad norms: [0.00078458944, 0.0049522202, 0.016454853, 0.031347238, 0.0073840432]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.846628805186
tst_shape: (30, 30)
tst_pe: 0.54164109997
================================================================================
..
At iterate   40    f=  2.02062D-03    |proj g|=  1.33827D-03
........
================================================================================
#calls: 50
elapsed: 128.753345013
fb norms: [1.2367711, 1.2780086, 1.746731, 1.9089432]
W norm: 1.2423
grad norms: [0.00068318855, 0.0035509169, 0.0083530275, 0.010578294, 0.0017083767]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.917203745112
tst_shape: (30, 30)
tst_pe: 0.49911766545
================================================================================
..
At iterate   50    f=  3.20846D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   50   53      1     0     0   0.000D+00   3.208D-04
  F =  3.20845952956005931E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.711E-01 seconds.
 Line search           time 1.303E+02 seconds.

 Total User time 1.343E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.665967517495


********************************************************************************
>>> Finding a balanced patch...
bal: 0.792403746098 1115 833
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61583399773
fb norms: [0.99999982, 0.99999982, 1.0000002, 0.9999997]
W norm: 1.0
grad norms: [0.0012868819, 0.03220145, 0.12360959, 0.27205336, 0.064075902]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.563615781065
tst_shape: (30, 30)
tst_pe: 0.466153970865
================================================================================

At iterate    0    f=  1.12967D-02    |proj g|=  4.31800D-02
..........
================================================================================
#calls: 10
elapsed: 27.7252719402
fb norms: [1.0005935, 1.0006918, 1.0018901, 1.0035427]
W norm: 1.00268
grad norms: [0.0014398263, 0.010848727, 0.024970876, 0.047137957, 0.0089595858]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.653118852017
tst_shape: (30, 30)
tst_pe: 0.558921267607
================================================================================
..
At iterate   10    f=  7.78819D-03    |proj g|=  2.03842D-03
........
================================================================================
#calls: 20
elapsed: 52.8870909214
fb norms: [0.99557734, 0.9987579, 1.0305079, 1.0643959]
W norm: 1.00488
grad norms: [0.001426129, 0.008620969, 0.019480174, 0.029800467, 0.0083486959]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.743683984943
tst_shape: (30, 30)
tst_pe: 0.588303483315
================================================================================
..
At iterate   20    f=  5.60737D-03    |proj g|=  1.58058D-03
........
================================================================================
#calls: 30
elapsed: 78.0891420841
fb norms: [1.0328749, 1.0425177, 1.1467859, 1.2407944]
W norm: 1.04361
grad norms: [0.00089842721, 0.0034524568, 0.0096209114, 0.011982699, 0.0018093833]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.80250437893
tst_shape: (30, 30)
tst_pe: 0.584545198381
================================================================================
..
At iterate   30    f=  3.32982D-03    |proj g|=  5.33742D-03
........
================================================================================
#calls: 40
elapsed: 103.311199903
fb norms: [1.1174369, 1.1394888, 1.370084, 1.5391692]
W norm: 1.1297
grad norms: [0.0010329566, 0.005586911, 0.009574526, 0.010545311, 0.0013513175]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.858976539766
tst_shape: (30, 30)
tst_pe: 0.574171236974
================================================================================
..
At iterate   40    f=  1.35327D-03    |proj g|=  1.00998D-03
........
================================================================================
#calls: 50
elapsed: 128.557789087
fb norms: [1.2180123, 1.2552676, 1.6472607, 1.8979806]
W norm: 1.23866
grad norms: [0.00042028533, 0.0021700317, 0.0055474872, 0.006351856, 0.00088074291]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.924273750464
tst_shape: (30, 30)
tst_pe: 0.586041436928
================================================================================
..
At iterate   50    f=  1.51500D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   50   53      1     0     0   0.000D+00   1.515D-04
  F =  1.51499829371459782E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.848E-01 seconds.
 Line search           time 1.301E+02 seconds.

 Total User time 1.341E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.666966943357


********************************************************************************
>>> Finding a balanced patch...
bal: 0.782778355879 726 853
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57587885857
fb norms: [0.99999988, 0.99999946, 0.9999997, 0.99999946]
W norm: 1.0
grad norms: [0.004510304, 0.12755604, 0.47565615, 0.71055514, 0.18676002]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.582088900576
tst_shape: (30, 30)
tst_pe: 0.545278761108
================================================================================

At iterate    0    f=  1.88807D-02    |proj g|=  1.31096D-01
..........
================================================================================
#calls: 10
elapsed: 27.6608099937
fb norms: [0.99944943, 0.99948424, 0.99983817, 1.0007188]
W norm: 0.998562
grad norms: [0.0017170543, 0.0076130256, 0.022431901, 0.033323623, 0.0080703767]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.64266770766
tst_shape: (30, 30)
tst_pe: 0.584599748048
================================================================================
..
At iterate   10    f=  8.74900D-03    |proj g|=  4.72775D-03
........
================================================================================
#calls: 20
elapsed: 52.8298158646
fb norms: [0.98759627, 0.99022478, 1.012751, 1.0307169]
W norm: 0.984525
grad norms: [0.0004730105, 0.004523342, 0.014307295, 0.014530214, 0.0017825761]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.714548560227
tst_shape: (30, 30)
tst_pe: 0.591604330451
================================================================================
...
At iterate   20    f=  6.35960D-03    |proj g|=  1.00104D-03
.......
================================================================================
#calls: 30
elapsed: 78.0307629108
fb norms: [1.0114659, 1.0195496, 1.1044524, 1.1547413]
W norm: 1.00469
grad norms: [0.0014471306, 0.0059953523, 0.029285081, 0.033525404, 0.0077880048]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.776208340551
tst_shape: (30, 30)
tst_pe: 0.604943696778
================================================================================
...
At iterate   30    f=  4.59027D-03    |proj g|=  1.56183D-03
.......
================================================================================
#calls: 40
elapsed: 103.277589798
fb norms: [1.0601522, 1.0761138, 1.2679682, 1.3653418]
W norm: 1.05351
grad norms: [0.0011045887, 0.0079166414, 0.027726574, 0.034012247, 0.0076033045]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.817801491519
tst_shape: (30, 30)
tst_pe: 0.601025174165
================================================================================
...
At iterate   40    f=  2.74425D-03    |proj g|=  2.28182D-03
.......
================================================================================
#calls: 50
elapsed: 128.542147875
fb norms: [1.1648051, 1.1949158, 1.5611653, 1.7239233]
W norm: 1.16235
grad norms: [0.00080739608, 0.0045876605, 0.015466948, 0.014695925, 0.0033134692]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.882461700238
tst_shape: (30, 30)
tst_pe: 0.594917740884
================================================================================
...
At iterate   50    f=  7.80332D-04    |proj g|=  9.06948D-04
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   57      1     0     0   0.000D+00   3.192D-04
  F =  3.19231359753757715E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.375E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.664891862943


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777315296566 574 149
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61592817307
fb norms: [1.0000002, 1.0000001, 1.0000007, 0.99999982]
W norm: 1.0
grad norms: [0.0045545134, 0.013027104, 0.057484794, 0.077934898, 0.02719303]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.602662880866
tst_shape: (30, 30)
tst_pe: 0.553687049183
================================================================================

At iterate    0    f=  1.04702D-02    |proj g|=  2.43719D-02
..........
================================================================================
#calls: 10
elapsed: 27.7565591335
fb norms: [1.0005064, 1.0009023, 1.008015, 1.0112072]
W norm: 1.00362
grad norms: [0.0021472364, 0.01599933, 0.055959899, 0.066965953, 0.017742161]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.708509326161
tst_shape: (30, 30)
tst_pe: 0.606500635118
================================================================================
...
At iterate   10    f=  7.19088D-03    |proj g|=  1.74079D-03
.......
================================================================================
#calls: 20
elapsed: 52.8847839832
fb norms: [1.0001484, 1.0027981, 1.0474818, 1.0615253]
W norm: 1.00689
grad norms: [0.0012136368, 0.0051896912, 0.012994816, 0.015494316, 0.0030181475]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.763230101233
tst_shape: (30, 30)
tst_pe: 0.609890369695
================================================================================
....
At iterate   20    f=  4.90760D-03    |proj g|=  6.71776D-03
......
================================================================================
#calls: 30
elapsed: 78.1151201725
fb norms: [1.0273743, 1.0348183, 1.1481433, 1.1833972]
W norm: 1.03473
grad norms: [0.0018824129, 0.0043620816, 0.02154238, 0.031134417, 0.0084338207]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.806524557556
tst_shape: (30, 30)
tst_pe: 0.592315687141
================================================================================
....
At iterate   30    f=  3.48489D-03    |proj g|=  1.82974D-03
......
================================================================================
#calls: 40
elapsed: 103.359266043
fb norms: [1.0903133, 1.1051668, 1.3206042, 1.3932533]
W norm: 1.09754
grad norms: [0.00080568559, 0.0099560497, 0.018955478, 0.019476561, 0.0042498074]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.850876555764
tst_shape: (30, 30)
tst_pe: 0.578491184064
================================================================================
....
At iterate   40    f=  1.34905D-03    |proj g|=  1.06626D-03
......
================================================================================
#calls: 50
elapsed: 128.667427063
fb norms: [1.1911719, 1.2192725, 1.610497, 1.747503]
W norm: 1.20098
grad norms: [0.00066082296, 0.0020548848, 0.0079156263, 0.0099453712, 0.0020489173]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.913824621077
tst_shape: (30, 30)
tst_pe: 0.57822139194
================================================================================
....
At iterate   50    f=  2.22974D-04    |proj g|=  6.88471D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   56      1     0     0   0.000D+00   1.347D-04
  F =  1.34717163746245205E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.965E-01 seconds.
 Line search           time 1.373E+02 seconds.

 Total User time 1.414E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.65947856246


********************************************************************************
>>> Finding a balanced patch...
bal: 0.796566077003 569 304
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61777806282
fb norms: [1.0000001, 1.0000023, 1.0000006, 0.99999934]
W norm: 1.0
grad norms: [0.0019896692, 0.079402514, 0.32766503, 0.51983708, 0.12245738]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.515584386442
tst_shape: (30, 30)
tst_pe: 0.53358252023
================================================================================

At iterate    0    f=  1.45494D-02    |proj g|=  8.35966D-02
..........
================================================================================
#calls: 10
elapsed: 27.7534990311
fb norms: [0.99533224, 0.99541408, 0.99658585, 0.99732077]
W norm: 0.996199
grad norms: [0.0015256141, 0.0060232775, 0.021347625, 0.034270484, 0.0055581951]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.601763152239
tst_shape: (30, 30)
tst_pe: 0.586928468283
================================================================================
..
At iterate   10    f=  9.27648D-03    |proj g|=  1.02801D-02
........
================================================================================
#calls: 20
elapsed: 52.9042980671
fb norms: [0.98045754, 0.98204291, 1.0010817, 1.0113158]
W norm: 0.984641
grad norms: [0.0012645534, 0.0063386979, 0.017487841, 0.026232732, 0.0069458429]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.661928129656
tst_shape: (30, 30)
tst_pe: 0.601403136518
================================================================================
..
At iterate   20    f=  7.34672D-03    |proj g|=  3.40290D-03
........
================================================================================
#calls: 30
elapsed: 78.0804281235
fb norms: [0.99284017, 1.0000625, 1.0879759, 1.1327145]
W norm: 0.996398
grad norms: [0.00082391902, 0.0047088955, 0.010802941, 0.014650543, 0.0020338984]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.735424610676
tst_shape: (30, 30)
tst_pe: 0.614063772735
================================================================================
..
At iterate   30    f=  5.65800D-03    |proj g|=  1.13667D-03
........
================================================================================
#calls: 40
elapsed: 103.342108011
fb norms: [1.0583218, 1.078775, 1.2970607, 1.3987771]
W norm: 1.06253
grad norms: [0.00084344047, 0.0042227451, 0.011250814, 0.013834446, 0.0022259818]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.788329462585
tst_shape: (30, 30)
tst_pe: 0.593743610362
================================================================================
..
At iterate   40    f=  3.07324D-03    |proj g|=  4.90229D-03
........
================================================================================
#calls: 50
elapsed: 128.620542049
fb norms: [1.1729164, 1.2125608, 1.601355, 1.7735016]
W norm: 1.18167
grad norms: [0.00057057652, 0.0095061529, 0.015982436, 0.02145456, 0.0053612636]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.875183833897
tst_shape: (30, 30)
tst_pe: 0.598025439541
================================================================================
..
At iterate   50    f=  1.07088D-03    |proj g|=  1.85796D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   56      1     0     0   0.000D+00   5.788D-04
  F =  5.78795385081321001E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.238E-01 seconds.
 Line search           time 1.373E+02 seconds.

 Total User time 1.414E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.664356268962


********************************************************************************
>>> Finding a balanced patch...
bal: 0.779916753382 53 443
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62154197693
fb norms: [0.99999988, 0.9999997, 1.0000004, 0.99999988]
W norm: 1.0
grad norms: [0.0014226746, 0.047728423, 0.19882803, 0.41786429, 0.11330885]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.564448802388
tst_shape: (30, 30)
tst_pe: 0.540059373071
================================================================================

At iterate    0    f=  1.39463D-02    |proj g|=  8.90868D-02
..........
================================================================================
#calls: 10
elapsed: 27.7510490417
fb norms: [0.99836546, 0.99867183, 1.0025917, 1.0087712]
W norm: 0.99986
grad norms: [0.0012170128, 0.012397316, 0.029170005, 0.040521674, 0.011274243]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.674687666664
tst_shape: (30, 30)
tst_pe: 0.611728180165
================================================================================
...
At iterate   10    f=  7.50001D-03    |proj g|=  9.94104D-03
.......
================================================================================
#calls: 20
elapsed: 52.9460330009
fb norms: [1.0019915, 1.0058059, 1.0527614, 1.0911355]
W norm: 1.00257
grad norms: [0.0008738474, 0.0046193963, 0.012014244, 0.012792657, 0.0018529479]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.747570094135
tst_shape: (30, 30)
tst_pe: 0.611066903735
================================================================================
...
At iterate   20    f=  5.47804D-03    |proj g|=  1.86271D-03
.......
================================================================================
#calls: 30
elapsed: 78.1598329544
fb norms: [1.0383254, 1.0491477, 1.180707, 1.2665521]
W norm: 1.03861
grad norms: [0.0017655642, 0.010282186, 0.026642853, 0.032313529, 0.0091314381]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.79168469042
tst_shape: (30, 30)
tst_pe: 0.607587425006
================================================================================
...
At iterate   30    f=  3.61341D-03    |proj g|=  1.19920D-03
.......
================================================================================
#calls: 40
elapsed: 103.420134068
fb norms: [1.1238158, 1.1477489, 1.4316484, 1.58325]
W norm: 1.12761
grad norms: [0.00094436348, 0.0035323077, 0.011079351, 0.014251169, 0.00260755]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.847342648698
tst_shape: (30, 30)
tst_pe: 0.595422382244
================================================================================
...
At iterate   40    f=  1.41625D-03    |proj g|=  1.18586D-03
.......
================================================================================
#calls: 50
elapsed: 128.689792871
fb norms: [1.2555404, 1.2996609, 1.7987596, 2.0335815]
W norm: 1.26453
grad norms: [0.00066846563, 0.0030772486, 0.0069329515, 0.0089567276, 0.00213546]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.926193627186
tst_shape: (30, 30)
tst_pe: 0.579953479352
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   47   51      1     0     0   0.000D+00   3.779D-04
  F =  3.77943273633718491E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.398E-01 seconds.
 Line search           time 1.254E+02 seconds.

 Total User time 1.294E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.668093234238


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780176899063 263 52
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.59163808823
fb norms: [0.99999988, 1.0000021, 0.99999946, 1.0000007]
W norm: 1.0
grad norms: [0.0014484632, 0.050412878, 0.16285384, 0.31149352, 0.087335721]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.541836158763
tst_shape: (30, 30)
tst_pe: 0.513705614408
================================================================================

At iterate    0    f=  1.32028D-02    |proj g|=  7.10164D-02
..........
================================================================================
#calls: 10
elapsed: 27.7192599773
fb norms: [0.99921626, 0.99936932, 1.001633, 1.0038668]
W norm: 1.00203
grad norms: [0.00089914957, 0.0072416486, 0.017421216, 0.024264446, 0.0049445136]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.657852397569
tst_shape: (30, 30)
tst_pe: 0.588020206652
================================================================================
..
At iterate   10    f=  7.86855D-03    |proj g|=  8.14462D-03
........
================================================================================
#calls: 20
elapsed: 52.8430511951
fb norms: [0.99615169, 0.99866325, 1.0336587, 1.058382]
W norm: 1.00184
grad norms: [0.00058161595, 0.0022723426, 0.0091827195, 0.012780293, 0.001093757]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.7329707675
tst_shape: (30, 30)
tst_pe: 0.612698387378
================================================================================
...
At iterate   20    f=  5.67687D-03    |proj g|=  1.91320D-03
.......
================================================================================
#calls: 30
elapsed: 78.0383529663
fb norms: [1.0265692, 1.0351053, 1.1649643, 1.2496778]
W norm: 1.03125
grad norms: [0.001056522, 0.0061973208, 0.014496386, 0.017260732, 0.0035293561]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.788093799205
tst_shape: (30, 30)
tst_pe: 0.606243040395
================================================================================
...
At iterate   30    f=  3.59217D-03    |proj g|=  1.66773D-03
.......
================================================================================
#calls: 40
elapsed: 103.230288982
fb norms: [1.1054374, 1.1237184, 1.3860058, 1.5412917]
W norm: 1.11455
grad norms: [0.0010287791, 0.0051379423, 0.011671595, 0.01326933, 0.0020878019]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.850382117198
tst_shape: (30, 30)
tst_pe: 0.592988132994
================================================================================
...
At iterate   40    f=  1.50590D-03    |proj g|=  1.08330D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   46   50      1     0     0   0.000D+00   6.158D-04
  F =  6.15773664321750402E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.203E-01 seconds.
 Line search           time 1.217E+02 seconds.

 Total User time 1.257E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.670312318517


********************************************************************************
>>> Finding a balanced patch...
bal: 0.790842872008 1003 4
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57368707657
fb norms: [1.0000002, 1.0000017, 0.99999976, 1.0000004]
W norm: 1.0
grad norms: [0.0043118228, 0.072186261, 0.31461746, 0.44402665, 0.12561348]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.572773739018
tst_shape: (30, 30)
tst_pe: 0.546037308295
================================================================================

At iterate    0    f=  1.49556D-02    |proj g|=  1.00712D-01
..........
================================================================================
#calls: 10
elapsed: 27.7206020355
fb norms: [0.9989028, 0.99902904, 0.99989432, 1.0010179]
W norm: 0.998628
grad norms: [0.0017029938, 0.0072529283, 0.017886538, 0.026464788, 0.0064134793]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.653438323826
tst_shape: (30, 30)
tst_pe: 0.611210964539
================================================================================
..
At iterate   10    f=  8.24100D-03    |proj g|=  5.59874D-03
........
================================================================================
#calls: 20
elapsed: 52.8846700191
fb norms: [0.99139845, 0.99561715, 1.0308686, 1.0546266]
W norm: 0.992264
grad norms: [0.0008471632, 0.002695309, 0.0082714921, 0.011165062, 0.0015838695]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.742066145789
tst_shape: (30, 30)
tst_pe: 0.640693851056
================================================================================
..
At iterate   20    f=  5.69286D-03    |proj g|=  6.14996D-03
........
================================================================================
#calls: 30
elapsed: 78.1058790684
fb norms: [1.0399243, 1.0526445, 1.1762419, 1.2420723]
W norm: 1.04194
grad norms: [0.00053230737, 0.013804048, 0.039771192, 0.049044058, 0.013133701]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.79240664864
tst_shape: (30, 30)
tst_pe: 0.614503397282
================================================================================
..
At iterate   30    f=  3.96671D-03    |proj g|=  1.19303D-03
........
================================================================================
#calls: 40
elapsed: 103.329663992
fb norms: [1.1216937, 1.1465847, 1.4098073, 1.5360589]
W norm: 1.12777
grad norms: [0.0014317501, 0.0054499302, 0.015213521, 0.023888355, 0.0062664645]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.851195826133
tst_shape: (30, 30)
tst_pe: 0.607630815891
================================================================================
..
At iterate   40    f=  1.47469D-03    |proj g|=  2.51301D-03
........
================================================================================
#calls: 50
elapsed: 128.631909847
fb norms: [1.2580173, 1.3032058, 1.8052988, 2.0176229]
W norm: 1.27147
grad norms: [0.00041311482, 0.0035693713, 0.0076711187, 0.010086712, 0.0025972885]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.929362903362
tst_shape: (30, 30)
tst_pe: 0.604945741663
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   51      1     0     0   0.000D+00   3.631D-04
  F =  3.63054219633340836E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.613E-01 seconds.
 Line search           time 1.254E+02 seconds.

 Total User time 1.294E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.672827548208


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780697190427 195 773
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62326908112
fb norms: [0.99999994, 1.0000004, 0.99999934, 1.0000006]
W norm: 1.0
grad norms: [0.0046123718, 0.088083833, 0.31479999, 0.5242489, 0.15697551]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.561677513496
tst_shape: (30, 30)
tst_pe: 0.568195227159
================================================================================

At iterate    0    f=  1.78110D-02    |proj g|=  1.24432D-01
..........
================================================================================
#calls: 10
elapsed: 27.7261519432
fb norms: [1.0001765, 1.0002373, 1.0015554, 1.0029925]
W norm: 0.999756
grad norms: [0.00083472143, 0.0035631463, 0.012678329, 0.018606761, 0.0021281017]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.652425586583
tst_shape: (30, 30)
tst_pe: 0.625619890463
================================================================================
..
At iterate   10    f=  8.46210D-03    |proj g|=  4.11953D-03
........
================================================================================
#calls: 20
elapsed: 52.8701870441
fb norms: [1.0018984, 1.0052166, 1.048663, 1.0844586]
W norm: 1.00229
grad norms: [0.00147139, 0.0059618494, 0.015843745, 0.018178467, 0.0053068907]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.741123274038
tst_shape: (30, 30)
tst_pe: 0.642117424285
================================================================================
..
At iterate   20    f=  5.84235D-03    |proj g|=  5.14632D-03
........
================================================================================
#calls: 30
elapsed: 78.0662229061
fb norms: [1.0370897, 1.0456578, 1.1518929, 1.2366842]
W norm: 1.03762
grad norms: [0.00097237859, 0.0065939333, 0.010640571, 0.013522307, 0.0027854606]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.790874101489
tst_shape: (30, 30)
tst_pe: 0.616270030667
================================================================================
..
At iterate   30    f=  3.88577D-03    |proj g|=  1.47728D-03
........
================================================================================
#calls: 40
elapsed: 103.288492918
fb norms: [1.1509763, 1.1758502, 1.4570924, 1.6599158]
W norm: 1.15649
grad norms: [0.00068151328, 0.004082161, 0.010930091, 0.013196894, 0.0023991396]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.862288392208
tst_shape: (30, 30)
tst_pe: 0.605518707087
================================================================================
..
At iterate   40    f=  1.42011D-03    |proj g|=  1.40764D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   45   48      1     0     0   0.000D+00   5.461D-04
  F =  5.46054565347731113E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.047E-01 seconds.
 Line search           time 1.169E+02 seconds.

 Total User time 1.209E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.674551158834


********************************************************************************
>>> Finding a balanced patch...
bal: 0.774453694069 46 655
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61660408974
fb norms: [1.0000004, 0.99999934, 1.0000004, 1.0000006]
W norm: 1.0
grad norms: [0.0042116079, 0.050625667, 0.23929952, 0.51769012, 0.15458255]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.577256776593
tst_shape: (30, 30)
tst_pe: 0.540960731588
================================================================================

At iterate    0    f=  1.73003D-02    |proj g|=  1.22685D-01
..........
================================================================================
#calls: 10
elapsed: 27.7180800438
fb norms: [1.0003943, 1.0004965, 1.0015783, 1.0033081]
W norm: 1.00042
grad norms: [0.0016877853, 0.0065594222, 0.018179882, 0.036109123, 0.0095209489]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.6709321762
tst_shape: (30, 30)
tst_pe: 0.614737469276
================================================================================
..
At iterate   10    f=  8.13310D-03    |proj g|=  2.78049D-03
........
================================================================================
#calls: 20
elapsed: 52.8706390858
fb norms: [1.0000776, 1.0028294, 1.0564836, 1.0956303]
W norm: 1.00064
grad norms: [0.0020022073, 0.011718993, 0.026484629, 0.051409543, 0.012460931]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.740808458798
tst_shape: (30, 30)
tst_pe: 0.615458072968
================================================================================
..
At iterate   20    f=  6.04847D-03    |proj g|=  8.72044D-04
........
================================================================================
#calls: 30
elapsed: 78.0580179691
fb norms: [1.0433694, 1.0510155, 1.1852894, 1.2753489]
W norm: 1.04348
grad norms: [0.0018650491, 0.0079757189, 0.035891999, 0.057764053, 0.015635272]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.803768741526
tst_shape: (30, 30)
tst_pe: 0.616633126386
================================================================================
..
At iterate   30    f=  3.92062D-03    |proj g|=  1.12800D-03
........
================================================================================
#calls: 40
elapsed: 103.2857759
fb norms: [1.1177349, 1.1329265, 1.385301, 1.5425526]
W norm: 1.11909
grad norms: [0.0009131257, 0.0042858943, 0.012003993, 0.014555281, 0.0016075347]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.855155790735
tst_shape: (30, 30)
tst_pe: 0.579809133011
================================================================================
..
At iterate   40    f=  1.72574D-03    |proj g|=  1.63663D-03
........
================================================================================
#calls: 50
elapsed: 128.581258059
fb norms: [1.2308079, 1.2600529, 1.7074941, 1.9720911]
W norm: 1.23699
grad norms: [0.0004742544, 0.0031983992, 0.0061815046, 0.0063940063, 0.00090896391]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.924765226375
tst_shape: (30, 30)
tst_pe: 0.568851766427
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   49   52      1     0     0   0.000D+00   3.443D-04
  F =  3.44303640304133296E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 3.613E-01 seconds.
 Line search           time 1.277E+02 seconds.

 Total User time 1.317E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.673164810249


********************************************************************************
>>> Finding a balanced patch...
bal: 0.786940686785 369 105
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62785696983
fb norms: [1.0000002, 1.0000015, 0.99999982, 0.99999899]
W norm: 1.0
grad norms: [0.0014932819, 0.045058578, 0.2026256, 0.35397983, 0.092906967]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.573970444808
tst_shape: (30, 30)
tst_pe: 0.523290890312
================================================================================

At iterate    0    f=  1.22694D-02    |proj g|=  6.65054D-02
..........
================================================================================
#calls: 10
elapsed: 27.7538499832
fb norms: [0.99732625, 0.99750388, 1.0006675, 1.0047625]
W norm: 0.99881
grad norms: [0.001017887, 0.004656889, 0.013913001, 0.017513765, 0.0027118307]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.694259190241
tst_shape: (30, 30)
tst_pe: 0.604181020295
================================================================================
...
At iterate   10    f=  6.78361D-03    |proj g|=  6.52130D-03
.......
================================================================================
#calls: 20
elapsed: 52.8954849243
fb norms: [0.99189436, 0.99471915, 1.0360324, 1.0680209]
W norm: 0.998268
grad norms: [0.00062239973, 0.0034884217, 0.013984638, 0.020707663, 0.0045332806]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.765343574546
tst_shape: (30, 30)
tst_pe: 0.632724673334
================================================================================
...
At iterate   20    f=  5.10072D-03    |proj g|=  3.34011D-03
.......
================================================================================
#calls: 30
elapsed: 78.1333909035
fb norms: [1.0246476, 1.0312543, 1.1332185, 1.1967077]
W norm: 1.02928
grad norms: [0.00096714293, 0.0053950096, 0.014128737, 0.016550235, 0.0041284086]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.803816430212
tst_shape: (30, 30)
tst_pe: 0.604896394134
================================================================================
...
At iterate   30    f=  3.28629D-03    |proj g|=  1.15408D-03
.......
================================================================================
#calls: 40
elapsed: 103.389240026
fb norms: [1.1381774, 1.1554095, 1.4515251, 1.6113697]
W norm: 1.1459
grad norms: [0.00069026957, 0.0041733398, 0.017467326, 0.018890889, 0.0041282019]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.876108734261
tst_shape: (30, 30)
tst_pe: 0.566964163631
================================================================================
...
At iterate   40    f=  1.27645D-03    |proj g|=  8.74226D-04
.......
================================================================================
#calls: 50
elapsed: 128.648181915
fb norms: [1.2325444, 1.2596993, 1.7192428, 1.9532409]
W norm: 1.24441
grad norms: [0.00042910042, 0.0034390432, 0.0082106339, 0.0083155036, 0.0012797436]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.929000122675
tst_shape: (30, 30)
tst_pe: 0.555445600182
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   2.787D-04
  F =  2.78730236459523439E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.594E-01 seconds.
 Line search           time 1.277E+02 seconds.

 Total User time 1.318E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.668655738838


********************************************************************************
>>> Finding a balanced patch...
bal: 0.772892819979 658 656
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62316203117
fb norms: [1.0000006, 0.9999994, 1.0000011, 1.0]
W norm: 1.0
grad norms: [0.0024953703, 0.076783508, 0.36713117, 0.46398941, 0.11884451]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.573533503866
tst_shape: (30, 30)
tst_pe: 0.512411959266
================================================================================

At iterate    0    f=  1.50207D-02    |proj g|=  9.74868D-02
..........
================================================================================
#calls: 10
elapsed: 27.7627310753
fb norms: [0.99917018, 0.99925166, 1.0002882, 1.0009987]
W norm: 1.00006
grad norms: [0.001309904, 0.0043720244, 0.016087893, 0.018837536, 0.0024828557]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.66746565098
tst_shape: (30, 30)
tst_pe: 0.589884575198
================================================================================
..
At iterate   10    f=  8.36527D-03    |proj g|=  3.57606D-03
........
================================================================================
#calls: 20
elapsed: 52.9243359566
fb norms: [0.98943293, 0.99425745, 1.0470011, 1.0770943]
W norm: 0.995365
grad norms: [0.00056203903, 0.0053242524, 0.013021168, 0.01617384, 0.0037036033]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.752704073415
tst_shape: (30, 30)
tst_pe: 0.601833538352
================================================================================
..
At iterate   20    f=  5.78055D-03    |proj g|=  3.75481D-03
........
================================================================================
#calls: 30
elapsed: 78.1315329075
fb norms: [1.0192082, 1.0296252, 1.1365387, 1.2006346]
W norm: 1.02594
grad norms: [0.0013583126, 0.0059788339, 0.013272346, 0.019188624, 0.0040510553]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.797223386346
tst_shape: (30, 30)
tst_pe: 0.591314899892
================================================================================
..
At iterate   30    f=  4.01442D-03    |proj g|=  1.52480D-03
........
================================================================================
#calls: 40
elapsed: 103.38175106
fb norms: [1.1108005, 1.1367573, 1.4110665, 1.5696787]
W norm: 1.12653
grad norms: [0.0003526168, 0.0061865784, 0.016385881, 0.020524917, 0.003744985]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.858743895484
tst_shape: (30, 30)
tst_pe: 0.566004636942
================================================================================
..
At iterate   40    f=  1.86891D-03    |proj g|=  9.86528D-04
........
================================================================================
#calls: 50
elapsed: 128.744240046
fb norms: [1.2145841, 1.2567675, 1.7066004, 1.9513011]
W norm: 1.24224
grad norms: [0.00039323067, 0.0040842928, 0.012215155, 0.016222736, 0.0029949059]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.919563177677
tst_shape: (30, 30)
tst_pe: 0.569472004234
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   49   52      1     0     0   0.000D+00   3.622D-04
  F =  3.62183287506923079E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 3.770E-01 seconds.
 Line search           time 1.278E+02 seconds.

 Total User time 1.319E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.668517492233


********************************************************************************
>>> Finding a balanced patch...
bal: 0.779396462019 830 740
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60433793068
fb norms: [1.0000002, 0.9999994, 1.000001, 1.0000005]
W norm: 1.0
grad norms: [0.0085254321, 0.079302169, 0.43192497, 0.75994027, 0.18551232]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.586357803958
tst_shape: (30, 30)
tst_pe: 0.527114034743
================================================================================

At iterate    0    f=  2.39515D-02    |proj g|=  1.59932D-01
..........
================================================================================
#calls: 10
elapsed: 27.7337629795
fb norms: [0.99945962, 0.99951279, 1.0005767, 1.0017996]
W norm: 0.995637
grad norms: [0.00066848018, 0.0060554561, 0.017845383, 0.030036408, 0.0068964297]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.672574986767
tst_shape: (30, 30)
tst_pe: 0.611118318495
================================================================================
...
At iterate   10    f=  7.64943D-03    |proj g|=  1.34019D-02
.......
================================================================================
#calls: 20
elapsed: 52.8681349754
fb norms: [0.99445087, 0.99654835, 1.0366359, 1.0730402]
W norm: 0.981746
grad norms: [0.00069782272, 0.0082244873, 0.028064942, 0.04804812, 0.012955713]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.743268135912
tst_shape: (30, 30)
tst_pe: 0.617475390378
================================================================================
...
At iterate   20    f=  5.93501D-03    |proj g|=  4.76972D-03
.......
================================================================================
#calls: 30
elapsed: 78.0286660194
fb norms: [1.0213373, 1.0271086, 1.1182568, 1.1908668]
W norm: 1.0075
grad norms: [0.0011103593, 0.0036608505, 0.011238053, 0.014934617, 0.0021536071]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.787779365376
tst_shape: (30, 30)
tst_pe: 0.610839947923
================================================================================
...
At iterate   30    f=  3.79978D-03    |proj g|=  2.68734D-03
.......
================================================================================
#calls: 40
elapsed: 103.232651949
fb norms: [1.0956837, 1.1110408, 1.3217649, 1.4752896]
W norm: 1.08338
grad norms: [0.00093833182, 0.0034877253, 0.015196161, 0.017182585, 0.0029951651]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.837161601595
tst_shape: (30, 30)
tst_pe: 0.617954431135
================================================================================
...
At iterate   40    f=  1.90487D-03    |proj g|=  1.05659D-03
.......
================================================================================
#calls: 50
elapsed: 128.531807899
fb norms: [1.2153974, 1.2474408, 1.6630734, 1.9360185]
W norm: 1.20642
grad norms: [0.00068197021, 0.0022270423, 0.0075051761, 0.011968001, 0.0027393799]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.915563050358
tst_shape: (30, 30)
tst_pe: 0.61244360292
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   4.680D-04
  F =  4.67995007056742907E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.496E-01 seconds.
 Line search           time 1.277E+02 seconds.

 Total User time 1.317E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.669852129702


********************************************************************************
>>> Finding a balanced patch...
bal: 0.792924037461 790 1012
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61688899994
fb norms: [0.99999982, 0.99999923, 0.99999917, 1.0000005]
W norm: 1.0
grad norms: [0.0020351075, 0.028174387, 0.1645281, 0.36180434, 0.098373048]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.563193086617
tst_shape: (30, 30)
tst_pe: 0.559577265784
================================================================================

At iterate    0    f=  1.23945D-02    |proj g|=  6.90637D-02
..........
================================================================================
#calls: 10
elapsed: 27.7283341885
fb norms: [0.99424654, 0.99466401, 1.000129, 1.0050818]
W norm: 0.99547
grad norms: [0.00051948929, 0.0051728063, 0.019412268, 0.032415424, 0.0090372209]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.67327787499
tst_shape: (30, 30)
tst_pe: 0.609308674061
================================================================================
...
At iterate   10    f=  7.54679D-03    |proj g|=  1.08088D-03
.......
================================================================================
#calls: 20
elapsed: 52.9032690525
fb norms: [0.99693334, 1.000139, 1.0472494, 1.0817041]
W norm: 0.997498
grad norms: [0.000701515, 0.0061746645, 0.017681783, 0.023228209, 0.0071105086]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.732491036678
tst_shape: (30, 30)
tst_pe: 0.600015028648
================================================================================
...
At iterate   20    f=  5.43757D-03    |proj g|=  1.82235D-03
.......
================================================================================
#calls: 30
elapsed: 78.1140179634
fb norms: [1.0594776, 1.0717888, 1.2316562, 1.3339487]
W norm: 1.06154
grad norms: [0.00089670828, 0.0044888221, 0.014406048, 0.022029893, 0.0052575665]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.796589694171
tst_shape: (30, 30)
tst_pe: 0.604102521254
================================================================================
...
At iterate   30    f=  3.28569D-03    |proj g|=  5.52630D-03
.......
================================================================================
#calls: 40
elapsed: 103.32359314
fb norms: [1.1507955, 1.1751113, 1.4972388, 1.6815996]
W norm: 1.15621
grad norms: [0.00084700057, 0.0045858785, 0.020916644, 0.023987399, 0.0062250639]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.867073266003
tst_shape: (30, 30)
tst_pe: 0.578318825446
================================================================================
...
At iterate   40    f=  1.16448D-03    |proj g|=  1.15262D-03
.......
================================================================================
#calls: 50
elapsed: 128.591515064
fb norms: [1.2644876, 1.3036274, 1.8021581, 2.0685353]
W norm: 1.27468
grad norms: [0.00052538404, 0.0040905727, 0.015779689, 0.02166843, 0.0064228913]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.934743665419
tst_shape: (30, 30)
tst_pe: 0.55823815625
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   47   51      1     0     0   0.000D+00   2.623D-04
  F =  2.62254790868610144E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.359E-01 seconds.
 Line search           time 1.253E+02 seconds.

 Total User time 1.293E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.667177191977


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780176899063 1081 633
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.5850288868
fb norms: [1.0, 1.0000014, 1.0000005, 0.99999923]
W norm: 1.0
grad norms: [0.00098061271, 0.030877922, 0.2227536, 0.34898412, 0.084650636]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.57949500416
tst_shape: (30, 30)
tst_pe: 0.51083088442
================================================================================

At iterate    0    f=  1.18158D-02    |proj g|=  5.50735D-02
..........
================================================================================
#calls: 10
elapsed: 27.6949408054
fb norms: [0.99736792, 0.99750668, 1.0004835, 1.0028105]
W norm: 1.00002
grad norms: [0.00074719597, 0.0070819594, 0.021027178, 0.030983828, 0.0069746883]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.689307007283
tst_shape: (30, 30)
tst_pe: 0.608997585164
================================================================================
...
At iterate   10    f=  7.28472D-03    |proj g|=  1.08460D-02
.......
================================================================================
#calls: 20
elapsed: 52.9558389187
fb norms: [0.98918623, 0.9931097, 1.0391722, 1.0739592]
W norm: 0.998094
grad norms: [0.00074968807, 0.0033174553, 0.010734286, 0.012898019, 0.0026648107]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.759916945392
tst_shape: (30, 30)
tst_pe: 0.611911273751
================================================================================
...
At iterate   20    f=  5.10632D-03    |proj g|=  4.23921D-03
.......
================================================================================
#calls: 30
elapsed: 78.174710989
fb norms: [1.0393907, 1.0504874, 1.1796294, 1.2686337]
W norm: 1.04904
grad norms: [0.00077085121, 0.0079682106, 0.025322814, 0.030730443, 0.007714469]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.818000841316
tst_shape: (30, 30)
tst_pe: 0.59421953974
================================================================================
...
At iterate   30    f=  3.39102D-03    |proj g|=  3.69049D-03
.......
================================================================================
#calls: 40
elapsed: 103.409915924
fb norms: [1.1004072, 1.1203644, 1.3431929, 1.4914374]
W norm: 1.11162
grad norms: [0.0010526078, 0.0036332828, 0.010226907, 0.014906335, 0.0025514131]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.855982894621
tst_shape: (30, 30)
tst_pe: 0.5681891927
================================================================================
...
At iterate   40    f=  1.47638D-03    |proj g|=  3.82278D-03
.......
================================================================================
#calls: 50
elapsed: 128.67283392
fb norms: [1.1990775, 1.235419, 1.6281172, 1.8766187]
W norm: 1.21649
grad norms: [0.00068037113, 0.0034241488, 0.010824914, 0.012954126, 0.002785933]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.916229973086
tst_shape: (30, 30)
tst_pe: 0.551709930446
================================================================================
...
At iterate   50    f=  3.11746D-04    |proj g|=  8.76487D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   2.022D-04
  F =  2.02155642909929156E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.887E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.391E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.661565429333


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777575442248 95 117
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61104393005
fb norms: [1.0000002, 0.99999934, 1.0000006, 1.0000001]
W norm: 1.0
grad norms: [0.0024914085, 0.058286853, 0.47598723, 0.72014177, 0.16761187]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.589573333761
tst_shape: (30, 30)
tst_pe: 0.507707954742
================================================================================

At iterate    0    f=  1.57025D-02    |proj g|=  1.06890D-01
..........
================================================================================
#calls: 10
elapsed: 27.7497470379
fb norms: [0.99909312, 0.99912024, 0.99940056, 0.99998426]
W norm: 0.998871
grad norms: [0.001800371, 0.004854084, 0.016898688, 0.025168912, 0.0044410154]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.658910349107
tst_shape: (30, 30)
tst_pe: 0.581114627371
================================================================================
..
At iterate   10    f=  8.47948D-03    |proj g|=  4.24587D-03
........
================================================================================
#calls: 20
elapsed: 52.9114079475
fb norms: [0.98325282, 0.98504561, 1.0097903, 1.0291245]
W norm: 0.985651
grad norms: [0.00074017874, 0.0050820177, 0.010784685, 0.010237979, 0.0014568066]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.740116931522
tst_shape: (30, 30)
tst_pe: 0.607935641728
================================================================================
..
At iterate   20    f=  6.14126D-03    |proj g|=  1.50613D-03
........
================================================================================
#calls: 30
elapsed: 78.1246190071
fb norms: [0.99529028, 0.99932921, 1.0562221, 1.0980059]
W norm: 0.99774
grad norms: [0.00069976837, 0.0028540599, 0.014670576, 0.019927749, 0.0042294594]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.778487537797
tst_shape: (30, 30)
tst_pe: 0.597888475195
================================================================================
..
At iterate   30    f=  4.55201D-03    |proj g|=  1.48377D-03
........
================================================================================
#calls: 40
elapsed: 103.368146896
fb norms: [1.0652528, 1.0786433, 1.2598256, 1.3847576]
W norm: 1.06803
grad norms: [0.00099606405, 0.0050955741, 0.010486744, 0.012543267, 0.0020178757]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.836168305157
tst_shape: (30, 30)
tst_pe: 0.568992762774
================================================================================
..
At iterate   40    f=  2.45022D-03    |proj g|=  1.16336D-03
........
================================================================================
#calls: 50
elapsed: 128.658272028
fb norms: [1.1565872, 1.1813262, 1.4990135, 1.7126946]
W norm: 1.16194
grad norms: [0.00086855266, 0.0041882512, 0.020603148, 0.029606998, 0.0074093863]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.895900251992
tst_shape: (30, 30)
tst_pe: 0.575675217842
================================================================================
..
At iterate   50    f=  9.31838D-04    |proj g|=  1.02529D-03
.......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   60      1     0     0   0.000D+00   2.442D-04
  F =  2.44213297264650464E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.000E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.511E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.65514258638


********************************************************************************
>>> Finding a balanced patch...
bal: 0.775234131113 487 896
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.59776091576
fb norms: [1.0, 1.0000002, 0.99999994, 0.99999952]
W norm: 1.0
grad norms: [0.0030150991, 0.073887289, 0.41471261, 0.58771574, 0.14048342]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.598324376932
tst_shape: (30, 30)
tst_pe: 0.538444143177
================================================================================

At iterate    0    f=  1.47406D-02    |proj g|=  9.77141D-02
..........
================================================================================
#calls: 10
elapsed: 27.7372298241
fb norms: [0.99833858, 0.9983815, 0.99864519, 0.99963862]
W norm: 0.998286
grad norms: [0.0015957378, 0.0049176998, 0.015619133, 0.022542134, 0.0044873264]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.6647879497
tst_shape: (30, 30)
tst_pe: 0.605130077573
================================================================================
..
At iterate   10    f=  8.42600D-03    |proj g|=  5.15031D-03
........
================================================================================
#calls: 20
elapsed: 52.936647892
fb norms: [0.98308158, 0.98559278, 1.0056772, 1.0221121]
W norm: 0.986639
grad norms: [0.00055591407, 0.0042022173, 0.011513787, 0.019527972, 0.0042234892]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.728362266684
tst_shape: (30, 30)
tst_pe: 0.616598944246
================================================================================
..
At iterate   20    f=  6.55574D-03    |proj g|=  1.23319D-03
........
================================================================================
#calls: 30
elapsed: 78.1316838264
fb norms: [1.0030596, 1.0094025, 1.0750033, 1.1193805]
W norm: 1.00807
grad norms: [0.0011644191, 0.0036346123, 0.012652257, 0.015465495, 0.0027331214]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.780845387536
tst_shape: (30, 30)
tst_pe: 0.612576450974
================================================================================
..
At iterate   30    f=  4.92570D-03    |proj g|=  2.22863D-03
........
================================================================================
#calls: 40
elapsed: 103.340222836
fb norms: [1.0691442, 1.0829744, 1.2505429, 1.3531548]
W norm: 1.0763
grad norms: [0.0011730522, 0.0037512332, 0.013875472, 0.019408345, 0.005160654]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.826901225828
tst_shape: (30, 30)
tst_pe: 0.603606360748
================================================================================
..
At iterate   40    f=  2.84572D-03    |proj g|=  1.43086D-03
........
================================================================================
#calls: 50
elapsed: 128.646545887
fb norms: [1.1596739, 1.1832356, 1.4895757, 1.6604077]
W norm: 1.17247
grad norms: [0.00059504143, 0.0067345751, 0.02872465, 0.02898748, 0.0085253287]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.877968235151
tst_shape: (30, 30)
tst_pe: 0.585465861012
================================================================================
..
At iterate   50    f=  1.31312D-03    |proj g|=  1.40601D-03
.......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   60      1     0     0   0.000D+00   3.481D-04
  F =  3.48076020600274205E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.941E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.511E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.646145661623


********************************************************************************
>>> Finding a balanced patch...
bal: 0.785379812695 188 446
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61924219131
fb norms: [1.0000001, 0.99999988, 1.0000004, 0.99999928]
W norm: 1.0
grad norms: [0.0062567708, 0.086200066, 0.52585995, 0.7463159, 0.21072741]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.572960974894
tst_shape: (30, 30)
tst_pe: 0.521114075984
================================================================================

At iterate    0    f=  1.93333D-02    |proj g|=  1.32955D-01
..........
================================================================================
#calls: 10
elapsed: 27.7651600838
fb norms: [0.99847078, 0.99849659, 0.99894899, 0.99958313]
W norm: 0.997504
grad norms: [0.0011983016, 0.0095278993, 0.019985041, 0.019541916, 0.0024694086]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.663310222879
tst_shape: (30, 30)
tst_pe: 0.580591890621
================================================================================
...
At iterate   10    f=  7.37708D-03    |proj g|=  1.78362D-03
.......
================================================================================
#calls: 20
elapsed: 52.9168920517
fb norms: [0.98713112, 0.98981816, 1.021675, 1.0399288]
W norm: 0.984525
grad norms: [0.00050006213, 0.0043968484, 0.011760702, 0.019460049, 0.0042249039]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.755164476311
tst_shape: (30, 30)
tst_pe: 0.604452742217
================================================================================
...
At iterate   20    f=  5.39917D-03    |proj g|=  2.35408D-03
.......
================================================================================
#calls: 30
elapsed: 78.0917470455
fb norms: [1.016533, 1.027202, 1.1480691, 1.2150769]
W norm: 1.01411
grad norms: [0.00079000386, 0.005141017, 0.013792435, 0.024053849, 0.0061080065]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.805217836196
tst_shape: (30, 30)
tst_pe: 0.586202733353
================================================================================
...
At iterate   30    f=  3.88256D-03    |proj g|=  2.05392D-03
.......
================================================================================
#calls: 40
elapsed: 103.353562117
fb norms: [1.078375, 1.1000861, 1.321336, 1.4433384]
W norm: 1.08053
grad norms: [0.00072259142, 0.0038691387, 0.0096457191, 0.010772181, 0.0014161253]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.847642802177
tst_shape: (30, 30)
tst_pe: 0.578639168842
================================================================================
...
At iterate   40    f=  1.86844D-03    |proj g|=  1.14549D-03
.......
================================================================================
#calls: 50
elapsed: 128.620401144
fb norms: [1.1679287, 1.2057376, 1.5862256, 1.7853298]
W norm: 1.17901
grad norms: [0.0007922817, 0.0033061495, 0.013126054, 0.018226964, 0.0046494012]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.905405828033
tst_shape: (30, 30)
tst_pe: 0.57538134074
================================================================================
...
At iterate   50    f=  3.76777D-04    |proj g|=  3.11003D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   57      1     0     0   0.000D+00   1.910D-04
  F =  1.90971346455626190E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 4.297E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.638719739798


********************************************************************************
>>> Finding a balanced patch...
bal: 0.771852237253 789 860
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58550786972
fb norms: [1.0000004, 1.0, 0.99999869, 0.99999964]
W norm: 1.0
grad norms: [0.0063801897, 0.14201885, 0.49861428, 0.84758866, 0.20620626]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.601880619936
tst_shape: (30, 30)
tst_pe: 0.524059193685
================================================================================

At iterate    0    f=  2.18064D-02    |proj g|=  1.48705D-01
..........
================================================================================
#calls: 10
elapsed: 27.6926629543
fb norms: [0.99993861, 0.99996114, 1.0002816, 1.0005015]
W norm: 0.998854
grad norms: [0.0013495921, 0.0049670814, 0.014179104, 0.021013226, 0.0028592134]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.672663887156
tst_shape: (30, 30)
tst_pe: 0.601931709725
================================================================================
...
At iterate   10    f=  8.37435D-03    |proj g|=  3.03466D-03
.......
================================================================================
#calls: 20
elapsed: 52.8726699352
fb norms: [0.98329163, 0.98640537, 1.016052, 1.0272822]
W norm: 0.98126
grad norms: [0.0019399287, 0.011417471, 0.022159362, 0.032427128, 0.0092722289]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.744942223141
tst_shape: (30, 30)
tst_pe: 0.618090776273
================================================================================
...
At iterate   20    f=  6.41017D-03    |proj g|=  1.44223D-03
.......
================================================================================
#calls: 30
elapsed: 78.0715410709
fb norms: [1.0120208, 1.0215889, 1.1263504, 1.1669397]
W norm: 1.00922
grad norms: [0.00095444644, 0.0045904596, 0.013438296, 0.016123323, 0.0036464604]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.796193766178
tst_shape: (30, 30)
tst_pe: 0.611916280981
================================================================================
...
At iterate   30    f=  3.89716D-03    |proj g|=  4.05402D-03
.......
================================================================================
#calls: 40
elapsed: 103.285520077
fb norms: [1.0784205, 1.0989213, 1.3228805, 1.4092281]
W norm: 1.07735
grad norms: [0.00078654609, 0.0040951357, 0.0094839558, 0.011654865, 0.0014970803]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.83784875651
tst_shape: (30, 30)
tst_pe: 0.609603236892
================================================================================
...
At iterate   40    f=  2.32473D-03    |proj g|=  2.40533D-03
.......
================================================================================
#calls: 50
elapsed: 128.558171988
fb norms: [1.1717961, 1.2082372, 1.6177951, 1.7737073]
W norm: 1.17432
grad norms: [0.00037567347, 0.015330473, 0.027272601, 0.029154347, 0.0086209066]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.892343796079
tst_shape: (30, 30)
tst_pe: 0.592502150162
================================================================================
...
At iterate   50    f=  9.98203D-04    |proj g|=  1.00616D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   60      1     0     0   0.000D+00   3.338D-04
  F =  3.33755655447021127E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.824E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.510E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.640652155007


********************************************************************************
>>> Finding a balanced patch...
bal: 0.773152965661 962 75
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57175803185
fb norms: [0.99999994, 1.0000006, 1.0000007, 1.0000006]
W norm: 1.0
grad norms: [0.0035891598, 0.18046497, 0.49465916, 0.66410273, 0.1707634]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.59232173569
tst_shape: (30, 30)
tst_pe: 0.547862271297
================================================================================

At iterate    0    f=  1.70025D-02    |proj g|=  1.20718D-01
..........
================================================================================
#calls: 10
elapsed: 27.7495849133
fb norms: [1.0001847, 1.0002532, 1.0005144, 1.0011714]
W norm: 0.999592
grad norms: [0.001395343, 0.005682617, 0.022713328, 0.032453086, 0.0070989174]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.655703099431
tst_shape: (30, 30)
tst_pe: 0.615195564589
================================================================================
..
At iterate   10    f=  8.79840D-03    |proj g|=  4.86347D-03
........
================================================================================
#calls: 20
elapsed: 52.8859329224
fb norms: [0.99371183, 0.99585199, 1.02055, 1.0376351]
W norm: 0.990494
grad norms: [0.00045159392, 0.0062981434, 0.018273359, 0.020670654, 0.0048501948]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.734037328939
tst_shape: (30, 30)
tst_pe: 0.636479669079
================================================================================
..
At iterate   20    f=  6.42446D-03    |proj g|=  4.73012D-03
........
================================================================================
#calls: 30
elapsed: 78.1266880035
fb norms: [1.0143094, 1.0202565, 1.0994288, 1.141906]
W norm: 1.00927
grad norms: [0.00086593715, 0.0050310097, 0.012079197, 0.014217649, 0.0028896248]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.775446431603
tst_shape: (30, 30)
tst_pe: 0.632596286588
================================================================================
..
At iterate   30    f=  4.79280D-03    |proj g|=  1.38513D-03
........
================================================================================
#calls: 40
elapsed: 103.37261796
fb norms: [1.0999634, 1.1172165, 1.3380575, 1.4427991]
W norm: 1.09604
grad norms: [0.0012937319, 0.006027557, 0.020061575, 0.02762151, 0.0069788429]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.843082975257
tst_shape: (30, 30)
tst_pe: 0.599587510574
================================================================================
..
At iterate   40    f=  2.26612D-03    |proj g|=  3.29607D-03
........
================================================================================
#calls: 50
elapsed: 128.633137941
fb norms: [1.194734, 1.225933, 1.6151649, 1.792948]
W norm: 1.19355
grad norms: [0.00043868614, 0.0067283483, 0.017322719, 0.023124594, 0.0069910991]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.903000613216
tst_shape: (30, 30)
tst_pe: 0.598098856538
================================================================================
..
At iterate   50    f=  7.63622D-04    |proj g|=  2.18425D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   3.461D-04
  F =  3.46062239259481430E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.551E-01 seconds.
 Line search           time 1.422E+02 seconds.

 Total User time 1.463E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.646336609378


********************************************************************************
>>> Finding a balanced patch...
bal: 0.783558792924 996 696
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58729100227
fb norms: [1.0000002, 1.0000021, 1.0, 0.99999946]
W norm: 1.0
grad norms: [0.0010828715, 0.046357699, 0.18672432, 0.26967585, 0.071403123]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.592030466408
tst_shape: (30, 30)
tst_pe: 0.557065396667
================================================================================

At iterate    0    f=  1.11603D-02    |proj g|=  4.56840D-02
..........
================================================================================
#calls: 10
elapsed: 27.7245330811
fb norms: [0.99833256, 0.99839097, 0.99986362, 1.0013205]
W norm: 1.00016
grad norms: [0.00089144986, 0.014286111, 0.041815244, 0.049892697, 0.012006075]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.684028237882
tst_shape: (30, 30)
tst_pe: 0.633603051735
================================================================================
..
At iterate   10    f=  7.78076D-03    |proj g|=  5.36816D-03
........
================================================================================
#calls: 20
elapsed: 52.8734838963
fb norms: [0.98586249, 0.98792565, 1.0155181, 1.0404317]
W norm: 0.995625
grad norms: [0.0010646512, 0.004511111, 0.012670165, 0.018024707, 0.0044836979]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.754082320239
tst_shape: (30, 30)
tst_pe: 0.645131824876
================================================================================
..
At iterate   20    f=  6.04044D-03    |proj g|=  1.34084D-03
........
================================================================================
#calls: 30
elapsed: 78.1938669682
fb norms: [1.01639, 1.0237119, 1.1096531, 1.1801502]
W norm: 1.02775
grad norms: [0.0011965305, 0.0040716711, 0.014385178, 0.015756333, 0.0032677061]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.803879130238
tst_shape: (30, 30)
tst_pe: 0.628325496118
================================================================================
..
At iterate   30    f=  3.99725D-03    |proj g|=  1.77606D-03
........
================================================================================
#calls: 40
elapsed: 103.461102009
fb norms: [1.1100005, 1.1294833, 1.3421421, 1.4876764]
W norm: 1.12451
grad norms: [0.001075351, 0.0043134396, 0.016830102, 0.02810636, 0.0082975328]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.85696066009
tst_shape: (30, 30)
tst_pe: 0.60069679841
================================================================================
..
At iterate   40    f=  2.06367D-03    |proj g|=  1.39036D-03
........
================================================================================
#calls: 50
elapsed: 128.728813887
fb norms: [1.1958444, 1.2263715, 1.554934, 1.7598801]
W norm: 1.21439
grad norms: [0.00105718, 0.006166928, 0.018364327, 0.03148219, 0.0089691579]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.907636210464
tst_shape: (30, 30)
tst_pe: 0.590073194117
================================================================================
..
At iterate   50    f=  6.86707D-04    |proj g|=  1.01716D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   2.858D-04
  F =  2.85756337689235806E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.414E-01 seconds.
 Line search           time 1.398E+02 seconds.

 Total User time 1.439E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.644378083524


********************************************************************************
>>> Finding a balanced patch...
bal: 0.776534859521 219 68
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61491918564
fb norms: [1.0, 1.0000002, 1.0000011, 1.0000001]
W norm: 1.0
grad norms: [0.0038252587, 0.086090408, 0.44503036, 0.76295239, 0.19956607]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.530515671287
tst_shape: (30, 30)
tst_pe: 0.53093198287
================================================================================

At iterate    0    f=  1.98272D-02    |proj g|=  1.31751D-01
..........
================================================================================
#calls: 10
elapsed: 27.7170870304
fb norms: [0.99593872, 0.99603617, 0.99676299, 0.9981342]
W norm: 0.995369
grad norms: [0.00306157, 0.0095009161, 0.035842195, 0.050334856, 0.013983873]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.632674878847
tst_shape: (30, 30)
tst_pe: 0.606839711355
================================================================================
...
At iterate   10    f=  9.08023D-03    |proj g|=  6.49627D-03
.......
================================================================================
#calls: 20
elapsed: 52.8816549778
fb norms: [0.97366005, 0.97654206, 0.99958897, 1.0192003]
W norm: 0.971993
grad norms: [0.00079335936, 0.004541711, 0.010101005, 0.013969031, 0.0028389785]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.692441090881
tst_shape: (30, 30)
tst_pe: 0.582730394731
================================================================================
...
At iterate   20    f=  7.23884D-03    |proj g|=  8.02329D-03
.......
================================================================================
#calls: 30
elapsed: 78.1221210957
fb norms: [0.99380624, 1.0037225, 1.0964109, 1.1651694]
W norm: 0.988993
grad norms: [0.00049035985, 0.0052023362, 0.011535174, 0.014072401, 0.0018666523]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.751079773299
tst_shape: (30, 30)
tst_pe: 0.596466186122
================================================================================
...
At iterate   30    f=  5.08342D-03    |proj g|=  2.24550D-03
.......
================================================================================
#calls: 40
elapsed: 103.370419025
fb norms: [1.0646489, 1.0858129, 1.2946885, 1.428185]
W norm: 1.06066
grad norms: [0.001271336, 0.0043884655, 0.014923819, 0.02115945, 0.0056185909]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.815214355412
tst_shape: (30, 30)
tst_pe: 0.569237354046
================================================================================
...
At iterate   40    f=  3.07847D-03    |proj g|=  1.96754D-03
.......
================================================================================
#calls: 50
elapsed: 128.659013033
fb norms: [1.1641846, 1.1984693, 1.5436548, 1.7422377]
W norm: 1.16487
grad norms: [0.00088392565, 0.0040988186, 0.012715597, 0.016135996, 0.0041503152]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.880982789332
tst_shape: (30, 30)
tst_pe: 0.571027694628
================================================================================
...
At iterate   50    f=  9.14852D-04    |proj g|=  7.53851D-04
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   57      1     0     0   0.000D+00   4.700D-04
  F =  4.70011233119294047E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.297E-01 seconds.
 Line search           time 1.398E+02 seconds.

 Total User time 1.439E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.648413634577


********************************************************************************
>>> Finding a balanced patch...
bal: 0.782258064516 1008 93
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57302117348
fb norms: [1.0, 1.0000012, 0.99999958, 0.99999994]
W norm: 1.0
grad norms: [0.002658081, 0.062469002, 0.2376578, 0.39206159, 0.11274806]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.563583040001
tst_shape: (30, 30)
tst_pe: 0.521546291008
================================================================================

At iterate    0    f=  1.36119D-02    |proj g|=  8.17894D-02
..........
================================================================================
#calls: 10
elapsed: 27.718378067
fb norms: [0.99716443, 0.99782521, 1.0047624, 1.0112568]
W norm: 0.999556
grad norms: [0.0013649004, 0.009113485, 0.018058036, 0.032894406, 0.007193035]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.697222943637
tst_shape: (30, 30)
tst_pe: 0.623590058401
================================================================================
....
At iterate   10    f=  7.13101D-03    |proj g|=  2.31264D-03
......
================================================================================
#calls: 20
elapsed: 52.883713007
fb norms: [0.9972471, 1.0000106, 1.0341476, 1.0619094]
W norm: 1.00121
grad norms: [0.00065288175, 0.0033621786, 0.010757889, 0.014350271, 0.0023125242]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.753134593754
tst_shape: (30, 30)
tst_pe: 0.633728777656
================================================================================
....
At iterate   20    f=  5.38796D-03    |proj g|=  1.73645D-03
......
================================================================================
#calls: 30
elapsed: 78.1040520668
fb norms: [1.0296336, 1.0369569, 1.1325927, 1.2018174]
W norm: 1.03515
grad norms: [0.00082824862, 0.0039348216, 0.011452844, 0.01283491, 0.0022729046]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.800625786339
tst_shape: (30, 30)
tst_pe: 0.615163395869
================================================================================
....
At iterate   30    f=  3.50754D-03    |proj g|=  1.43731D-03
......
================================================================================
#calls: 40
elapsed: 103.3540411
fb norms: [1.0898665, 1.1037557, 1.2915391, 1.4077543]
W norm: 1.09812
grad norms: [0.0009865188, 0.0032115881, 0.011377882, 0.015051572, 0.0018554799]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.839975982629
tst_shape: (30, 30)
tst_pe: 0.601514177772
================================================================================
....
At iterate   40    f=  1.64804D-03    |proj g|=  1.09641D-03
......
================================================================================
#calls: 50
elapsed: 128.708220005
fb norms: [1.2025639, 1.231411, 1.6221131, 1.8353528]
W norm: 1.21831
grad norms: [0.00075829425, 0.0076833423, 0.020005606, 0.02527272, 0.0061841956]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.916100275336
tst_shape: (30, 30)
tst_pe: 0.597208566102
================================================================================
....
At iterate   50    f=  4.25933D-04    |proj g|=  7.25752D-04
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   58      1     0     0   0.000D+00   1.549D-04
  F =  1.54898269101977348E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.375E-01 seconds.
 Line search           time 1.423E+02 seconds.

 Total User time 1.463E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.651128152552


********************************************************************************
>>> Finding a balanced patch...
bal: 0.77627471384 957 1011
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57528495789
fb norms: [0.9999997, 1.0000019, 0.99999917, 1.0000004]
W norm: 1.0
grad norms: [0.004712, 0.13362812, 0.49341503, 0.72355038, 0.1631024]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.592700463058
tst_shape: (30, 30)
tst_pe: 0.545327336386
================================================================================

At iterate    0    f=  1.76011D-02    |proj g|=  1.22141D-01
..........
================================================================================
#calls: 10
elapsed: 27.7184350491
fb norms: [0.99885803, 0.99889231, 0.99926883, 0.9997682]
W norm: 0.998549
grad norms: [0.000864917, 0.0072248648, 0.024490125, 0.037304033, 0.0072789858]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.6661937837
tst_shape: (30, 30)
tst_pe: 0.614855411524
================================================================================
...
At iterate   10    f=  7.84490D-03    |proj g|=  7.68956D-03
.......
================================================================================
#calls: 20
elapsed: 52.8680329323
fb norms: [0.98896855, 0.99083239, 1.0108306, 1.031339]
W norm: 0.987477
grad norms: [0.00045626442, 0.0030620401, 0.010396716, 0.014594657, 0.0018095498]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.738160625583
tst_shape: (30, 30)
tst_pe: 0.620399230911
================================================================================
...
At iterate   20    f=  5.97626D-03    |proj g|=  1.06701D-03
.......
================================================================================
#calls: 30
elapsed: 78.0480079651
fb norms: [1.0099379, 1.0148327, 1.0754406, 1.1262994]
W norm: 1.00701
grad norms: [0.0015201888, 0.006234407, 0.017041944, 0.018296797, 0.0036611282]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.778170130367
tst_shape: (30, 30)
tst_pe: 0.622806992827
================================================================================
...
At iterate   30    f=  4.23808D-03    |proj g|=  1.96689D-03
.......
================================================================================
#calls: 40
elapsed: 103.295758963
fb norms: [1.0858153, 1.0994651, 1.2674423, 1.3901334]
W norm: 1.08607
grad norms: [0.0011330916, 0.0047765151, 0.013210304, 0.01354075, 0.0021478066]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.830270622227
tst_shape: (30, 30)
tst_pe: 0.626820012866
================================================================================
...
At iterate   40    f=  2.62547D-03    |proj g|=  1.87167D-03
.......
================================================================================
#calls: 50
elapsed: 128.572158098
fb norms: [1.184351, 1.2110988, 1.5358455, 1.7485149]
W norm: 1.19152
grad norms: [0.00060290715, 0.0033288272, 0.0096032759, 0.010749698, 0.001230409]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.890728634995
tst_shape: (30, 30)
tst_pe: 0.628218061529
================================================================================
...
At iterate   50    f=  7.31619D-04    |proj g|=  1.63753D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   58      1     0     0   0.000D+00   3.123D-04
  F =  3.12327116262167692E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.453E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.462E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.650321964084


********************************************************************************
>>> Finding a balanced patch...
bal: 0.785119667014 911 217
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57255411148
fb norms: [0.99999994, 1.0000001, 1.0000005, 0.99999982]
W norm: 1.0
grad norms: [0.0038954236, 0.076383099, 0.36367488, 0.56374228, 0.14504692]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.576133213102
tst_shape: (30, 30)
tst_pe: 0.581315471958
================================================================================

At iterate    0    f=  1.51601D-02    |proj g|=  1.01702D-01
..........
================================================================================
#calls: 10
elapsed: 27.7167761326
fb norms: [0.99889171, 0.99892819, 0.99930215, 1.0002759]
W norm: 0.998708
grad norms: [0.0014383775, 0.0034393631, 0.014903031, 0.024108119, 0.0052391337]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.64917417298
tst_shape: (30, 30)
tst_pe: 0.626405635095
================================================================================
..
At iterate   10    f=  8.54078D-03    |proj g|=  1.13576D-02
........
================================================================================
#calls: 20
elapsed: 52.901309967
fb norms: [0.98757523, 0.98852569, 1.0033368, 1.0168489]
W norm: 0.990334
grad norms: [0.0006535789, 0.0041586547, 0.01214716, 0.016229521, 0.0027756428]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.709284622497
tst_shape: (30, 30)
tst_pe: 0.626997810724
================================================================================
...
At iterate   20    f=  6.60455D-03    |proj g|=  2.85929D-03
.......
================================================================================
#calls: 30
elapsed: 78.1053631306
fb norms: [0.99814552, 1.0030628, 1.0715564, 1.1166559]
W norm: 1.00131
grad norms: [0.00098212052, 0.009813671, 0.014902614, 0.014115502, 0.0019544638]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.766197651779
tst_shape: (30, 30)
tst_pe: 0.622107055708
================================================================================
...
At iterate   30    f=  4.86275D-03    |proj g|=  3.50491D-03
.......
================================================================================
#calls: 40
elapsed: 103.325658083
fb norms: [1.0431421, 1.0544099, 1.209294, 1.3030295]
W norm: 1.04392
grad norms: [0.0011316176, 0.0039066686, 0.011343639, 0.014204721, 0.0029637695]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.813835620223
tst_shape: (30, 30)
tst_pe: 0.593050107712
================================================================================
...
At iterate   40    f=  2.78960D-03    |proj g|=  5.95050D-03
.......
================================================================================
#calls: 50
elapsed: 128.572525024
fb norms: [1.1330763, 1.1557202, 1.4352628, 1.6022568]
W norm: 1.13439
grad norms: [0.00078484183, 0.0039765285, 0.010036359, 0.012528807, 0.0028814364]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.87169057755
tst_shape: (30, 30)
tst_pe: 0.587020199786
================================================================================
...
At iterate   50    f=  8.23939D-04    |proj g|=  1.76952D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   60      1     0     0   0.000D+00   3.019D-04
  F =  3.01941559882834554E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 4.824E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.510E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.650353663548


********************************************************************************
>>> Finding a balanced patch...
bal: 0.783558792924 550 611
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57815384865
fb norms: [0.99999964, 1.0000012, 0.99999964, 0.99999988]
W norm: 1.0
grad norms: [0.00071414787, 0.043517787, 0.16979583, 0.33654261, 0.081962593]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.572881111701
tst_shape: (30, 30)
tst_pe: 0.529344497655
================================================================================

At iterate    0    f=  1.16995D-02    |proj g|=  5.11183D-02
..........
================================================================================
#calls: 10
elapsed: 27.7058570385
fb norms: [0.9949047, 0.99512905, 0.99807549, 1.0007194]
W norm: 0.996936
grad norms: [0.00045762153, 0.0033530151, 0.013533895, 0.024129774, 0.0039613992]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.66531572751
tst_shape: (30, 30)
tst_pe: 0.608545382811
================================================================================
...
At iterate   10    f=  7.78293D-03    |proj g|=  3.88250D-03
.......
================================================================================
#calls: 20
elapsed: 52.8504309654
fb norms: [0.99000937, 0.99385816, 1.0315597, 1.0605294]
W norm: 0.997972
grad norms: [0.0011568943, 0.0048441868, 0.013100632, 0.014776077, 0.0032188932]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.738645697438
tst_shape: (30, 30)
tst_pe: 0.616160888668
================================================================================
...
At iterate   20    f=  5.65925D-03    |proj g|=  1.82760D-03
.......
================================================================================
#calls: 30
elapsed: 78.0226349831
fb norms: [1.0427221, 1.0551496, 1.1913838, 1.2819449]
W norm: 1.04818
grad norms: [0.00063820358, 0.011570582, 0.042319454, 0.06302911, 0.017417358]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.804725875292
tst_shape: (30, 30)
tst_pe: 0.59894564472
================================================================================
...
At iterate   30    f=  3.56668D-03    |proj g|=  1.37093D-03
.......
================================================================================
#calls: 40
elapsed: 103.261268854
fb norms: [1.1053779, 1.125544, 1.3533994, 1.4924766]
W norm: 1.11092
grad norms: [0.001019739, 0.0062479242, 0.02307765, 0.027570929, 0.0074479617]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.852476398022
tst_shape: (30, 30)
tst_pe: 0.577450744846
================================================================================
...
At iterate   40    f=  1.58743D-03    |proj g|=  1.35569D-03
.......
================================================================================
#calls: 50
elapsed: 128.556702852
fb norms: [1.2225397, 1.2610276, 1.6887898, 1.9252589]
W norm: 1.23132
grad norms: [0.00063419068, 0.0027893861, 0.0061627771, 0.0075056371, 0.0011515727]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.923393255508
tst_shape: (30, 30)
tst_pe: 0.570453124227
================================================================================
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   49   53      1     0     0   0.000D+00   2.128D-04
  F =  2.12844679481349885E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.691E-01 seconds.
 Line search           time 1.301E+02 seconds.

 Total User time 1.341E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.645110728035


********************************************************************************
>>> Finding a balanced patch...
bal: 0.768470343392 253 733
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61228680611
fb norms: [0.99999988, 0.99999982, 1.0000005, 0.99999893]
W norm: 1.0
grad norms: [0.0010731358, 0.057433892, 0.2930049, 0.47888523, 0.11231927]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.601720340495
tst_shape: (30, 30)
tst_pe: 0.528329297566
================================================================================

At iterate    0    f=  1.30259D-02    |proj g|=  7.82161D-02
..........
================================================================================
#calls: 10
elapsed: 27.7761719227
fb norms: [0.99893296, 0.99901402, 0.99976879, 1.000826]
W norm: 0.999979
grad norms: [0.0013392566, 0.00394774, 0.014523839, 0.024623027, 0.0039392808]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.683922095614
tst_shape: (30, 30)
tst_pe: 0.597016949789
================================================================================
...
At iterate   10    f=  7.44004D-03    |proj g|=  7.06662D-03
.......
================================================================================
#calls: 20
elapsed: 52.9393389225
fb norms: [0.99045897, 0.99336785, 1.0209694, 1.0475668]
W norm: 0.997487
grad norms: [0.00065403996, 0.0031316213, 0.0093980292, 0.013624445, 0.0023975368]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.752583259796
tst_shape: (30, 30)
tst_pe: 0.611526454087
================================================================================
...
At iterate   20    f=  5.27249D-03    |proj g|=  5.11893D-03
.......
================================================================================
#calls: 30
elapsed: 78.1541888714
fb norms: [1.0190285, 1.0269994, 1.1115934, 1.1730797]
W norm: 1.02461
grad norms: [0.00064897415, 0.0033160532, 0.013065331, 0.020150788, 0.004880467]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.806747153323
tst_shape: (30, 30)
tst_pe: 0.608901821314
================================================================================
...
At iterate   30    f=  3.63707D-03    |proj g|=  3.83979D-03
.......
================================================================================
#calls: 40
elapsed: 103.417109966
fb norms: [1.0770062, 1.0940039, 1.2817969, 1.3947755]
W norm: 1.08368
grad norms: [0.001173079, 0.005919883, 0.011866488, 0.013248298, 0.0019237298]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.850045428746
tst_shape: (30, 30)
tst_pe: 0.577228101805
================================================================================
...
At iterate   40    f=  1.79493D-03    |proj g|=  4.63676D-03
.......
================================================================================
#calls: 50
elapsed: 128.707286835
fb norms: [1.1841685, 1.2177787, 1.598955, 1.8031725]
W norm: 1.19434
grad norms: [0.00058168691, 0.0034682343, 0.0078123254, 0.0077571217, 0.00089784479]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.911505901834
tst_shape: (30, 30)
tst_pe: 0.568714114287
================================================================================
...
At iterate   50    f=  4.41113D-04    |proj g|=  1.04021D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   57      1     0     0   0.000D+00   2.630D-04
  F =  2.63002264546230435E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 4.336E-01 seconds.
 Line search           time 1.398E+02 seconds.

 Total User time 1.439E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.637502459819


********************************************************************************
>>> Finding a balanced patch...
bal: 0.769250780437 22 521
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57014608383
fb norms: [0.9999997, 1.0, 1.0, 1.0000007]
W norm: 1.0
grad norms: [0.0031864122, 0.085193016, 0.37823215, 0.61243826, 0.15401246]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.600143544378
tst_shape: (30, 30)
tst_pe: 0.529485502914
================================================================================

At iterate    0    f=  1.54737D-02    |proj g|=  1.06531D-01
..........
================================================================================
#calls: 10
elapsed: 27.6907579899
fb norms: [0.99947375, 0.99950755, 0.99989146, 1.0004562]
W norm: 0.999353
grad norms: [0.001471428, 0.0044159987, 0.016713213, 0.025069376, 0.0049903616]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.664756191934
tst_shape: (30, 30)
tst_pe: 0.590744397832
================================================================================
..
At iterate   10    f=  8.78326D-03    |proj g|=  9.62258D-03
........
================================================================================
#calls: 20
elapsed: 52.8708341122
fb norms: [0.98583293, 0.98777491, 1.0067334, 1.0220714]
W norm: 0.986113
grad norms: [0.00069614552, 0.0054038274, 0.016599745, 0.025139071, 0.00592918]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.729291271928
tst_shape: (30, 30)
tst_pe: 0.599499313008
================================================================================
..
At iterate   20    f=  6.68143D-03    |proj g|=  1.38995D-03
........
================================================================================
#calls: 30
elapsed: 78.0645530224
fb norms: [0.99963051, 1.0060357, 1.0693283, 1.1114104]
W norm: 0.998513
grad norms: [0.0013079902, 0.0070088217, 0.023773197, 0.029107254, 0.0067963568]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.786295904486
tst_shape: (30, 30)
tst_pe: 0.628603113853
================================================================================
..
At iterate   30    f=  4.91450D-03    |proj g|=  5.41582D-03
........
================================================================================
#calls: 40
elapsed: 103.29847002
fb norms: [1.0404913, 1.0547681, 1.1952657, 1.2754999]
W norm: 1.03932
grad norms: [0.0012177258, 0.0056195441, 0.020865679, 0.025886152, 0.0057293405]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.81540566845
tst_shape: (30, 30)
tst_pe: 0.621782787954
================================================================================
..
At iterate   40    f=  3.53885D-03    |proj g|=  3.14060D-03
........
================================================================================
#calls: 50
elapsed: 128.581552029
fb norms: [1.0980185, 1.1211302, 1.3496474, 1.470302]
W norm: 1.09943
grad norms: [0.00094204058, 0.0081638787, 0.016081091, 0.014920263, 0.0034390306]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.858702025626
tst_shape: (30, 30)
tst_pe: 0.625059426937
================================================================================
..
At iterate   50    f=  1.75372D-03    |proj g|=  2.52237D-03
........
================================================================================
#calls: 60
elapsed: 153.909329176
fb norms: [1.2036268, 1.2435369, 1.6487169, 1.8385196]
W norm: 1.20945
grad norms: [0.00076899288, 0.0053862557, 0.016543847, 0.021209698, 0.0050971997]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.919534932682
tst_shape: (30, 30)
tst_pe: 0.626341112142
================================================================================
..
At iterate   60    f=  4.62267D-04    |proj g|=  1.42532D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   63   66      1     0     0   0.000D+00   1.655D-04
  F =  1.65487159392796457E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 6.152E-01 seconds.
 Line search           time 1.624E+02 seconds.

 Total User time 1.667E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.643251446919


********************************************************************************
>>> Finding a balanced patch...
bal: 0.785119667014 836 99
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57583093643
fb norms: [1.0000001, 1.0000011, 1.0000006, 0.99999964]
W norm: 1.0
grad norms: [0.00076995627, 0.056635704, 0.26539922, 0.39178956, 0.091912903]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.572881565084
tst_shape: (30, 30)
tst_pe: 0.57466876311
================================================================================

At iterate    0    f=  1.22140D-02    |proj g|=  6.27004D-02
..........
================================================================================
#calls: 10
elapsed: 27.7453000546
fb norms: [0.99794745, 0.99815673, 0.99977964, 1.000643]
W norm: 0.998837
grad norms: [0.0013273176, 0.0080231298, 0.022783617, 0.034176823, 0.0064742216]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.656179242813
tst_shape: (30, 30)
tst_pe: 0.627525573042
================================================================================
...
At iterate   10    f=  8.04607D-03    |proj g|=  2.50785D-03
.......
================================================================================
#calls: 20
elapsed: 52.8979170322
fb norms: [0.9876169, 0.990973, 1.0171096, 1.0314149]
W norm: 0.989786
grad norms: [0.00068219024, 0.0042222263, 0.010305529, 0.015611202, 0.00202594]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.721759767138
tst_shape: (30, 30)
tst_pe: 0.624130273578
================================================================================
...
At iterate   20    f=  6.09859D-03    |proj g|=  1.22574D-03
.......
================================================================================
#calls: 30
elapsed: 78.1057150364
fb norms: [1.0359944, 1.0502207, 1.176429, 1.2506114]
W norm: 1.03612
grad norms: [0.0024155336, 0.036641892, 0.12565109, 0.23289891, 0.061816286]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.795460139592
tst_shape: (30, 30)
tst_pe: 0.590491177478
================================================================================
....
At iterate   30    f=  4.03446D-03    |proj g|=  8.27177D-03
......
================================================================================
#calls: 40
elapsed: 103.41068697
fb norms: [1.0776111, 1.097157, 1.2695023, 1.3679835]
W norm: 1.07742
grad norms: [0.00075827201, 0.0040452285, 0.012842434, 0.021883491, 0.004568812]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.826851762143
tst_shape: (30, 30)
tst_pe: 0.587176962698
================================================================================
....
At iterate   40    f=  2.10542D-03    |proj g|=  1.41171D-03
......
================================================================================
#calls: 50
elapsed: 128.700089931
fb norms: [1.2025858, 1.2471921, 1.6486827, 1.8525709]
W norm: 1.20492
grad norms: [0.00065912644, 0.0063109016, 0.012352113, 0.016407963, 0.0020934294]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.90383353635
tst_shape: (30, 30)
tst_pe: 0.589055960808
================================================================================
....
At iterate   50    f=  5.65246D-04    |proj g|=  1.13875D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   57      1     0     0   0.000D+00   4.025D-04
  F =  4.02482808567583561E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.160E-01 seconds.
 Line search           time 1.399E+02 seconds.

 Total User time 1.439E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.647224548777


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777835587929 179 222
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62761616707
fb norms: [0.99999952, 1.0000007, 0.99999791, 0.99999928]
W norm: 1.0
grad norms: [0.0036110815, 0.0099508343, 0.029403636, 0.066198923, 0.0207603]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.579290298754
tst_shape: (30, 30)
tst_pe: 0.541611494295
================================================================================

At iterate    0    f=  1.08435D-02    |proj g|=  1.73045D-02
..........
================================================================================
#calls: 10
elapsed: 27.7485949993
fb norms: [0.99876523, 0.99911511, 1.0021243, 1.0059192]
W norm: 1.00096
grad norms: [0.00080646097, 0.0059759151, 0.013463444, 0.019848926, 0.0034094646]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.681298562211
tst_shape: (30, 30)
tst_pe: 0.586169932525
================================================================================
...
At iterate   10    f=  7.34203D-03    |proj g|=  5.26135D-03
.......
================================================================================
#calls: 20
elapsed: 52.8781950474
fb norms: [0.99449909, 0.99885988, 1.0372423, 1.0669606]
W norm: 1.00014
grad norms: [0.00099244481, 0.0027916753, 0.0086642075, 0.013820876, 0.0018848897]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.750472137144
tst_shape: (30, 30)
tst_pe: 0.588521185159
================================================================================
...
At iterate   20    f=  5.14096D-03    |proj g|=  3.42486D-03
.......
================================================================================
#calls: 30
elapsed: 78.131524086
fb norms: [1.0465651, 1.0594816, 1.199123, 1.2822486]
W norm: 1.05039
grad norms: [0.00095772522, 0.0042440007, 0.010742607, 0.01283262, 0.0019244431]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.803396318461
tst_shape: (30, 30)
tst_pe: 0.562534578869
================================================================================
...
At iterate   30    f=  3.39031D-03    |proj g|=  1.38162D-03
.......
================================================================================
#calls: 40
elapsed: 103.410804033
fb norms: [1.1162294, 1.138352, 1.3888813, 1.5215855]
W norm: 1.12132
grad norms: [0.00093552197, 0.0059137181, 0.011632248, 0.013271663, 0.0030128479]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.85541407444
tst_shape: (30, 30)
tst_pe: 0.548986990906
================================================================================
...
At iterate   40    f=  1.45540D-03    |proj g|=  5.10352D-03
.......
================================================================================
#calls: 50
elapsed: 128.697391987
fb norms: [1.2100874, 1.2461873, 1.6605518, 1.854546]
W norm: 1.2179
grad norms: [0.00069740001, 0.0047249044, 0.0087375361, 0.0091923382, 0.0016702908]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.911476242192
tst_shape: (30, 30)
tst_pe: 0.540187846081
================================================================================
...
At iterate   50    f=  2.43484D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   50   54      1     0     0   0.000D+00   2.435D-04
  F =  2.43484100792557001E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.652E-01 seconds.
 Line search           time 1.326E+02 seconds.

 Total User time 1.367E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.643401410744


********************************************************************************
>>> Finding a balanced patch...
bal: 0.77133194589 658 441
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62642192841
fb norms: [1.0, 1.0000008, 1.0000007, 1.0]
W norm: 1.0
grad norms: [0.0010747485, 0.042757411, 0.14283077, 0.22303146, 0.057869583]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.579465449706
tst_shape: (30, 30)
tst_pe: 0.481852822627
================================================================================

At iterate    0    f=  1.12051D-02    |proj g|=  3.29366D-02
..........
================================================================================
#calls: 10
elapsed: 27.7423729897
fb norms: [1.0002587, 1.0003167, 1.0010101, 1.0018758]
W norm: 1.00115
grad norms: [0.00092262577, 0.015107096, 0.039937705, 0.050762814, 0.010882884]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.655202630159
tst_shape: (30, 30)
tst_pe: 0.572529316078
================================================================================
..
At iterate   10    f=  8.38102D-03    |proj g|=  3.39833D-03
........
================================================================================
#calls: 20
elapsed: 52.8894369602
fb norms: [0.99002534, 0.99304748, 1.0246371, 1.0343468]
W norm: 0.998227
grad norms: [0.0019911795, 0.0088089658, 0.018986547, 0.028817417, 0.009744064]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.74182656141
tst_shape: (30, 30)
tst_pe: 0.61245062329
================================================================================
..
At iterate   20    f=  6.18026D-03    |proj g|=  1.24451D-03
........
================================================================================
#calls: 30
elapsed: 78.1017570496
fb norms: [1.0239563, 1.034692, 1.1496333, 1.1898414]
W norm: 1.03209
grad norms: [0.0013113389, 0.0054650507, 0.018799521, 0.022220165, 0.005708979]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.805433452986
tst_shape: (30, 30)
tst_pe: 0.612818955672
================================================================================
..
At iterate   30    f=  4.12435D-03    |proj g|=  2.02810D-03
........
================================================================================
#calls: 40
elapsed: 103.321501017
fb norms: [1.0934062, 1.1154156, 1.3472341, 1.4242488]
W norm: 1.10213
grad norms: [0.00076846039, 0.0035412177, 0.009107166, 0.010497021, 0.0011932871]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.853966085364
tst_shape: (30, 30)
tst_pe: 0.60577935337
================================================================================
..
At iterate   40    f=  1.87978D-03    |proj g|=  3.88993D-03
........
================================================================================
#calls: 50
elapsed: 128.621127844
fb norms: [1.2082573, 1.2476829, 1.6566712, 1.7815465]
W norm: 1.21746
grad norms: [0.0007707476, 0.0044332026, 0.01516213, 0.017574636, 0.0046232417]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.916647825678
tst_shape: (30, 30)
tst_pe: 0.606693666779
================================================================================
..
At iterate   50    f=  5.05474D-04    |proj g|=  1.82609D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   56      1     0     0   0.000D+00   2.074D-04
  F =  2.07384873647242785E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.336E-01 seconds.
 Line search           time 1.373E+02 seconds.

 Total User time 1.414E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.637309188979


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777835587929 324 515
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60587596893
fb norms: [1.0000001, 0.99999964, 1.0000002, 1.0000004]
W norm: 1.0
grad norms: [0.002865087, 0.057229865, 0.28371581, 0.36051595, 0.096959323]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.588535969343
tst_shape: (30, 30)
tst_pe: 0.556917295605
================================================================================

At iterate    0    f=  1.22802D-02    |proj g|=  6.54081D-02
..........
================================================================================
#calls: 10
elapsed: 27.7097239494
fb norms: [0.99544358, 0.99596488, 0.99918669, 1.0016478]
W norm: 0.99745
grad norms: [0.00059207412, 0.0081764264, 0.038187541, 0.047028162, 0.012691173]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.689002389382
tst_shape: (30, 30)
tst_pe: 0.602345926943
================================================================================
...
At iterate   10    f=  7.50798D-03    |proj g|=  1.54807D-03
.......
================================================================================
#calls: 20
elapsed: 52.8716919422
fb norms: [0.99528551, 1.0016761, 1.0548071, 1.0762771]
W norm: 1.00067
grad norms: [0.0015842557, 0.0085284803, 0.018944293, 0.024436124, 0.0063829077]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.766860026981
tst_shape: (30, 30)
tst_pe: 0.613027423822
================================================================================
...
At iterate   20    f=  5.04685D-03    |proj g|=  3.53784D-03
.......
================================================================================
#calls: 30
elapsed: 78.0669870377
fb norms: [1.04793, 1.0663522, 1.207639, 1.2598668]
W norm: 1.05436
grad norms: [0.00082792458, 0.0062960754, 0.022812648, 0.027231921, 0.0070532435]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.814108676811
tst_shape: (30, 30)
tst_pe: 0.580749405892
================================================================================
...
At iterate   30    f=  3.22385D-03    |proj g|=  2.17245D-03
.......
================================================================================
#calls: 40
elapsed: 103.341121912
fb norms: [1.1252697, 1.1591878, 1.4309658, 1.5265312]
W norm: 1.13443
grad norms: [0.00085796503, 0.0040376633, 0.012090624, 0.013616345, 0.0017363349]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.862586060601
tst_shape: (30, 30)
tst_pe: 0.569429325057
================================================================================
...
At iterate   40    f=  1.12009D-03    |proj g|=  1.88222D-03
.......
================================================================================
#calls: 50
elapsed: 128.618274927
fb norms: [1.2498358, 1.3074169, 1.7976835, 1.9573196]
W norm: 1.26508
grad norms: [0.0003448466, 0.0017349777, 0.0063886186, 0.0070167659, 0.0018250395]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.938708680692
tst_shape: (30, 30)
tst_pe: 0.570787998572
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   52      1     0     0   0.000D+00   2.477D-04
  F =  2.47746240347623825E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.574E-01 seconds.
 Line search           time 1.277E+02 seconds.

 Total User time 1.318E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.641591222494


********************************************************************************
>>> Finding a balanced patch...
bal: 0.783298647242 791 335
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61678195
fb norms: [0.99999958, 1.0000017, 1.0000008, 1.0000001]
W norm: 1.0
grad norms: [0.0039447728, 0.088903286, 0.45951706, 0.70945483, 0.17588668]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.561917903354
tst_shape: (30, 30)
tst_pe: 0.526775819406
================================================================================

At iterate    0    f=  1.69747D-02    |proj g|=  1.15451D-01
..........
================================================================================
#calls: 10
elapsed: 27.7751848698
fb norms: [0.99845397, 0.99850756, 0.99915951, 0.99987328]
W norm: 0.998643
grad norms: [0.0017547465, 0.0052726129, 0.018700872, 0.027162356, 0.005571981]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.645642261179
tst_shape: (30, 30)
tst_pe: 0.599123935976
================================================================================
..
At iterate   10    f=  8.81568D-03    |proj g|=  6.71658D-03
........
================================================================================
#calls: 20
elapsed: 52.9173398018
fb norms: [0.98281312, 0.98482549, 1.0075835, 1.0225394]
W norm: 0.984898
grad norms: [0.0020793544, 0.0089761354, 0.023637177, 0.04134623, 0.012049852]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.720239230672
tst_shape: (30, 30)
tst_pe: 0.629569591232
================================================================================
..
At iterate   20    f=  6.81987D-03    |proj g|=  1.87721D-03
........
================================================================================
#calls: 30
elapsed: 78.1462199688
fb norms: [1.0062487, 1.0137193, 1.0993239, 1.145838]
W norm: 1.00637
grad norms: [0.0010906921, 0.0037765498, 0.009564816, 0.011073736, 0.0011813932]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.775760999558
tst_shape: (30, 30)
tst_pe: 0.645366846477
================================================================================
..
At iterate   30    f=  5.07843D-03    |proj g|=  2.88135D-03
........
================================================================================
#calls: 40
elapsed: 103.40090394
fb norms: [1.0590374, 1.0738622, 1.2599688, 1.3425025]
W norm: 1.05804
grad norms: [0.00068235374, 0.0049743992, 0.011169758, 0.017330276, 0.0037301409]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.814896383988
tst_shape: (30, 30)
tst_pe: 0.63848763325
================================================================================
..
At iterate   40    f=  2.98348D-03    |proj g|=  1.46511D-03
........
================================================================================
#calls: 50
elapsed: 128.697249889
fb norms: [1.1562026, 1.1837412, 1.537297, 1.6714548]
W norm: 1.15722
grad norms: [0.00077656721, 0.0052794861, 0.016992366, 0.026130971, 0.0061904476]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.872121548682
tst_shape: (30, 30)
tst_pe: 0.651392131922
================================================================================
..
At iterate   50    f=  1.52382D-03    |proj g|=  2.23887D-03
........
================================================================================
#calls: 60
elapsed: 154.03171587
fb norms: [1.2579798, 1.3008467, 1.8396835, 2.026649]
W norm: 1.26235
grad norms: [0.00050111144, 0.0029443218, 0.0087094549, 0.011448628, 0.0026909828]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.932232212584
tst_shape: (30, 30)
tst_pe: 0.643465276451
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   58   61      1     0     0   0.000D+00   3.436D-04
  F =  3.43559106113389134E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.234E-01 seconds.
 Line search           time 1.505E+02 seconds.

 Total User time 1.547E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.644062336664


********************************************************************************
>>> Finding a balanced patch...
bal: 0.778095733611 257 496
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.5858900547
fb norms: [1.0000005, 1.0000012, 1.0000007, 1.0000002]
W norm: 1.0
grad norms: [0.00068790704, 0.053736452, 0.19877131, 0.36374614, 0.088338859]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.568086252617
tst_shape: (30, 30)
tst_pe: 0.579503592603
================================================================================

At iterate    0    f=  1.22720D-02    |proj g|=  5.78919D-02
..........
================================================================================
#calls: 10
elapsed: 27.7106690407
fb norms: [1.0000373, 1.0002041, 1.0020151, 1.0032767]
W norm: 1.0019
grad norms: [0.00058194646, 0.0069348803, 0.023682697, 0.034445141, 0.0083137862]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.659769570537
tst_shape: (30, 30)
tst_pe: 0.620774295055
================================================================================
...
At iterate   10    f=  7.65050D-03    |proj g|=  4.52879D-03
.......
================================================================================
#calls: 20
elapsed: 52.9008920193
fb norms: [1.0018777, 1.0055265, 1.0553653, 1.0788366]
W norm: 1.00664
grad norms: [0.0010581551, 0.005892545, 0.012669298, 0.014420193, 0.0029788979]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.757626940832
tst_shape: (30, 30)
tst_pe: 0.621184147344
================================================================================
...
At iterate   20    f=  5.42091D-03    |proj g|=  1.50787D-03
.......
================================================================================
#calls: 30
elapsed: 78.0860180855
fb norms: [1.0548953, 1.065886, 1.2046406, 1.2611865]
W norm: 1.06003
grad norms: [0.0011554308, 0.0093305316, 0.018795155, 0.023361551, 0.0044151372]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.807094994399
tst_shape: (30, 30)
tst_pe: 0.598605329872
================================================================================
...
At iterate   30    f=  3.57456D-03    |proj g|=  1.65063D-03
.......
================================================================================
#calls: 40
elapsed: 103.326353073
fb norms: [1.1277306, 1.1495106, 1.4059751, 1.4953781]
W norm: 1.13612
grad norms: [0.00088359258, 0.0067615076, 0.013308839, 0.018654518, 0.0040105348]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.853981514438
tst_shape: (30, 30)
tst_pe: 0.603703929063
================================================================================
...
At iterate   40    f=  1.71950D-03    |proj g|=  2.10192D-03
.......
================================================================================
#calls: 50
elapsed: 128.624614
fb norms: [1.2423754, 1.2832299, 1.7354851, 1.8760122]
W norm: 1.25748
grad norms: [0.00040052034, 0.0043581147, 0.015268511, 0.019547261, 0.005786099]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.920202274266
tst_shape: (30, 30)
tst_pe: 0.595802074655
================================================================================
...
At iterate   50    f=  3.00848D-04    |proj g|=  6.52585D-04
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   51   55      1     0     0   0.000D+00   1.651D-04
  F =  1.65139586897566915E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.965E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.390E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.646181588562


********************************************************************************
>>> Finding a balanced patch...
bal: 0.778095733611 474 851
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61193418503
fb norms: [1.0000004, 1.0000002, 1.0000008, 0.9999994]
W norm: 1.0
grad norms: [0.0037418902, 0.04928486, 0.29595071, 0.44903785, 0.1288397]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.592082085025
tst_shape: (30, 30)
tst_pe: 0.549992438039
================================================================================

At iterate    0    f=  1.38915D-02    |proj g|=  9.06965D-02
..........
================================================================================
#calls: 10
elapsed: 27.7553920746
fb norms: [0.99909556, 0.99919271, 1.0001123, 1.0008309]
W norm: 0.999478
grad norms: [0.0017358398, 0.0062388573, 0.019718738, 0.028444136, 0.007659087]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.675391054997
tst_shape: (30, 30)
tst_pe: 0.594711875571
================================================================================
..
At iterate   10    f=  7.94062D-03    |proj g|=  2.08586D-02
........
================================================================================
#calls: 20
elapsed: 52.8733019829
fb norms: [0.98714203, 0.99164635, 1.0308501, 1.0524082]
W norm: 0.989302
grad norms: [0.00072756567, 0.00420553, 0.012138354, 0.013516677, 0.0032075045]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.752146677041
tst_shape: (30, 30)
tst_pe: 0.62046140337
================================================================================
..
At iterate   20    f=  5.85112D-03    |proj g|=  1.57409D-03
........
================================================================================
#calls: 30
elapsed: 78.0518641472
fb norms: [1.0186244, 1.0306531, 1.141259, 1.1925356]
W norm: 1.0209
grad norms: [0.00090214441, 0.005047176, 0.013302082, 0.015541132, 0.0026163254]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.795119447816
tst_shape: (30, 30)
tst_pe: 0.604929078467
================================================================================
..
At iterate   30    f=  3.87750D-03    |proj g|=  3.37865D-03
........
================================================================================
#calls: 40
elapsed: 103.30310607
fb norms: [1.0730766, 1.0955019, 1.3071454, 1.3893211]
W norm: 1.07816
grad norms: [0.0011624706, 0.0079765338, 0.014664695, 0.017247608, 0.0045548878]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.833949444105
tst_shape: (30, 30)
tst_pe: 0.594931094685
================================================================================
..
At iterate   40    f=  2.28291D-03    |proj g|=  1.06068D-02
........
================================================================================
#calls: 50
elapsed: 128.582695961
fb norms: [1.1815135, 1.2255448, 1.6302159, 1.7623922]
W norm: 1.19185
grad norms: [0.00067627459, 0.00567452, 0.01038821, 0.011267907, 0.0029204558]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.899567390751
tst_shape: (30, 30)
tst_pe: 0.588710636254
================================================================================
..
At iterate   50    f=  8.12372D-04    |proj g|=  1.51302D-03
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   2.592D-04
  F =  2.59166379692032933E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 1.953E-03 seconds.
 Subspace minimization time 4.395E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.634792120832


********************************************************************************
>>> Finding a balanced patch...
bal: 0.787981269511 689 379
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57074594498
fb norms: [0.99999964, 0.99999952, 1.0000013, 0.99999923]
W norm: 1.0
grad norms: [0.002690617, 0.091796383, 0.3830117, 0.51254004, 0.14101629]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.593776624722
tst_shape: (30, 30)
tst_pe: 0.540727900751
================================================================================

At iterate    0    f=  1.40530D-02    |proj g|=  9.49203D-02
..........
================================================================================
#calls: 10
elapsed: 27.6900200844
fb norms: [1.0003016, 1.0003498, 1.0007532, 1.0011801]
W norm: 1.00024
grad norms: [0.0012329232, 0.0056610294, 0.021089753, 0.025166068, 0.0067394925]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.658770851622
tst_shape: (30, 30)
tst_pe: 0.602981280978
================================================================================
..
At iterate   10    f=  8.06613D-03    |proj g|=  4.85596D-03
........
================================================================================
#calls: 20
elapsed: 52.8355550766
fb norms: [0.99077237, 0.99582833, 1.0362892, 1.0561124]
W norm: 0.993596
grad norms: [0.00067185092, 0.0097952476, 0.022936499, 0.020119542, 0.0051149125]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.741634324886
tst_shape: (30, 30)
tst_pe: 0.599259540083
================================================================================
..
At iterate   20    f=  5.52904D-03    |proj g|=  5.65811D-03
........
================================================================================
#calls: 30
elapsed: 78.0382630825
fb norms: [1.0141275, 1.0249104, 1.1260973, 1.158229]
W norm: 1.01646
grad norms: [0.0012670998, 0.0051372088, 0.011525447, 0.013664525, 0.0025178601]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.787502822928
tst_shape: (30, 30)
tst_pe: 0.601677859001
================================================================================
...
At iterate   30    f=  3.97732D-03    |proj g|=  1.45061D-03
.......
================================================================================
#calls: 40
elapsed: 103.281588078
fb norms: [1.0841484, 1.1066154, 1.3101857, 1.3606369]
W norm: 1.08759
grad norms: [0.00080134446, 0.012004497, 0.023851162, 0.028053086, 0.0066580386]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.840074960931
tst_shape: (30, 30)
tst_pe: 0.560209148969
================================================================================
...
At iterate   40    f=  2.01188D-03    |proj g|=  2.19993D-03
.......
================================================================================
#calls: 50
elapsed: 128.596549988
fb norms: [1.1862463, 1.2276099, 1.5834376, 1.6642429]
W norm: 1.19318
grad norms: [0.00061446067, 0.0055372822, 0.011192196, 0.012283267, 0.0021206948]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.899543043867
tst_shape: (30, 30)
tst_pe: 0.560822870238
================================================================================
...
At iterate   50    f=  4.83662D-04    |proj g|=  7.54523D-04
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   60      1     0     0   0.000D+00   1.171D-04
  F =  1.17090443382039666E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.883E-01 seconds.
 Line search           time 1.469E+02 seconds.

 Total User time 1.510E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.634048179236


********************************************************************************
>>> Finding a balanced patch...
bal: 0.773673257024 956 690
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56398391724
fb norms: [1.0000001, 0.99999946, 1.0000004, 1.0000001]
W norm: 1.0
grad norms: [0.0050959471, 0.12074041, 0.38473475, 0.51409203, 0.12985249]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.572454800985
tst_shape: (30, 30)
tst_pe: 0.498551815053
================================================================================

At iterate    0    f=  1.49218D-02    |proj g|=  9.76601D-02
..........
================================================================================
#calls: 10
elapsed: 27.6862618923
fb norms: [0.99972254, 0.99975473, 1.0008372, 1.0015663]
W norm: 0.999985
grad norms: [0.00095926155, 0.0044490583, 0.014138451, 0.01950269, 0.0028632847]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.64480902948
tst_shape: (30, 30)
tst_pe: 0.578230932211
================================================================================
..
At iterate   10    f=  8.82256D-03    |proj g|=  2.26333D-03
........
================================================================================
#calls: 20
elapsed: 52.7893650532
fb norms: [0.99669427, 0.99888784, 1.0321685, 1.0400509]
W norm: 0.996976
grad norms: [0.00092013343, 0.0065296055, 0.013271617, 0.015110613, 0.003462214]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.719222960934
tst_shape: (30, 30)
tst_pe: 0.586504248321
================================================================================
...
At iterate   20    f=  6.69769D-03    |proj g|=  3.04589D-03
.......
================================================================================
#calls: 30
elapsed: 78.0188779831
fb norms: [1.0231321, 1.0306463, 1.125686, 1.1518531]
W norm: 1.02288
grad norms: [0.0010238381, 0.0051458119, 0.011292404, 0.015439617, 0.0022138094]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.771540902226
tst_shape: (30, 30)
tst_pe: 0.55984921946
================================================================================
...
At iterate   30    f=  4.46991D-03    |proj g|=  3.49467D-03
.......
================================================================================
#calls: 40
elapsed: 103.258920908
fb norms: [1.1041561, 1.1258392, 1.380412, 1.4465104]
W norm: 1.10732
grad norms: [0.0017374523, 0.014923222, 0.042257749, 0.062665969, 0.017225597]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.838830781226
tst_shape: (30, 30)
tst_pe: 0.532857066007
================================================================================
...
At iterate   40    f=  2.31428D-03    |proj g|=  1.41482D-03
.......
================================================================================
#calls: 50
elapsed: 128.517565966
fb norms: [1.2055786, 1.2435776, 1.6776826, 1.7848877]
W norm: 1.21424
grad norms: [0.00080706377, 0.003808249, 0.010819583, 0.012091472, 0.001628141]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.903733150557
tst_shape: (30, 30)
tst_pe: 0.52850618764
================================================================================
...
At iterate   50    f=  6.30096D-04    |proj g|=  7.35891D-04
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   57      1     0     0   0.000D+00   2.803D-04
  F =  2.80275824479758739E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.238E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.631979278886


********************************************************************************
>>> Finding a balanced patch...
bal: 0.774973985432 267 576
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.6082868576
fb norms: [1.0, 1.0000008, 1.0, 0.99999982]
W norm: 1.0
grad norms: [0.0023194854, 0.068435878, 0.26121798, 0.45713186, 0.12026593]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.566619874858
tst_shape: (30, 30)
tst_pe: 0.480962519567
================================================================================

At iterate    0    f=  1.42540D-02    |proj g|=  8.95747D-02
..........
================================================================================
#calls: 10
elapsed: 27.7358548641
fb norms: [1.0006281, 1.0006876, 1.0012871, 1.0022618]
W norm: 1.00103
grad norms: [0.0015135516, 0.0059016808, 0.021217408, 0.030509412, 0.0076618702]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.638456343058
tst_shape: (30, 30)
tst_pe: 0.565490326188
================================================================================
..
At iterate   10    f=  8.50851D-03    |proj g|=  6.35929D-03
........
================================================================================
#calls: 20
elapsed: 52.9200220108
fb norms: [0.99234819, 0.9954707, 1.0297774, 1.0499986]
W norm: 0.994232
grad norms: [0.0010807752, 0.0025499202, 0.009825157, 0.014650828, 0.0019398511]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.737101096959
tst_shape: (30, 30)
tst_pe: 0.583397363671
================================================================================
..
At iterate   20    f=  6.22074D-03    |proj g|=  2.85308D-03
........
================================================================================
#calls: 30
elapsed: 78.1130888462
fb norms: [1.0340512, 1.0447891, 1.1681494, 1.2231381]
W norm: 1.03382
grad norms: [0.0010907578, 0.0046239686, 0.013380156, 0.015451115, 0.0027373563]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.791283073893
tst_shape: (30, 30)
tst_pe: 0.572810054192
================================================================================
..
At iterate   30    f=  4.23195D-03    |proj g|=  1.99268D-03
........
================================================================================
#calls: 40
elapsed: 103.327314854
fb norms: [1.1143397, 1.1372904, 1.3800075, 1.4762712]
W norm: 1.11485
grad norms: [0.0012781837, 0.0049257642, 0.013685027, 0.018852664, 0.0042301146]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.850341568449
tst_shape: (30, 30)
tst_pe: 0.554682710311
================================================================================
..
At iterate   40    f=  1.92071D-03    |proj g|=  1.29466D-03
........
================================================================================
#calls: 50
elapsed: 128.700809956
fb norms: [1.223353, 1.2673607, 1.7032311, 1.8587532]
W norm: 1.22589
grad norms: [0.00062290003, 0.0068474486, 0.023528315, 0.027358167, 0.0067205755]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.91682777803
tst_shape: (30, 30)
tst_pe: 0.53898214183
================================================================================
..
At iterate   50    f=  4.47955D-04    |proj g|=  2.69120D-03
...
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   53   56      1     0     0   0.000D+00   1.990D-04
  F =  1.99011396034620702E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.180E-01 seconds.
 Line search           time 1.373E+02 seconds.

 Total User time 1.415E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.632247266756


********************************************************************************
>>> Finding a balanced patch...
bal: 0.789281997919 42 555
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61263680458
fb norms: [1.0, 1.0000005, 0.99999905, 0.99999988]
W norm: 1.0
grad norms: [0.0010838477, 0.025158893, 0.11624827, 0.18747236, 0.041351359]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.571362704408
tst_shape: (30, 30)
tst_pe: 0.491383903845
================================================================================

At iterate    0    f=  1.06579D-02    |proj g|=  2.41138D-02
..........
================================================================================
#calls: 10
elapsed: 27.7565429211
fb norms: [0.99988109, 0.99999553, 1.0010051, 1.0018827]
W norm: 1.00092
grad norms: [0.00096734829, 0.00607308, 0.043813705, 0.037965879, 0.0067505161]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.657492526638
tst_shape: (30, 30)
tst_pe: 0.594675951825
================================================================================
..
At iterate   10    f=  7.91166D-03    |proj g|=  5.62089D-03
........
================================================================================
#calls: 20
elapsed: 52.9077138901
fb norms: [0.9929353, 0.99511915, 1.014559, 1.0205437]
W norm: 0.997604
grad norms: [0.00047268288, 0.0033593676, 0.015565648, 0.027914815, 0.0059882617]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.720371860607
tst_shape: (30, 30)
tst_pe: 0.589174678968
================================================================================
..
At iterate   20    f=  6.16720D-03    |proj g|=  6.92847D-03
........
================================================================================
#calls: 30
elapsed: 78.1757009029
fb norms: [1.0183545, 1.0257667, 1.1091853, 1.1406821]
W norm: 1.02255
grad norms: [0.0010283398, 0.0037311725, 0.017211607, 0.021249035, 0.0053895479]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.785006977461
tst_shape: (30, 30)
tst_pe: 0.599254169288
================================================================================
..
At iterate   30    f=  4.12837D-03    |proj g|=  3.59399D-03
........
================================================================================
#calls: 40
elapsed: 103.405748844
fb norms: [1.0799319, 1.096112, 1.2875592, 1.3659369]
W norm: 1.08519
grad norms: [0.00093522057, 0.0056233546, 0.013278843, 0.015644891, 0.0032398941]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.837345929751
tst_shape: (30, 30)
tst_pe: 0.586429695643
================================================================================
..
At iterate   40    f=  2.15321D-03    |proj g|=  1.96499D-03
........
================================================================================
#calls: 50
elapsed: 128.696015835
fb norms: [1.2003936, 1.2366886, 1.6545498, 1.8128291]
W norm: 1.20958
grad norms: [0.00060144259, 0.0039134924, 0.010144243, 0.010677236, 0.0019115966]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.915812139106
tst_shape: (30, 30)
tst_pe: 0.58168757241
================================================================================
..
At iterate   50    f=  4.26703D-04    |proj g|=  1.09607D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   55      1     0     0   0.000D+00   1.673D-04
  F =  1.67337435414083302E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.984E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.391E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.640275345495


********************************************************************************
>>> Finding a balanced patch...
bal: 0.786940686785 396 11
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57981514931
fb norms: [0.99999982, 0.99999779, 1.0000006, 0.99999911]
W norm: 1.0
grad norms: [0.0013570031, 0.040226836, 0.20567442, 0.28607124, 0.076624416]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.573123071789
tst_shape: (30, 30)
tst_pe: 0.538303320443
================================================================================

At iterate    0    f=  1.16606D-02    |proj g|=  5.33276D-02
..........
================================================================================
#calls: 10
elapsed: 27.7257390022
fb norms: [0.99932438, 0.99941432, 1.0006163, 1.0008185]
W norm: 0.999863
grad norms: [0.0015742275, 0.010653134, 0.029872309, 0.0432919, 0.010194222]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.644837959106
tst_shape: (30, 30)
tst_pe: 0.594435473705
================================================================================
..
At iterate   10    f=  8.18468D-03    |proj g|=  3.08342D-03
........
================================================================================
#calls: 20
elapsed: 52.8865940571
fb norms: [0.99157339, 0.994982, 1.0318284, 1.0428913]
W norm: 0.993191
grad norms: [0.0010788899, 0.0065014446, 0.014661852, 0.022498388, 0.0042532445]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.725768535085
tst_shape: (30, 30)
tst_pe: 0.606306114817
================================================================================
..
At iterate   20    f=  6.24536D-03    |proj g|=  5.96503D-03
........
================================================================================
#calls: 30
elapsed: 78.0717070103
fb norms: [1.0274974, 1.0376955, 1.1493547, 1.1790687]
W norm: 1.02884
grad norms: [0.00095465966, 0.0042239311, 0.01911171, 0.023899775, 0.005638585]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.777937708714
tst_shape: (30, 30)
tst_pe: 0.603077594305
================================================================================
..
At iterate   30    f=  4.47045D-03    |proj g|=  1.17772D-03
........
================================================================================
#calls: 40
elapsed: 103.299200058
fb norms: [1.0981926, 1.1199968, 1.3496592, 1.4060702]
W norm: 1.10032
grad norms: [0.00086961978, 0.0072188075, 0.013935375, 0.011337543, 0.0013523689]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.832292327338
tst_shape: (30, 30)
tst_pe: 0.591166703389
================================================================================
..
At iterate   40    f=  2.46179D-03    |proj g|=  9.58353D-04
........
================================================================================
#calls: 50
elapsed: 128.542835951
fb norms: [1.1990277, 1.2395611, 1.6556283, 1.7496709]
W norm: 1.20342
grad norms: [0.00068390754, 0.0053505409, 0.013028403, 0.013074043, 0.0029262614]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.897071577618
tst_shape: (30, 30)
tst_pe: 0.595958835624
================================================================================
..
At iterate   50    f=  7.32766D-04    |proj g|=  2.40945D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   1.693D-04
  F =  1.69257618836127222E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.688E-01 seconds.
 Line search           time 1.444E+02 seconds.

 Total User time 1.485E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.645626620418


********************************************************************************
>>> Finding a balanced patch...
bal: 0.787981269511 301 252
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61003899574
fb norms: [1.0, 1.0, 0.99999988, 1.0000001]
W norm: 1.0
grad norms: [0.0058643268, 0.015523502, 0.066078924, 0.11080438, 0.036603644]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.585419114098
tst_shape: (30, 30)
tst_pe: 0.546142371852
================================================================================

At iterate    0    f=  1.05377D-02    |proj g|=  2.99148D-02
..........
================================================================================
#calls: 10
elapsed: 27.7483360767
fb norms: [1.001617, 1.0017997, 1.0032718, 1.0035354]
W norm: 1.00227
grad norms: [0.0012461417, 0.0089353677, 0.042630736, 0.040001731, 0.0082386294]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.664333388423
tst_shape: (30, 30)
tst_pe: 0.61069346848
================================================================================
..
At iterate   10    f=  7.85227D-03    |proj g|=  1.46240D-03
........
================================================================================
#calls: 20
elapsed: 52.8951120377
fb norms: [0.99411935, 0.99656051, 1.0234195, 1.0294176]
W norm: 0.998462
grad norms: [0.00047878726, 0.0038336932, 0.011004707, 0.011850491, 0.0016588428]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.742950469032
tst_shape: (30, 30)
tst_pe: 0.631338309996
================================================================================
..
At iterate   20    f=  5.52673D-03    |proj g|=  4.26560D-03
........
================================================================================
#calls: 30
elapsed: 78.092911005
fb norms: [1.0162221, 1.0256889, 1.1329652, 1.1620311]
W norm: 1.0236
grad norms: [0.00074771408, 0.0043217959, 0.014889913, 0.016139433, 0.0033865389]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.798834190424
tst_shape: (30, 30)
tst_pe: 0.601049851101
================================================================================
..
At iterate   30    f=  3.77579D-03    |proj g|=  9.26600D-04
........
================================================================================
#calls: 40
elapsed: 103.315408945
fb norms: [1.1067684, 1.1295998, 1.3848529, 1.4520713]
W norm: 1.11722
grad norms: [0.0011640672, 0.0079482161, 0.023318615, 0.016389504, 0.0037381826]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.860533827825
tst_shape: (30, 30)
tst_pe: 0.601586349902
================================================================================
..
At iterate   40    f=  1.66356D-03    |proj g|=  1.32417D-03
........
================================================================================
#calls: 50
elapsed: 128.581632137
fb norms: [1.2123917, 1.251375, 1.6891066, 1.7962713]
W norm: 1.22744
grad norms: [0.00054842746, 0.0095873531, 0.024171267, 0.022764094, 0.0051744301]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.923374706107
tst_shape: (30, 30)
tst_pe: 0.614713137019
================================================================================
..
At iterate   50    f=  3.80896D-04    |proj g|=  7.04853D-04
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   1.021D-04
  F =  1.02086363767739385E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 3.906E-03 seconds.
 Subspace minimization time 4.648E-01 seconds.
 Line search           time 1.396E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.646022556645


********************************************************************************
>>> Finding a balanced patch...
bal: 0.77471383975 34 726
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56113004684
fb norms: [0.99999964, 1.0000001, 1.000001, 1.0000001]
W norm: 1.0
grad norms: [0.0061708493, 0.11783796, 0.45701939, 0.5228582, 0.13979164]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.594393680184
tst_shape: (30, 30)
tst_pe: 0.554989299615
================================================================================

At iterate    0    f=  1.64126D-02    |proj g|=  1.13471D-01
..........
================================================================================
#calls: 10
elapsed: 27.6849250793
fb norms: [0.99849218, 0.99856615, 0.99925113, 1.0000365]
W norm: 0.997855
grad norms: [0.0015455711, 0.0062979888, 0.02247197, 0.018933672, 0.0037361791]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.662603540998
tst_shape: (30, 30)
tst_pe: 0.606200527074
================================================================================
..
At iterate   10    f=  8.63149D-03    |proj g|=  1.09544D-02
........
================================================================================
#calls: 20
elapsed: 52.8229680061
fb norms: [0.98662448, 0.98859435, 1.0125794, 1.0216796]
W norm: 0.985363
grad norms: [0.0011065322, 0.0061238338, 0.016245548, 0.015561491, 0.0034984599]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.741122968749
tst_shape: (30, 30)
tst_pe: 0.619255507704
================================================================================
..
At iterate   20    f=  6.43236D-03    |proj g|=  1.98438D-03
........
================================================================================
#calls: 30
elapsed: 78.0309109688
fb norms: [1.0228355, 1.0310341, 1.135669, 1.1646453]
W norm: 1.01955
grad norms: [0.00095681625, 0.0057393634, 0.014285211, 0.021581512, 0.0045826407]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.797076363277
tst_shape: (30, 30)
tst_pe: 0.609438361648
================================================================================
..
At iterate   30    f=  4.35383D-03    |proj g|=  8.97568D-04
........
================================================================================
#calls: 40
elapsed: 103.364978075
fb norms: [1.0880288, 1.105641, 1.3039013, 1.3552831]
W norm: 1.0848
grad norms: [0.0010311691, 0.0046019433, 0.01355426, 0.015706647, 0.0019815899]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.840142916723
tst_shape: (30, 30)
tst_pe: 0.604320043878
================================================================================
..
At iterate   40    f=  2.24751D-03    |proj g|=  3.32562D-03
........
================================================================================
#calls: 50
elapsed: 128.643539906
fb norms: [1.1685532, 1.1993375, 1.5163199, 1.596099]
W norm: 1.16587
grad norms: [0.00096654129, 0.0070736497, 0.021355586, 0.027970538, 0.0055073411]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.886702339845
tst_shape: (30, 30)
tst_pe: 0.581927571917
================================================================================
..
At iterate   50    f=  9.63551D-04    |proj g|=  1.42809D-03
........
================================================================================
#calls: 60
elapsed: 153.980679035
fb norms: [1.2885921, 1.3405595, 1.8458724, 1.9687866]
W norm: 1.28822
grad norms: [0.00034931174, 0.0024587589, 0.006678456, 0.0078689363, 0.00115232]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.94530676953
tst_shape: (30, 30)
tst_pe: 0.579110143712
================================================================================
.
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   59   62      1     0     0   0.000D+00   1.647D-04
  F =  1.64662662427872419E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 5.234E-01 seconds.
 Line search           time 1.529E+02 seconds.

 Total User time 1.571E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.640429312888


********************************************************************************
>>> Finding a balanced patch...
bal: 0.78616024974 89 775
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56578707695
fb norms: [0.99999976, 1.0000004, 1.0, 0.99999994]
W norm: 1.0
grad norms: [0.0019524497, 0.049463462, 0.2102363, 0.32785308, 0.060692396]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.569734179528
tst_shape: (30, 30)
tst_pe: 0.53622294266
================================================================================

At iterate    0    f=  1.15417D-02    |proj g|=  4.72761D-02
..........
================================================================================
#calls: 10
elapsed: 27.6975209713
fb norms: [0.99790335, 0.99810678, 0.99983269, 1.0011237]
W norm: 0.999423
grad norms: [0.0012197733, 0.0072118538, 0.017221512, 0.02266678, 0.0025552411]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.661343834666
tst_shape: (30, 30)
tst_pe: 0.607873765677
================================================================================
...
At iterate   10    f=  7.54920D-03    |proj g|=  4.20467D-03
.......
================================================================================
#calls: 20
elapsed: 52.8598339558
fb norms: [0.99109221, 0.99653846, 1.0398145, 1.0694107]
W norm: 0.995871
grad norms: [0.0020967345, 0.015806518, 0.052934233, 0.068891481, 0.016341556]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.753363372421
tst_shape: (30, 30)
tst_pe: 0.607339990594
================================================================================
...
At iterate   20    f=  5.62311D-03    |proj g|=  2.41398D-03
.......
================================================================================
#calls: 30
elapsed: 78.0560359955
fb norms: [1.020045, 1.0307496, 1.1294369, 1.1849374]
W norm: 1.02319
grad norms: [0.0011132903, 0.0051952703, 0.01097705, 0.014731757, 0.0024302113]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.794675778843
tst_shape: (30, 30)
tst_pe: 0.600071102257
================================================================================
...
At iterate   30    f=  3.45006D-03    |proj g|=  3.21985D-03
.......
================================================================================
#calls: 40
elapsed: 103.313965082
fb norms: [1.1099175, 1.1372422, 1.4074513, 1.5291712]
W norm: 1.11332
grad norms: [0.00096412026, 0.0074572423, 0.021804309, 0.023385715, 0.004334033]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.861397748533
tst_shape: (30, 30)
tst_pe: 0.587514141739
================================================================================
...
At iterate   40    f=  1.58938D-03    |proj g|=  1.10212D-03
.......
================================================================================
#calls: 50
elapsed: 128.712153912
fb norms: [1.1978979, 1.2404859, 1.653358, 1.825067]
W norm: 1.20409
grad norms: [0.00055926846, 0.0029064647, 0.007184532, 0.0076970262, 0.0011778594]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.917709566644
tst_shape: (30, 30)
tst_pe: 0.571885770023
================================================================================
...
At iterate   50    f=  2.40046D-04    |proj g|=  1.10553D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   56      1     0     0   0.000D+00   1.364D-04
  F =  1.36421018396504223E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.141E-01 seconds.
 Line search           time 1.375E+02 seconds.

 Total User time 1.415E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.64076413893


********************************************************************************
>>> Finding a balanced patch...
bal: 0.779916753382 417 114
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57060599327
fb norms: [1.0000001, 0.99999905, 0.99999934, 0.99999988]
W norm: 1.0
grad norms: [0.0027804766, 0.062750004, 0.20833628, 0.35748315, 0.077880912]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.585264439335
tst_shape: (30, 30)
tst_pe: 0.52644980987
================================================================================

At iterate    0    f=  1.18966D-02    |proj g|=  5.49274D-02
..........
================================================================================
#calls: 10
elapsed: 27.7397358418
fb norms: [0.99423683, 0.99452531, 0.99763644, 1.0005746]
W norm: 0.996797
grad norms: [0.00050063292, 0.0055345451, 0.019629845, 0.030538604, 0.0061717802]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.674393044512
tst_shape: (30, 30)
tst_pe: 0.600934842656
================================================================================
...
At iterate   10    f=  7.30427D-03    |proj g|=  1.20086D-02
.......
================================================================================
#calls: 20
elapsed: 52.868489027
fb norms: [0.98402429, 0.98695034, 1.02535, 1.0469031]
W norm: 0.990323
grad norms: [0.0007321235, 0.0046034907, 0.013206706, 0.020183064, 0.0027364162]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.737053464689
tst_shape: (30, 30)
tst_pe: 0.620177431365
================================================================================
...
At iterate   20    f=  5.35416D-03    |proj g|=  3.72214D-03
.......
================================================================================
#calls: 30
elapsed: 78.0674729347
fb norms: [1.0147426, 1.0236108, 1.1325856, 1.1855031]
W norm: 1.01748
grad norms: [0.0011614679, 0.0052869692, 0.014902391, 0.021934502, 0.0045081573]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.79381026563
tst_shape: (30, 30)
tst_pe: 0.599350879828
================================================================================
...
At iterate   30    f=  3.50556D-03    |proj g|=  9.54816D-03
.......
================================================================================
#calls: 40
elapsed: 103.309203863
fb norms: [1.0726192, 1.0890902, 1.2743859, 1.3569533]
W norm: 1.07455
grad norms: [0.00096922374, 0.0064225597, 0.023969455, 0.033653814, 0.0069205817]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.83997881627
tst_shape: (30, 30)
tst_pe: 0.596995712804
================================================================================
...
At iterate   40    f=  1.94765D-03    |proj g|=  2.15800D-03
.......
================================================================================
#calls: 50
elapsed: 128.55465889
fb norms: [1.1598358, 1.1878977, 1.4970378, 1.6237146]
W norm: 1.16211
grad norms: [0.00072216522, 0.0036326123, 0.010008909, 0.010310159, 0.0013318945]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.893797142587
tst_shape: (30, 30)
tst_pe: 0.583390600356
================================================================================
...
At iterate   50    f=  5.01242D-04    |proj g|=  9.01149D-04
.......
================================================================================
#calls: 60
elapsed: 153.88497901
fb norms: [1.2779167, 1.32435, 1.8317978, 2.0234652]
W norm: 1.28179
grad norms: [0.00026309866, 0.00097150158, 0.0038724511, 0.0037227094, 0.00069000252]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.955192738486
tst_shape: (30, 30)
tst_pe: 0.569635268812
================================================================================

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   57   61      1     0     0   0.000D+00   8.958D-05
  F =  8.95836565177887678E-005

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 3.906E-03 seconds.
 Subspace minimization time 5.000E-01 seconds.
 Line search           time 1.504E+02 seconds.

 Total User time 1.546E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.63806456337


********************************************************************************
>>> Finding a balanced patch...
bal: 0.778355879292 195 825
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61386179924
fb norms: [0.99999976, 1.0, 0.99999994, 1.0000002]
W norm: 1.0
grad norms: [0.00143978, 0.045183614, 0.25915205, 0.35632986, 0.076585487]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.580269473563
tst_shape: (30, 30)
tst_pe: 0.530991111289
================================================================================

At iterate    0    f=  1.16055D-02    |proj g|=  4.94371D-02
..........
================================================================================
#calls: 10
elapsed: 27.7590918541
fb norms: [0.9958604, 0.99604291, 0.99891394, 1.00043]
W norm: 0.997243
grad norms: [0.00070454169, 0.0059093507, 0.026689062, 0.02971977, 0.0047602197]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.674211266539
tst_shape: (30, 30)
tst_pe: 0.606908495214
================================================================================
...
At iterate   10    f=  7.20664D-03    |proj g|=  8.91113D-03
.......
================================================================================
#calls: 20
elapsed: 52.9211239815
fb norms: [0.99149781, 0.99387223, 1.0335393, 1.0512983]
W norm: 0.996952
grad norms: [0.00082424068, 0.003220852, 0.01232088, 0.014709752, 0.0025900796]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.747840919549
tst_shape: (30, 30)
tst_pe: 0.606969583859
================================================================================
...
At iterate   20    f=  5.27529D-03    |proj g|=  1.48809D-03
.......
================================================================================
#calls: 30
elapsed: 78.1178278923
fb norms: [1.0303965, 1.0383813, 1.1722381, 1.2220542]
W norm: 1.03942
grad norms: [0.00081592688, 0.0038415359, 0.010237767, 0.017418964, 0.0031768209]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.801297015251
tst_shape: (30, 30)
tst_pe: 0.593964593334
================================================================================
...
At iterate   30    f=  3.61085D-03    |proj g|=  3.77698D-03
.......
================================================================================
#calls: 40
elapsed: 103.365832806
fb norms: [1.0942496, 1.1079538, 1.3176787, 1.3947982]
W norm: 1.10398
grad norms: [0.0011707513, 0.0078797871, 0.015333001, 0.019251077, 0.0033433053]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.846119923501
tst_shape: (30, 30)
tst_pe: 0.580383245992
================================================================================
...
At iterate   40    f=  1.92966D-03    |proj g|=  1.46397D-03
.......
================================================================================
#calls: 50
elapsed: 128.642673969
fb norms: [1.1987931, 1.2271421, 1.6385063, 1.7878553]
W norm: 1.21497
grad norms: [0.00050185737, 0.0043350654, 0.014232304, 0.016439805, 0.0033694641]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.910922865573
tst_shape: (30, 30)
tst_pe: 0.570137711541
================================================================================
...
At iterate   50    f=  4.86588D-04    |proj g|=  1.00742D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   59      1     0     0   0.000D+00   1.107D-04
  F =  1.10688408312853426E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.688E-01 seconds.
 Line search           time 1.445E+02 seconds.

 Total User time 1.486E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.648536469544


********************************************************************************
>>> Finding a balanced patch...
bal: 0.778616024974 492 74
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56670594215
fb norms: [0.99999982, 1.0000011, 1.0000002, 0.99999982]
W norm: 1.0
grad norms: [0.0066227429, 0.1224241, 0.61254245, 0.79856074, 0.17799827]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.614133325762
tst_shape: (30, 30)
tst_pe: 0.53991502608
================================================================================

At iterate    0    f=  1.75732D-02    |proj g|=  1.23747D-01
..........
================================================================================
#calls: 10
elapsed: 27.7567689419
fb norms: [0.99963611, 0.99967736, 0.99999386, 1.0002788]
W norm: 0.99908
grad norms: [0.0013855057, 0.0055002188, 0.017932441, 0.021977216, 0.0024728684]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.668691957295
tst_shape: (30, 30)
tst_pe: 0.595656603855
================================================================================
..
At iterate   10    f=  8.51137D-03    |proj g|=  1.05877D-02
........
================================================================================
#calls: 20
elapsed: 52.9453220367
fb norms: [0.98907012, 0.99068975, 1.0056568, 1.0120718]
W norm: 0.987989
grad norms: [0.00097948138, 0.0035196966, 0.010855629, 0.016132889, 0.0025802981]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.730572045655
tst_shape: (30, 30)
tst_pe: 0.604567636051
================================================================================
..
At iterate   20    f=  6.33804D-03    |proj g|=  1.60600D-03
........
================================================================================
#calls: 30
elapsed: 78.1465439796
fb norms: [1.0050663, 1.0121733, 1.0810511, 1.1073911]
W norm: 1.00318
grad norms: [0.0011388245, 0.0039870534, 0.013356226, 0.019342253, 0.0026547578]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.784647921816
tst_shape: (30, 30)
tst_pe: 0.616605255577
================================================================================
..
At iterate   30    f=  4.30013D-03    |proj g|=  4.55363D-03
........
================================================================================
#calls: 40
elapsed: 103.434082985
fb norms: [1.0600246, 1.0770174, 1.2451402, 1.3076367]
W norm: 1.05987
grad norms: [0.0013078946, 0.0058441833, 0.017243011, 0.018757014, 0.0029700124]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.824156610481
tst_shape: (30, 30)
tst_pe: 0.612889426299
================================================================================
..
At iterate   40    f=  2.76133D-03    |proj g|=  2.59730D-03
........
================================================================================
#calls: 50
elapsed: 128.737226009
fb norms: [1.1499097, 1.1798253, 1.4909428, 1.5976031]
W norm: 1.15332
grad norms: [0.00072278304, 0.0062243547, 0.02059266, 0.018530892, 0.0026157612]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.884038930762
tst_shape: (30, 30)
tst_pe: 0.601751270982
================================================================================
..
At iterate   50    f=  1.04355D-03    |proj g|=  1.37960D-03
........
================================================================================
#calls: 60
elapsed: 154.056772947
fb norms: [1.2443988, 1.2891893, 1.7656564, 1.9207166]
W norm: 1.25137
grad norms: [0.00035933545, 0.0023928126, 0.0076388372, 0.0068253623, 0.0012839851]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.939738529318
tst_shape: (30, 30)
tst_pe: 0.582158942898
================================================================================
..
At iterate   60    f=  1.16793D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   60   63      1     0     0   0.000D+00   1.168D-04
  F =  1.16793460620101541E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 3.906E-03 seconds.
 Subspace minimization time 5.664E-01 seconds.
 Line search           time 1.553E+02 seconds.

 Total User time 1.596E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.650654109669


********************************************************************************
>>> Finding a balanced patch...
bal: 0.791363163371 1020 760
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.62073111534
fb norms: [1.0000001, 0.99999928, 0.99999988, 0.99999976]
W norm: 1.0
grad norms: [0.0057550236, 0.10813702, 0.54841709, 0.59277564, 0.13740912]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.558621498565
tst_shape: (30, 30)
tst_pe: 0.54746166522
================================================================================

At iterate    0    f=  1.51256D-02    |proj g|=  9.93818D-02
..........
================================================================================
#calls: 10
elapsed: 27.7422420979
fb norms: [0.99865085, 0.99866748, 0.99897927, 0.99939686]
W norm: 0.998426
grad norms: [0.0012097566, 0.0071654688, 0.030862024, 0.036751848, 0.0068259444]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.619541513794
tst_shape: (30, 30)
tst_pe: 0.592993135829
================================================================================
..
At iterate   10    f=  9.02454D-03    |proj g|=  5.36671D-03
........
================================================================================
#calls: 20
elapsed: 52.9072780609
fb norms: [0.9804197, 0.98144192, 0.99770558, 1.0100882]
W norm: 0.980386
grad norms: [0.00064503873, 0.0024439327, 0.013037995, 0.014573772, 0.0025926076]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.68886512136
tst_shape: (30, 30)
tst_pe: 0.598563072346
================================================================================
..
At iterate   20    f=  6.58456D-03    |proj g|=  4.59532D-03
........
================================================================================
#calls: 30
elapsed: 78.0902130604
fb norms: [0.98915386, 0.99554545, 1.0991229, 1.1595759]
W norm: 0.989987
grad norms: [0.0012562361, 0.0030619986, 0.011347451, 0.01228977, 0.001936915]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.764302692486
tst_shape: (30, 30)
tst_pe: 0.604884586212
================================================================================
..
At iterate   30    f=  4.92744D-03    |proj g|=  1.59768D-03
........
================================================================================
#calls: 40
elapsed: 103.341356993
fb norms: [1.0411909, 1.0525868, 1.2252374, 1.3159112]
W norm: 1.04279
grad norms: [0.0011623254, 0.0039616465, 0.011668326, 0.011428283, 0.0015460456]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.812346947549
tst_shape: (30, 30)
tst_pe: 0.594078167803
================================================================================
..
At iterate   40    f=  2.77476D-03    |proj g|=  1.02526D-03
........
================================================================================
#calls: 50
elapsed: 128.746014118
fb norms: [1.1650014, 1.191697, 1.57125, 1.7395644]
W norm: 1.17015
grad norms: [0.00075460313, 0.0042547081, 0.013783222, 0.01403182, 0.0033128913]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.892331008923
tst_shape: (30, 30)
tst_pe: 0.595379323032
================================================================================
..
At iterate   50    f=  7.58607D-04    |proj g|=  1.50378D-03
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   2.123D-04
  F =  2.12323458981700242E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.570E-01 seconds.
 Line search           time 1.421E+02 seconds.

 Total User time 1.463E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.66100752003


********************************************************************************
>>> Finding a balanced patch...
bal: 0.777835587929 393 868
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60298395157
fb norms: [1.0000002, 1.0000018, 0.99999928, 0.99999994]
W norm: 1.0
grad norms: [0.0056547411, 0.13580374, 0.46015155, 0.56399226, 0.1557432]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.563162467286
tst_shape: (30, 30)
tst_pe: 0.545029542239
================================================================================

At iterate    0    f=  1.72682D-02    |proj g|=  1.17102D-01
..........
================================================================================
#calls: 10
elapsed: 27.7173609734
fb norms: [0.99816424, 0.99826133, 0.99902833, 0.99928761]
W norm: 0.997588
grad norms: [0.0015660475, 0.0044476683, 0.01487988, 0.018483749, 0.0032158112]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.635588804443
tst_shape: (30, 30)
tst_pe: 0.587538386181
================================================================================
..
At iterate   10    f=  9.10994D-03    |proj g|=  1.27806D-02
........
================================================================================
#calls: 20
elapsed: 52.8572659492
fb norms: [0.98316664, 0.98526943, 1.0011588, 1.0048599]
W norm: 0.98303
grad norms: [0.00060152309, 0.0056962795, 0.020208158, 0.026282083, 0.0073585524]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.690675411777
tst_shape: (30, 30)
tst_pe: 0.602814797032
================================================================================
..
At iterate   20    f=  7.34897D-03    |proj g|=  1.28954D-03
........
================================================================================
#calls: 30
elapsed: 78.0437569618
fb norms: [0.9989332, 1.0062499, 1.083232, 1.1088655]
W norm: 0.998917
grad norms: [0.0013392817, 0.0059504085, 0.018985838, 0.017307783, 0.0050467616]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.764219996967
tst_shape: (30, 30)
tst_pe: 0.602255492835
================================================================================
..
At iterate   30    f=  4.90055D-03    |proj g|=  1.17403D-03
........
================================================================================
#calls: 40
elapsed: 103.269498825
fb norms: [1.0738369, 1.0914607, 1.3128812, 1.3934952]
W norm: 1.07351
grad norms: [0.0013569067, 0.0066796187, 0.033647306, 0.036791854, 0.0091540515]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.816149811331
tst_shape: (30, 30)
tst_pe: 0.563605463274
================================================================================
..
At iterate   40    f=  2.97256D-03    |proj g|=  1.70043D-03
........
================================================================================
#calls: 50
elapsed: 128.537818909
fb norms: [1.1729258, 1.2024913, 1.5794239, 1.7177777]
W norm: 1.17514
grad norms: [0.0008252057, 0.0042908606, 0.014284385, 0.016943799, 0.0030258393]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.880706938209
tst_shape: (30, 30)
tst_pe: 0.557367458022
================================================================================
..
At iterate   50    f=  9.94172D-04    |proj g|=  1.44901D-03
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   3.175D-04
  F =  3.17486235871911049E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.883E-01 seconds.
 Line search           time 1.444E+02 seconds.

 Total User time 1.486E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.660072788439


********************************************************************************
>>> Finding a balanced patch...
bal: 0.768990634755 738 688
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.59031391144
fb norms: [0.99999988, 1.0000019, 1.0000005, 1.0000004]
W norm: 1.0
grad norms: [0.0022509764, 0.05819957, 0.33832002, 0.44152024, 0.10992746]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.59050523252
tst_shape: (30, 30)
tst_pe: 0.512059196315
================================================================================

At iterate    0    f=  1.36865D-02    |proj g|=  8.54328D-02
..........
================================================================================
#calls: 10
elapsed: 27.8334109783
fb norms: [0.9984315, 0.99851394, 0.99966204, 1.0008842]
W norm: 0.999414
grad norms: [0.0021670952, 0.0072696782, 0.023563232, 0.029673761, 0.0066700615]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.684026829383
tst_shape: (30, 30)
tst_pe: 0.601160703563
================================================================================
..
At iterate   10    f=  7.96005D-03    |proj g|=  1.74141D-03
........
================================================================================
#calls: 20
elapsed: 53.1125049591
fb norms: [0.98298818, 0.98599559, 1.0264521, 1.0501925]
W norm: 0.985775
grad norms: [0.0025711504, 0.013736327, 0.039501399, 0.053370696, 0.014198771]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.763907055318
tst_shape: (30, 30)
tst_pe: 0.607957569036
================================================================================
..
At iterate   20    f=  5.84762D-03    |proj g|=  1.47366D-03
........
================================================================================
#calls: 30
elapsed: 78.3017020226
fb norms: [1.0229353, 1.0321198, 1.133237, 1.1862946]
W norm: 1.0258
grad norms: [0.0014251283, 0.0040475824, 0.013085642, 0.021073721, 0.0045029959]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.811525796504
tst_shape: (30, 30)
tst_pe: 0.613088391741
================================================================================
..
At iterate   30    f=  3.76091D-03    |proj g|=  2.35549D-03
........
================================================================================
#calls: 40
elapsed: 103.53729105
fb norms: [1.0929089, 1.1120652, 1.3204063, 1.4136996]
W norm: 1.09677
grad norms: [0.00063834869, 0.0096372068, 0.023392014, 0.020171661, 0.0039198967]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.851506228481
tst_shape: (30, 30)
tst_pe: 0.588564592722
================================================================================
..
At iterate   40    f=  2.07003D-03    |proj g|=  1.17031D-03
........
================================================================================
#calls: 50
elapsed: 128.819268942
fb norms: [1.1855072, 1.2180884, 1.5819082, 1.72735]
W norm: 1.19046
grad norms: [0.00067215029, 0.0042293328, 0.010498797, 0.011366555, 0.0016489091]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.908999888767
tst_shape: (30, 30)
tst_pe: 0.581903522791
================================================================================
..
At iterate   50    f=  5.64351D-04    |proj g|=  6.53129D-04
......
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   56   59      1     0     0   0.000D+00   1.098D-04
  F =  1.09849846921861172E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.805E-01 seconds.
 Line search           time 1.447E+02 seconds.

 Total User time 1.489E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.652768790662


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780176899063 547 95
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60761904716
fb norms: [1.0000002, 0.99999946, 1.0000005, 0.99999982]
W norm: 1.0
grad norms: [0.0031911451, 0.12879431, 0.43327323, 0.52119005, 0.1278901]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.564480665784
tst_shape: (30, 30)
tst_pe: 0.539864145342
================================================================================

At iterate    0    f=  1.39283D-02    |proj g|=  8.39289D-02
..........
================================================================================
#calls: 10
elapsed: 27.7516200542
fb norms: [0.99869227, 0.99875081, 0.99941462, 0.99943221]
W norm: 0.998972
grad norms: [0.0021347506, 0.0070934757, 0.025093162, 0.031975649, 0.0072268648]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.641753752434
tst_shape: (30, 30)
tst_pe: 0.6057877208
================================================================================
....
At iterate   10    f=  8.43243D-03    |proj g|=  1.36039D-02
......
================================================================================
#calls: 20
elapsed: 52.9117791653
fb norms: [0.98057783, 0.98277718, 1.0105693, 1.0196674]
W norm: 0.981831
grad norms: [0.00079261308, 0.0071347579, 0.029538359, 0.046322264, 0.012912113]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.718473014585
tst_shape: (30, 30)
tst_pe: 0.62837293991
================================================================================
....
At iterate   20    f=  6.50055D-03    |proj g|=  1.66127D-03
......
================================================================================
#calls: 30
elapsed: 78.0961201191
fb norms: [0.99346632, 0.99854064, 1.0748295, 1.1084284]
W norm: 0.994155
grad norms: [0.0011226139, 0.0064293048, 0.017828036, 0.021649862, 0.0053912308]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.772410285234
tst_shape: (30, 30)
tst_pe: 0.613434650973
================================================================================
....
At iterate   30    f=  4.49241D-03    |proj g|=  1.71174D-03
......
================================================================================
#calls: 40
elapsed: 103.322623968
fb norms: [1.0594282, 1.072332, 1.2589749, 1.3397946]
W norm: 1.05952
grad norms: [0.00094817323, 0.0055559538, 0.013594276, 0.014077374, 0.0022535946]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.825883338616
tst_shape: (30, 30)
tst_pe: 0.596043683525
================================================================================
....
At iterate   40    f=  2.25354D-03    |proj g|=  2.45008D-03
......
================================================================================
#calls: 50
elapsed: 128.577618122
fb norms: [1.1641109, 1.1883099, 1.5305539, 1.6641589]
W norm: 1.16603
grad norms: [0.00086208741, 0.0039622616, 0.0097382627, 0.010026541, 0.0015268928]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.88597820985
tst_shape: (30, 30)
tst_pe: 0.599640357357
================================================================================
....
At iterate   50    f=  4.82746D-04    |proj g|=  1.07341D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   57      1     0     0   0.000D+00   2.374D-04
  F =  2.37366359215229750E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.258E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.6470591797


********************************************************************************
>>> Finding a balanced patch...
bal: 0.784339229969 662 36
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.57435202599
fb norms: [0.99999976, 1.0000002, 1.0, 1.0000007]
W norm: 1.0
grad norms: [0.00044677302, 0.036083449, 0.18611181, 0.24851692, 0.053158313]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.558409423194
tst_shape: (30, 30)
tst_pe: 0.549954075966
================================================================================

At iterate    0    f=  1.13340D-02    |proj g|=  3.39548D-02
..........
================================================================================
#calls: 10
elapsed: 27.6891489029
fb norms: [0.99922734, 0.99930477, 1.0005205, 1.0008622]
W norm: 1.00036
grad norms: [0.00078125135, 0.0098804422, 0.035040837, 0.051254079, 0.009030344]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.647435449604
tst_shape: (30, 30)
tst_pe: 0.606564466815
================================================================================
..
At iterate   10    f=  8.47111D-03    |proj g|=  4.00403D-03
........
================================================================================
#calls: 20
elapsed: 52.8355689049
fb norms: [0.98911011, 0.99133801, 1.0179669, 1.0271008]
W norm: 0.997567
grad norms: [0.00062827091, 0.0035828657, 0.010892871, 0.014582575, 0.0019256935]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.7366302839
tst_shape: (30, 30)
tst_pe: 0.625627861127
================================================================================
..
At iterate   20    f=  5.86258D-03    |proj g|=  1.48680D-03
........
================================================================================
#calls: 30
elapsed: 78.0885910988
fb norms: [1.0162373, 1.0238105, 1.1336662, 1.1774018]
W norm: 1.02924
grad norms: [0.0012889279, 0.0057245106, 0.01443753, 0.015614423, 0.0030421561]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.794176511249
tst_shape: (30, 30)
tst_pe: 0.627996393907
================================================================================
..
At iterate   30    f=  3.45863D-03    |proj g|=  3.30589D-03
........
================================================================================
#calls: 40
elapsed: 103.342684031
fb norms: [1.0987924, 1.11552, 1.3546866, 1.4472554]
W norm: 1.11393
grad norms: [0.00076333253, 0.004417229, 0.013412987, 0.017899536, 0.0034852601]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.851454122453
tst_shape: (30, 30)
tst_pe: 0.603470136473
================================================================================
..
At iterate   40    f=  1.88948D-03    |proj g|=  1.52869D-03
........
================================================================================
#calls: 50
elapsed: 128.645855904
fb norms: [1.2117844, 1.2434903, 1.6579961, 1.8129219]
W norm: 1.23262
grad norms: [0.00055795279, 0.0048346287, 0.013164715, 0.01804666, 0.0028126328]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.916609831116
tst_shape: (30, 30)
tst_pe: 0.589104511573
================================================================================
..
At iterate   50    f=  3.72390D-04    |proj g|=  6.63485D-04
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   1.238D-04
  F =  1.23818841530010104E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.492E-01 seconds.
 Line search           time 1.398E+02 seconds.

 Total User time 1.439E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.647479077705


********************************************************************************
>>> Finding a balanced patch...
bal: 0.774193548387 368 524
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.60821318626
fb norms: [0.99999958, 1.0000012, 1.0, 1.0000002]
W norm: 1.0
grad norms: [0.0055631003, 0.15187591, 0.57296348, 0.79434085, 0.18070412]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.577573696057
tst_shape: (30, 30)
tst_pe: 0.549530112895
================================================================================

At iterate    0    f=  2.06465D-02    |proj g|=  1.40720D-01
..........
================================================================================
#calls: 10
elapsed: 27.7293469906
fb norms: [0.99717033, 0.99724638, 0.99880016, 1.0003889]
W norm: 0.995441
grad norms: [0.0015720208, 0.0047216513, 0.013476809, 0.021705311, 0.003331634]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.671547450797
tst_shape: (30, 30)
tst_pe: 0.614035201767
================================================================================
..
At iterate   10    f=  8.07468D-03    |proj g|=  5.35980D-03
........
================================================================================
#calls: 20
elapsed: 52.8885521889
fb norms: [0.98788613, 0.99055004, 1.0168538, 1.0351588]
W norm: 0.984083
grad norms: [0.00049051875, 0.0046639745, 0.016100898, 0.024362711, 0.0053085666]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.747951966347
tst_shape: (30, 30)
tst_pe: 0.619972826887
================================================================================
..
At iterate   20    f=  5.89039D-03    |proj g|=  1.46767D-03
........
================================================================================
#calls: 30
elapsed: 78.0686280727
fb norms: [1.0142572, 1.0221096, 1.1050912, 1.155961]
W norm: 1.00919
grad norms: [0.00096512126, 0.0053299754, 0.011772894, 0.013023825, 0.0020006842]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.794580972137
tst_shape: (30, 30)
tst_pe: 0.610063471713
================================================================================
..
At iterate   30    f=  3.95540D-03    |proj g|=  3.56185D-03
........
================================================================================
#calls: 40
elapsed: 103.314698219
fb norms: [1.0718715, 1.0876769, 1.270033, 1.3703519]
W norm: 1.06773
grad norms: [0.00090114353, 0.0067991326, 0.015022772, 0.015702004, 0.0036408261]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.837853484594
tst_shape: (30, 30)
tst_pe: 0.599145200538
================================================================================
..
At iterate   40    f=  2.49053D-03    |proj g|=  1.19697D-03
........
================================================================================
#calls: 50
elapsed: 128.587917089
fb norms: [1.1780025, 1.2076536, 1.5589713, 1.7247626]
W norm: 1.17906
grad norms: [0.00060397404, 0.0033792434, 0.0094625112, 0.011373324, 0.0019893569]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.903191676502
tst_shape: (30, 30)
tst_pe: 0.587540041534
================================================================================
..
At iterate   50    f=  7.55710D-04    |proj g|=  8.66392D-04
....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   54   57      1     0     0   0.000D+00   2.301D-04
  F =  2.30077203013934195E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.219E-01 seconds.
 Line search           time 1.397E+02 seconds.

 Total User time 1.438E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.647164367269


********************************************************************************
>>> Finding a balanced patch...
bal: 0.783038501561 216 272
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.56492710114
fb norms: [0.99999988, 0.99999893, 1.0000008, 1.0000005]
W norm: 1.0
grad norms: [0.0027482649, 0.092313893, 0.35088637, 0.43276194, 0.11725003]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.596298169744
tst_shape: (30, 30)
tst_pe: 0.530636541439
================================================================================

At iterate    0    f=  1.30872D-02    |proj g|=  8.23666D-02
..........
================================================================================
#calls: 10
elapsed: 27.7336421013
fb norms: [0.99972457, 0.99977863, 1.0002009, 1.0008968]
W norm: 0.999962
grad norms: [0.0017304216, 0.0094614923, 0.030156227, 0.033972424, 0.0090833679]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.656966546979
tst_shape: (30, 30)
tst_pe: 0.579635168272
================================================================================
..
At iterate   10    f=  8.33238D-03    |proj g|=  7.95523D-03
........
================================================================================
#calls: 20
elapsed: 52.8990399837
fb norms: [0.98990685, 0.99195993, 1.0105603, 1.0176274]
W norm: 0.991833
grad norms: [0.0011090195, 0.0050366377, 0.017799295, 0.021809764, 0.0058782985]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.725604240286
tst_shape: (30, 30)
tst_pe: 0.60183806454
================================================================================
..
At iterate   20    f=  6.39424D-03    |proj g|=  6.06581D-03
........
================================================================================
#calls: 30
elapsed: 78.1351230145
fb norms: [1.0160964, 1.0254731, 1.1198698, 1.146777]
W norm: 1.01839
grad norms: [0.0011399608, 0.0055014542, 0.017698471, 0.021146011, 0.0050002635]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.787918331186
tst_shape: (30, 30)
tst_pe: 0.580269796995
================================================================================
..
At iterate   30    f=  4.14103D-03    |proj g|=  1.33946D-03
........
================================================================================
#calls: 40
elapsed: 103.416810036
fb norms: [1.0910293, 1.111559, 1.3281105, 1.387674]
W norm: 1.09583
grad norms: [0.00073026441, 0.0057493425, 0.014639877, 0.015053867, 0.0031166857]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.83640531647
tst_shape: (30, 30)
tst_pe: 0.556095912779
================================================================================
..
At iterate   40    f=  2.19503D-03    |proj g|=  2.88720D-03
........
================================================================================
#calls: 50
elapsed: 128.723615885
fb norms: [1.191349, 1.2292246, 1.6209521, 1.7230991]
W norm: 1.20361
grad norms: [0.00050452788, 0.0071817506, 0.018930294, 0.023443788, 0.0057238168]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.900539034553
tst_shape: (30, 30)
tst_pe: 0.541345580633
================================================================================
..
At iterate   50    f=  6.87413D-04    |proj g|=  8.17185D-04
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   2.270D-04
  F =  2.27031327085569501E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.648E-01 seconds.
 Line search           time 1.422E+02 seconds.

 Total User time 1.464E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.650862655456


********************************************************************************
>>> Finding a balanced patch...
bal: 0.780437044745 595 728
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.59784698486
fb norms: [0.99999982, 0.99999958, 0.99999994, 0.99999982]
W norm: 1.0
grad norms: [0.0038323272, 0.13383912, 0.46186098, 0.57119316, 0.15499105]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.571341577
tst_shape: (30, 30)
tst_pe: 0.487568930733
================================================================================

At iterate    0    f=  1.77530D-02    |proj g|=  1.23873D-01
..........
================================================================================
#calls: 10
elapsed: 27.7480559349
fb norms: [1.0000166, 1.0000728, 1.0011632, 1.0017819]
W norm: 0.999566
grad norms: [0.0019127304, 0.0079856468, 0.025062628, 0.03487486, 0.0087269107]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.666600830322
tst_shape: (30, 30)
tst_pe: 0.585996855245
================================================================================
..
At iterate   10    f=  8.07243D-03    |proj g|=  2.44716D-03
........
================================================================================
#calls: 20
elapsed: 52.9076960087
fb norms: [0.99001604, 0.99286717, 1.0170581, 1.0232651]
W norm: 0.992325
grad norms: [0.00084199355, 0.0044363043, 0.011424233, 0.01199645, 0.0024923016]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.730655439913
tst_shape: (30, 30)
tst_pe: 0.608383352641
================================================================================
..
At iterate   20    f=  5.90196D-03    |proj g|=  1.26436D-03
........
================================================================================
#calls: 30
elapsed: 78.1297740936
fb norms: [1.0236391, 1.0340118, 1.1365227, 1.1752385]
W norm: 1.02587
grad norms: [0.00075032387, 0.0057853172, 0.016380915, 0.012984615, 0.0026039102]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.80318671025
tst_shape: (30, 30)
tst_pe: 0.61604934674
================================================================================
..
At iterate   30    f=  3.49485D-03    |proj g|=  1.19979D-03
........
================================================================================
#calls: 40
elapsed: 103.379466057
fb norms: [1.1058241, 1.1309055, 1.3933418, 1.4759173]
W norm: 1.11258
grad norms: [0.00062943192, 0.0038550687, 0.0099751363, 0.010230068, 0.0013627536]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.861996847719
tst_shape: (30, 30)
tst_pe: 0.611197871557
================================================================================
..
At iterate   40    f=  1.76266D-03    |proj g|=  9.23512D-04
........
================================================================================
#calls: 50
elapsed: 128.654871941
fb norms: [1.1922027, 1.2332094, 1.654012, 1.768024]
W norm: 1.20528
grad norms: [0.00023947321, 0.009310781, 0.024761258, 0.026860654, 0.0064992332]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.909335653915
tst_shape: (30, 30)
tst_pe: 0.605975674654
================================================================================
..
At iterate   50    f=  6.13322D-04    |proj g|=  6.77044D-04
.....
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   55   58      1     0     0   0.000D+00   1.544D-04
  F =  1.54376786667853594E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.531E-01 seconds.
 Line search           time 1.422E+02 seconds.

 Total User time 1.463E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.649701639161


********************************************************************************
>>> Finding a balanced patch...
bal: 0.783558792924 396 698
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58386182785
fb norms: [0.99999982, 0.99999934, 0.99999875, 1.0000002]
W norm: 1.0
grad norms: [0.0054201582, 0.13410783, 0.52551043, 0.71665019, 0.17767966]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.581651779143
tst_shape: (30, 30)
tst_pe: 0.539997614993
================================================================================

At iterate    0    f=  2.04749D-02    |proj g|=  1.38307D-01
..........
================================================================================
#calls: 10
elapsed: 27.7155787945
fb norms: [0.99439651, 0.99459887, 0.99710035, 0.99768907]
W norm: 0.991831
grad norms: [0.00035750202, 0.0073530688, 0.020016169, 0.034422975, 0.0075912098]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.668563668504
tst_shape: (30, 30)
tst_pe: 0.60257285553
================================================================================
...
At iterate   10    f=  7.45600D-03    |proj g|=  2.19680D-03
.......
================================================================================
#calls: 20
elapsed: 52.9434008598
fb norms: [0.98372406, 0.98704511, 1.0253094, 1.0320599]
W norm: 0.978881
grad norms: [0.00079431792, 0.0026716427, 0.0097040208, 0.0110426, 0.0017119532]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.74086568641
tst_shape: (30, 30)
tst_pe: 0.604826333387
================================================================================
....
At iterate   20    f=  5.51585D-03    |proj g|=  1.68899D-03
......
================================================================================
#calls: 30
elapsed: 78.1487078667
fb norms: [1.0190384, 1.0291418, 1.1579812, 1.1891209]
W norm: 1.01277
grad norms: [0.0010382299, 0.0035057687, 0.011108059, 0.011872771, 0.001474089]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.795519326315
tst_shape: (30, 30)
tst_pe: 0.579766322071
================================================================================
....
At iterate   30    f=  3.23617D-03    |proj g|=  2.22607D-03
......
================================================================================
#calls: 40
elapsed: 103.37646389
fb norms: [1.1113558, 1.1361171, 1.4403794, 1.5117958]
W norm: 1.11094
grad norms: [0.00086357776, 0.005409536, 0.015278208, 0.021623148, 0.0047036223]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.859197740444
tst_shape: (30, 30)
tst_pe: 0.564220480175
================================================================================
....
At iterate   40    f=  1.20393D-03    |proj g|=  1.60578D-03
......
================================================================================
#calls: 50
elapsed: 128.649313927
fb norms: [1.247583, 1.29763, 1.8400556, 1.9561673]
W norm: 1.25861
grad norms: [0.00051610026, 0.0024631228, 0.0087553561, 0.013679842, 0.0024692409]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.933918391871
tst_shape: (30, 30)
tst_pe: 0.570692997705
================================================================================
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   48   53      1     0     0   0.000D+00   2.389D-04
  F =  2.38859356613829732E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 3.398E-01 seconds.
 Line search           time 1.302E+02 seconds.

 Total User time 1.342E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.648606779663


********************************************************************************
>>> Finding a balanced patch...
bal: 0.784859521332 176 611
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.61473202705
fb norms: [0.99999988, 0.9999997, 1.0000004, 0.99999994]
W norm: 1.0
grad norms: [0.0037271171, 0.058628913, 0.30146179, 0.59257567, 0.14313234]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.552412930194
tst_shape: (30, 30)
tst_pe: 0.519683549892
================================================================================

At iterate    0    f=  1.69724D-02    |proj g|=  1.15954D-01
..........
================================================================================
#calls: 10
elapsed: 27.752849102
fb norms: [0.99943858, 0.99950451, 1.0000957, 1.0007603]
W norm: 0.999187
grad norms: [0.0020217798, 0.0072687156, 0.01952702, 0.030818284, 0.0080922227]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.629165152207
tst_shape: (30, 30)
tst_pe: 0.588860183465
================================================================================
..
At iterate   10    f=  9.08998D-03    |proj g|=  1.08108D-02
........
================================================================================
#calls: 20
elapsed: 52.9051599503
fb norms: [0.98499757, 0.98861521, 1.0230447, 1.0423526]
W norm: 0.9862
grad norms: [0.0019073539, 0.0066615366, 0.020089839, 0.039967548, 0.011009335]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.712565156806
tst_shape: (30, 30)
tst_pe: 0.588516036096
================================================================================
..
At iterate   20    f=  6.67824D-03    |proj g|=  3.30804D-03
........
================================================================================
#calls: 30
elapsed: 78.1524391174
fb norms: [1.0187904, 1.0312297, 1.1657209, 1.2242975]
W norm: 1.0154
grad norms: [0.0010098754, 0.006084627, 0.011757588, 0.012662721, 0.0028138172]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.779184986547
tst_shape: (30, 30)
tst_pe: 0.577017317848
================================================================================
..
At iterate   30    f=  4.50740D-03    |proj g|=  2.57572D-03
........
================================================================================
#calls: 40
elapsed: 103.38726902
fb norms: [1.0835029, 1.1061045, 1.3743744, 1.4721665]
W norm: 1.08042
grad norms: [0.0011092996, 0.0047666482, 0.016542492, 0.024148703, 0.0055724885]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.831969581146
tst_shape: (30, 30)
tst_pe: 0.565930855046
================================================================================
..
At iterate   40    f=  2.27335D-03    |proj g|=  4.88369D-03
........
================================================================================
#calls: 50
elapsed: 128.690409184
fb norms: [1.1772071, 1.2136458, 1.6474056, 1.7862164]
W norm: 1.1784
grad norms: [0.00078955136, 0.0041405139, 0.010422613, 0.015611982, 0.0041246144]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.896515863545
tst_shape: (30, 30)
tst_pe: 0.565108274132
================================================================================
..
At iterate   50    f=  4.67016D-04    |proj g|=  1.16037D-03
..
           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   52   55      1     0     0   0.000D+00   2.793D-04
  F =  2.79288360616192222E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.023E-01 seconds.
 Line search           time 1.350E+02 seconds.

 Total User time 1.391E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.63711033176


********************************************************************************
>>> Finding a balanced patch...
bal: 0.781997918835 75 264
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.58172988892
fb norms: [1.0, 0.99999958, 0.99999988, 0.99999982]
W norm: 1.0
grad norms: [0.00098509504, 0.03544781, 0.13755336, 0.20463978, 0.050785016]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.5651613199
tst_shape: (30, 30)
tst_pe: 0.506498512399
================================================================================

At iterate    0    f=  1.14700D-02    |proj g|=  3.81850D-02
..........
================================================================================
#calls: 10
elapsed: 27.7339789867
fb norms: [0.99946618, 0.99953133, 1.0009133, 1.0020213]
W norm: 1.00061
grad norms: [0.00087873294, 0.0095199719, 0.031906098, 0.041421, 0.0090253847]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.645393536311
tst_shape: (30, 30)
tst_pe: 0.584271067965
================================================================================
..
At iterate   10    f=  8.33442D-03    |proj g|=  7.82732D-03
........
================================================================================
#calls: 20
elapsed: 52.8451938629
fb norms: [0.99644858, 0.99945968, 1.0405456, 1.0634946]
W norm: 1.00109
grad norms: [0.00090712408, 0.0030615639, 0.013462489, 0.016375355, 0.0038743143]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.735757691256
tst_shape: (30, 30)
tst_pe: 0.595417171787
================================================================================
..
At iterate   20    f=  6.06162D-03    |proj g|=  1.09124D-03
........
================================================================================
#calls: 30
elapsed: 78.0849108696
fb norms: [1.0443645, 1.0542006, 1.1878798, 1.2443953]
W norm: 1.05148
grad norms: [0.00060017838, 0.0032025338, 0.011463556, 0.016632058, 0.0036596735]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.798476524723
tst_shape: (30, 30)
tst_pe: 0.58693072269
================================================================================
..
At iterate   30    f=  3.75227D-03    |proj g|=  3.89583D-03
........
================================================================================
#calls: 40
elapsed: 103.315115929
fb norms: [1.1382034, 1.1586778, 1.4264851, 1.5193776]
W norm: 1.14722
grad norms: [0.0007540207, 0.0050786482, 0.012191193, 0.016257651, 0.0037324862]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.851937965439
tst_shape: (30, 30)
tst_pe: 0.566495081267
================================================================================
..
At iterate   40    f=  1.72203D-03    |proj g|=  6.23951D-03
........
================================================================================
#calls: 50
elapsed: 128.637221813
fb norms: [1.2629079, 1.3012114, 1.7833573, 1.9272023]
W norm: 1.27577
grad norms: [0.00056141714, 0.003075717, 0.0075915554, 0.0073196348, 0.0013616533]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.925513201608
tst_shape: (30, 30)
tst_pe: 0.556327126754
================================================================================
..
At iterate   50    f=  2.66805D-04    |proj g|=  0.00000D+00

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N   Tit  Tnf  Tnint  Skip  Nact     Projg        F
24641   50   53      1     0     0   0.000D+00   2.668D-04
  F =  2.66804505372419953E-004

CONVERGENCE: NORM OF PROJECTED GRADIENT <= PGTOL            

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 4.023E-01 seconds.
 Line search           time 1.302E+02 seconds.

 Total User time 1.343E+02 seconds.

lr: 0.1
tst_Y.shape: (512, 512)
********************************************************************************


tst_pe: 0.635866283674


********************************************************************************
>>> Finding a balanced patch...
bal: 0.785379812695 717 734
>>> X.shape: (1024, 1024)
>>> X.shape: (1, 1, 1024, 1024)
>>> Y_true.shape: (1024, 1024)
>>> Y_true.shape: (1, 1, 1024, 1024)
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        24641     M =         1000
 This problem is unconstrained.

At X0         0 variables are exactly at the bounds
.
================================================================================
#calls: 0
elapsed: 2.63169002533
fb norms: [1.0000005, 1.0000005, 1.0000002, 1.0000007]
W norm: 1.0
grad norms: [0.0019271432, 0.048114836, 0.19874452, 0.32319978, 0.09025389]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.556162858964
tst_shape: (30, 30)
tst_pe: 0.524689347382
================================================================================

At iterate    0    f=  1.29409D-02    |proj g|=  7.14743D-02
..........
================================================================================
#calls: 10
elapsed: 28.0467429161
fb norms: [1.0004681, 1.0005414, 1.0017565, 1.0021696]
W norm: 1.00134
grad norms: [0.00056710799, 0.007762616, 0.026633501, 0.047112312, 0.010177981]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.636125176182
tst_shape: (30, 30)
tst_pe: 0.588885661683
================================================================================
..
At iterate   10    f=  8.39637D-03    |proj g|=  7.75836D-03
........
================================================================================
#calls: 20
elapsed: 53.6258699894
fb norms: [0.99584788, 0.99912101, 1.0327226, 1.0413753]
W norm: 1.00167
grad norms: [0.00098997413, 0.0032093709, 0.010805251, 0.013333333, 0.0026803066]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.722762704421
tst_shape: (30, 30)
tst_pe: 0.615648199851
================================================================================
..
At iterate   20    f=  5.99458D-03    |proj g|=  2.12315D-03
........
================================================================================
#calls: 30
elapsed: 79.1101081371
fb norms: [1.0222358, 1.033656, 1.1599623, 1.2007744]
W norm: 1.02618
grad norms: [0.0010970143, 0.0056587928, 0.010841302, 0.01468893, 0.0021804126]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.789095660342
tst_shape: (30, 30)
tst_pe: 0.610058773121
================================================================================
..
At iterate   30    f=  3.99375D-03    |proj g|=  2.32058D-03
........
================================================================================
#calls: 40
elapsed: 104.771850109
fb norms: [1.1162891, 1.1416798, 1.4266362, 1.5322798]
W norm: 1.12049
grad norms: [0.0021146222, 0.01741367, 0.062617041, 0.099219829, 0.024609724]
--------------------------------------------------------------------------------
trn_shape: (62, 62)
trn_pe: 0.856312600654
tst_shape: (30, 30)
tst_pe: 0.619809010896
================================================================================
..
At iterate   40    f=  2.01217D-03    |proj g|=  1.06673D-03
....